<?php
use Illuminate\Database\Eloquent\SoftDeletingTrait;

class zz2017members extends Eloquent {

	protected $table = 'zz_2017_Members';

	public function scopeRole($query)
    {
        if (AccessfCheck::getCheckSYS(Auth::user()->roleid))
        {
            return $query;
        }
        else if (AccessfCheck::getCheckSOF(Auth::user()->roleid))
        {
            return $query;
        } 
        else if (Session::get('gakkaiuserpositionlevel') == 'shq')
        {
            return $query->where('shqregistration', '1');
        }
        else if (Session::get('gakkaiuserpositionlevel') == 'rhq')
        {
            return $query->where('regionregistration', '1');
        }
        else if (Session::get('gakkaiuserpositionlevel') == 'zone')
        {
            return $query->where('zoneregistration', '1');
        }
        else if (Session::get('gakkaiuserpositionlevel') == 'chapter')
        {
            return $query->where('chapterregistration', '1');
        }
        else if (Session::get('gakkaiuserpositionlevel') == 'district')
        {
            return $query->where('districtregistration', '1');
        }
        else
        {
            return $query;
        }
    }

    public function scopeMembers($query)
    {
        if (Session::get('gakkaiuserposition') == 'H1' or Session::get('gakkaiuserposition') == 'H2' or Session::get('gakkaiuserposition') == 'H3' or Session::get('gakkaiuserposition') == 'H5') {
            return $query->where('rhq', Session::get('gakkaiuserrhq'))
                ->orderby('rhq', 'zone', 'chapter', 'district');
        } else if (Session::get('gakkaiuserposition') == 'Z1' or Session::get('gakkaiuserposition') == 'Z2' or Session::get('gakkaiuserposition') == 'Z3' or Session::get('gakkaiuserposition') == 'Z5') {
            return $query->where('zone', Session::get('gakkaiuserzone'))
                ->orderby('rhq', 'zone', 'chapter', 'district');
        } else if (Session::get('gakkaiuserposition') == 'C1' or Session::get('gakkaiuserposition') == 'C1V' or Session::get('gakkaiuserposition') == 'C2' or Session::get('gakkaiuserposition') == 'C2V' or Session::get('gakkaiuserposition') == 'C3' or Session::get('gakkaiuserposition') == 'C5') {
            return $query->where('chapter', Session::get('gakkaiuserchapter'))
                ->orderby('rhq', 'zone', 'chapter', 'district');
        } else if (Session::get('gakkaiuserposition') == 'D1' or Session::get('gakkaiuserposition') == 'D1V' or Session::get('gakkaiuserposition') == 'D2' or Session::get('gakkaiuserposition') == 'D2V' or Session::get('gakkaiuserposition') == 'D3' or Session::get('gakkaiuserposition') == 'D5' or Session::get('gakkaiuserposition') == 'DA') {
            return $query->where('chapter', Session::get('gakkaiuserchapter'))->where('district', Session::get('gakkaiuserdistrict'))
                ->orderby('rhq', 'zone', 'chapter', 'district');
        }
    }

    public function scopeSearch($query, $sSearch)
    {
        return $query->where(function($query) use ($sSearch)
        {
            $query->where('name', 'Like', '%'.$sSearch.'%')
                ->orwhere('chinesename', 'Like', '%'.$sSearch.'%')
                ->orwhere('rhq', 'Like', '%'.$sSearch.'%')
                ->orwhere('zone', 'Like', '%'.$sSearch.'%')
                ->orwhere('chapter', 'Like', '%'.$sSearch.'%')
                ->orwhere('district', 'Like', '%'.$sSearch.'%')
                ->orwhere('description', 'Like', '%'.$sSearch.'%')
                ->orwhere('division', 'Like', '%'.$sSearch.'%')
                ->orwhere('position', 'Like', '%'.$sSearch.'%')
                ->orwhere('positionlevel', 'Like', '%'.$sSearch.'%')
                ->orwhere('agegroup', 'Like', '%'.$sSearch.'%')
                ->orwhere('created_at', 'Like', '%'.$sSearch.'%');
        });
    }

    public function scopeRHQStats($query, $value, $divisiontype)
    {
        if ( $divisiontype == 'All' or $divisiontype == "4 Division")
        {
            return $query->whereIn('rhq', array('H1', 'H2', 'H3', 'H4', 'H5', 'H6', 'H7', 'H8', 'H9'))->whereNotIn('district', array("-"))->select('rhq', 'zone', 'chapter', 'district', DB::Raw('SUM(dmjan) as "jan"'), DB::Raw('SUM(dmfeb) as "feb"'), DB::Raw('SUM(dmmar) as "mar"'), DB::Raw('SUM(dmapr) as "apr"'), DB::Raw('SUM(dmmay) as "may"'), DB::Raw('SUM(dmjun) as "jun"'), DB::Raw('SUM(dmjul) as "jul"'), DB::Raw('SUM(dmaug) as "aug"'), DB::Raw('SUM(dmsep) as "sep", SUM(dmoct) as "oct"'), DB::Raw('SUM(dmnov) as "nov"'), DB::Raw('SUM(dmdec) as "dec"'), DB::Raw('concat(chapter, " ", district) as description'))->groupby('rhq')->groupby('zone')->groupby('chapter')->groupby('district');
        }
        elseif ( $divisiontype == 'MD')
        {
            return $query->whereIn('rhq', array('H1', 'H2', 'H3', 'H4', 'H5', 'H6', 'H7', 'H8', 'H9'))->where('division', 'MD')->whereNotIn('district', array("-"))->select('rhq', 'zone', 'chapter', 'district', DB::Raw('SUM(dmjan) as "jan"'), DB::Raw('SUM(dmfeb) as "feb"'), DB::Raw('SUM(dmmar) as "mar"'), DB::Raw('SUM(dmapr) as "apr"'), DB::Raw('SUM(dmmay) as "may"'), DB::Raw('SUM(dmjun) as "jun"'), DB::Raw('SUM(dmjul) as "jul"'), DB::Raw('SUM(dmaug) as "aug"'), DB::Raw('SUM(dmsep) as "sep", SUM(dmoct) as "oct"'), DB::Raw('SUM(dmnov) as "nov"'), DB::Raw('SUM(dmdec) as "dec"'), DB::Raw('concat(chapter, " ", district) as description'))->groupby('rhq')->groupby('zone')->groupby('chapter')->groupby('district');
        }
        elseif ( $divisiontype == 'WD')
        {
            return $query->whereIn('rhq', array('H1', 'H2', 'H3', 'H4', 'H5', 'H6', 'H7', 'H8', 'H9'))->where('division', 'WD')->whereNotIn('district', array("-"))->select('rhq', 'zone', 'chapter', 'district', DB::Raw('SUM(dmjan) as "jan"'), DB::Raw('SUM(dmfeb) as "feb"'), DB::Raw('SUM(dmmar) as "mar"'), DB::Raw('SUM(dmapr) as "apr"'), DB::Raw('SUM(dmmay) as "may"'), DB::Raw('SUM(dmjun) as "jun"'), DB::Raw('SUM(dmjul) as "jul"'), DB::Raw('SUM(dmaug) as "aug"'), DB::Raw('SUM(dmsep) as "sep", SUM(dmoct) as "oct"'), DB::Raw('SUM(dmnov) as "nov"'), DB::Raw('SUM(dmdec) as "dec"'), DB::Raw('concat(chapter, " ", district) as description'))->groupby('rhq')->groupby('zone')->groupby('chapter')->groupby('district');
        }
        elseif ( $divisiontype == 'YMD')
        {
            return $query->whereIn('rhq', array('H1', 'H2', 'H3', 'H4', 'H5', 'H6', 'H7', 'H8', 'H9'))->where('division', 'YM')->whereNotIn('district', array("-"))->select('rhq', 'zone', 'chapter', 'district', DB::Raw('SUM(dmjan) as "jan"'), DB::Raw('SUM(dmfeb) as "feb"'), DB::Raw('SUM(dmmar) as "mar"'), DB::Raw('SUM(dmapr) as "apr"'), DB::Raw('SUM(dmmay) as "may"'), DB::Raw('SUM(dmjun) as "jun"'), DB::Raw('SUM(dmjul) as "jul"'), DB::Raw('SUM(dmaug) as "aug"'), DB::Raw('SUM(dmsep) as "sep", SUM(dmoct) as "oct"'), DB::Raw('SUM(dmnov) as "nov"'), DB::Raw('SUM(dmdec) as "dec"'), DB::Raw('concat(chapter, " ", district) as description'))->groupby('rhq')->groupby('zone')->groupby('chapter')->groupby('district');
        }
        elseif ( $divisiontype == 'YWD')
        {
            return $query->whereIn('rhq', array('H1', 'H2', 'H3', 'H4', 'H5', 'H6', 'H7', 'H8', 'H9'))->where('division', 'YW')->whereNotIn('district', array("-"))->select('rhq', 'zone', 'chapter', 'district', DB::Raw('SUM(dmjan) as "jan"'), DB::Raw('SUM(dmfeb) as "feb"'), DB::Raw('SUM(dmmar) as "mar"'), DB::Raw('SUM(dmapr) as "apr"'), DB::Raw('SUM(dmmay) as "may"'), DB::Raw('SUM(dmjun) as "jun"'), DB::Raw('SUM(dmjul) as "jul"'), DB::Raw('SUM(dmaug) as "aug"'), DB::Raw('SUM(dmsep) as "sep", SUM(dmoct) as "oct"'), DB::Raw('SUM(dmnov) as "nov"'), DB::Raw('SUM(dmdec) as "dec"'), DB::Raw('concat(chapter, " ", district) as description'))->groupby('rhq')->groupby('zone')->groupby('chapter')->groupby('district');
        }
        elseif ( $divisiontype == 'Primary Division')
        {
            return $query->whereIn('rhq', array('H1', 'H2', 'H3', 'H4', 'H5', 'H6', 'H7', 'H8', 'H9'))->where('agegroup', '07 to 12')->whereNotIn('district', array("-"))->select('rhq', 'zone', 'chapter', 'district', DB::Raw('SUM(dmjan) as "jan"'), DB::Raw('SUM(dmfeb) as "feb"'), DB::Raw('SUM(dmmar) as "mar"'), DB::Raw('SUM(dmapr) as "apr"'), DB::Raw('SUM(dmmay) as "may"'), DB::Raw('SUM(dmjun) as "jun"'), DB::Raw('SUM(dmjul) as "jul"'), DB::Raw('SUM(dmaug) as "aug"'), DB::Raw('SUM(dmsep) as "sep", SUM(dmoct) as "oct"'), DB::Raw('SUM(dmnov) as "nov"'), DB::Raw('SUM(dmdec) as "dec"'), DB::Raw('concat(chapter, " ", district) as description'))->groupby('rhq')->groupby('zone')->groupby('chapter')->groupby('district');
        }
        elseif ( $divisiontype == 'Future Division')
        {
            return $query->whereIn('rhq', array('H1', 'H2', 'H3', 'H4', 'H5', 'H6', 'H7', 'H8', 'H9'))->where('agegroup', '13 to 16')->whereNotIn('district', array("-"))->select('rhq', 'zone', 'chapter', 'district', DB::Raw('SUM(dmjan) as "jan"'), DB::Raw('SUM(dmfeb) as "feb"'), DB::Raw('SUM(dmmar) as "mar"'), DB::Raw('SUM(dmapr) as "apr"'), DB::Raw('SUM(dmmay) as "may"'), DB::Raw('SUM(dmjun) as "jun"'), DB::Raw('SUM(dmjul) as "jul"'), DB::Raw('SUM(dmaug) as "aug"'), DB::Raw('SUM(dmsep) as "sep", SUM(dmoct) as "oct"'), DB::Raw('SUM(dmnov) as "nov"'), DB::Raw('SUM(dmdec) as "dec"'), DB::Raw('concat(chapter, " ", district) as description'))->groupby('rhq')->groupby('zone')->groupby('chapter')->groupby('district');
        }
        elseif ( $divisiontype == 'Student Division')
        {
            return $query->whereIn('rhq', array('H1', 'H2', 'H3', 'H4', 'H5', 'H6', 'H7', 'H8', 'H9'))->where('studentdivision', '!=', '')->whereNotIn('district', array("-"))->select('rhq', 'zone', 'chapter', 'district', DB::Raw('SUM(dmjan) as "jan"'), DB::Raw('SUM(dmfeb) as "feb"'), DB::Raw('SUM(dmmar) as "mar"'), DB::Raw('SUM(dmapr) as "apr"'), DB::Raw('SUM(dmmay) as "may"'), DB::Raw('SUM(dmjun) as "jun"'), DB::Raw('SUM(dmjul) as "jul"'), DB::Raw('SUM(dmaug) as "aug"'), DB::Raw('SUM(dmsep) as "sep", SUM(dmoct) as "oct"'), DB::Raw('SUM(dmnov) as "nov"'), DB::Raw('SUM(dmdec) as "dec"'), DB::Raw('concat(chapter, " ", district) as description'))->groupby('rhq')->groupby('zone')->groupby('chapter')->groupby('district');
        }
        elseif ( $divisiontype == 'Adult Division')
        {
            return $query->whereIn('rhq', array('H1', 'H2', 'H3', 'H4', 'H5', 'H6', 'H7', 'H8', 'H9'))->whereIn('division', array('MD', 'WD'))->whereNotIn('district', array("-"))->select('rhq', 'zone', 'chapter', 'district', DB::Raw('SUM(dmjan) as "jan"'), DB::Raw('SUM(dmfeb) as "feb"'), DB::Raw('SUM(dmmar) as "mar"'), DB::Raw('SUM(dmapr) as "apr"'), DB::Raw('SUM(dmmay) as "may"'), DB::Raw('SUM(dmjun) as "jun"'), DB::Raw('SUM(dmjul) as "jul"'), DB::Raw('SUM(dmaug) as "aug"'), DB::Raw('SUM(dmsep) as "sep", SUM(dmoct) as "oct"'), DB::Raw('SUM(dmnov) as "nov"'), DB::Raw('SUM(dmdec) as "dec"'), DB::Raw('concat(chapter, " ", district) as description'))->groupby('rhq')->groupby('zone')->groupby('chapter')->groupby('district');
        }
        elseif ( $divisiontype == 'Youth Division')
        {
            return $query->whereIn('rhq', array('H1', 'H2', 'H3', 'H4', 'H5', 'H6', 'H7', 'H8', 'H9'))->whereIn('division', array('YM', 'YW'))->whereNotIn('district', array("-"))->select('rhq', 'zone', 'chapter', 'district', DB::Raw('SUM(dmjan) as "jan"'), DB::Raw('SUM(dmfeb) as "feb"'), DB::Raw('SUM(dmmar) as "mar"'), DB::Raw('SUM(dmapr) as "apr"'), DB::Raw('SUM(dmmay) as "may"'), DB::Raw('SUM(dmjun) as "jun"'), DB::Raw('SUM(dmjul) as "jul"'), DB::Raw('SUM(dmaug) as "aug"'), DB::Raw('SUM(dmsep) as "sep", SUM(dmoct) as "oct"'), DB::Raw('SUM(dmnov) as "nov"'), DB::Raw('SUM(dmdec) as "dec"'), DB::Raw('concat(chapter, " ", district) as description'))->groupby('rhq')->groupby('zone')->groupby('chapter')->groupby('district');
        }
    }

    public function scopeRHQAgeGroupStats($query, $value, $divisiontype)
    {
        if ( $divisiontype == 'All' or $divisiontype == "4 Division")
        {
            return $query->whereIn('rhq', array('H1', 'H2', 'H3', 'H4', 'H5', 'H6', 'H7', 'H8', 'H9'))->whereNotIn('district', array("-"))->select('rhq', 'zone', 'chapter', 'district', 'agegroup', DB::Raw('SUM(dmjan) as "jan"'), DB::Raw('SUM(dmfeb) as "feb"'), DB::Raw('SUM(dmmar) as "mar"'), DB::Raw('SUM(dmapr) as "apr"'), DB::Raw('SUM(dmmay) as "may"'), DB::Raw('SUM(dmjun) as "jun"'), DB::Raw('SUM(dmjul) as "jul"'), DB::Raw('SUM(dmaug) as "aug"'), DB::Raw('SUM(dmsep) as "sep", SUM(dmoct) as "oct"'), DB::Raw('SUM(dmnov) as "nov"'), DB::Raw('SUM(dmdec) as "dec"'), DB::Raw('concat(chapter, " ", district) as description'))->groupby('rhq')->groupby('zone')->groupby('chapter')->groupby('district')->groupby('agegroup');
        }
        elseif ( $divisiontype == 'MD')
        {
            return $query->whereIn('rhq', array('H1', 'H2', 'H3', 'H4', 'H5', 'H6', 'H7', 'H8', 'H9'))->where('division', 'MD')->whereNotIn('district', array("-"))->select('rhq', 'zone', 'chapter', 'district', 'agegroup', DB::Raw('SUM(dmjan) as "jan"'), DB::Raw('SUM(dmfeb) as "feb"'), DB::Raw('SUM(dmmar) as "mar"'), DB::Raw('SUM(dmapr) as "apr"'), DB::Raw('SUM(dmmay) as "may"'), DB::Raw('SUM(dmjun) as "jun"'), DB::Raw('SUM(dmjul) as "jul"'), DB::Raw('SUM(dmaug) as "aug"'), DB::Raw('SUM(dmsep) as "sep", SUM(dmoct) as "oct"'), DB::Raw('SUM(dmnov) as "nov"'), DB::Raw('SUM(dmdec) as "dec"'), DB::Raw('concat(chapter, " ", district) as description'))->groupby('rhq')->groupby('zone')->groupby('chapter')->groupby('district')->groupby('agegroup');
        }
        elseif ( $divisiontype == 'WD')
        {
            return $query->whereIn('rhq', array('H1', 'H2', 'H3', 'H4', 'H5', 'H6', 'H7', 'H8', 'H9'))->where('division', 'WD')->whereNotIn('district', array("-"))->select('rhq', 'zone', 'chapter', 'district', 'agegroup', DB::Raw('SUM(dmjan) as "jan"'), DB::Raw('SUM(dmfeb) as "feb"'), DB::Raw('SUM(dmmar) as "mar"'), DB::Raw('SUM(dmapr) as "apr"'), DB::Raw('SUM(dmmay) as "may"'), DB::Raw('SUM(dmjun) as "jun"'), DB::Raw('SUM(dmjul) as "jul"'), DB::Raw('SUM(dmaug) as "aug"'), DB::Raw('SUM(dmsep) as "sep", SUM(dmoct) as "oct"'), DB::Raw('SUM(dmnov) as "nov"'), DB::Raw('SUM(dmdec) as "dec"'), DB::Raw('concat(chapter, " ", district) as description'))->groupby('rhq')->groupby('zone')->groupby('chapter')->groupby('district')->groupby('agegroup');
        }
        elseif ( $divisiontype == 'YMD')
        {
            return $query->whereIn('rhq', array('H1', 'H2', 'H3', 'H4', 'H5', 'H6', 'H7', 'H8', 'H9'))->where('division', 'YM')->whereNotIn('district', array("-"))->select('rhq', 'zone', 'chapter', 'district', 'agegroup', DB::Raw('SUM(dmjan) as "jan"'), DB::Raw('SUM(dmfeb) as "feb"'), DB::Raw('SUM(dmmar) as "mar"'), DB::Raw('SUM(dmapr) as "apr"'), DB::Raw('SUM(dmmay) as "may"'), DB::Raw('SUM(dmjun) as "jun"'), DB::Raw('SUM(dmjul) as "jul"'), DB::Raw('SUM(dmaug) as "aug"'), DB::Raw('SUM(dmsep) as "sep", SUM(dmoct) as "oct"'), DB::Raw('SUM(dmnov) as "nov"'), DB::Raw('SUM(dmdec) as "dec"'), DB::Raw('concat(chapter, " ", district) as description'))->groupby('rhq')->groupby('zone')->groupby('chapter')->groupby('district')->groupby('agegroup');
        }
        elseif ( $divisiontype == 'YWD')
        {
            return $query->whereIn('rhq', array('H1', 'H2', 'H3', 'H4', 'H5', 'H6', 'H7', 'H8', 'H9'))->where('division', 'YW')->whereNotIn('district', array("-"))->select('rhq', 'zone', 'chapter', 'district', 'agegroup', DB::Raw('SUM(dmjan) as "jan"'), DB::Raw('SUM(dmfeb) as "feb"'), DB::Raw('SUM(dmmar) as "mar"'), DB::Raw('SUM(dmapr) as "apr"'), DB::Raw('SUM(dmmay) as "may"'), DB::Raw('SUM(dmjun) as "jun"'), DB::Raw('SUM(dmjul) as "jul"'), DB::Raw('SUM(dmaug) as "aug"'), DB::Raw('SUM(dmsep) as "sep", SUM(dmoct) as "oct"'), DB::Raw('SUM(dmnov) as "nov"'), DB::Raw('SUM(dmdec) as "dec"'), DB::Raw('concat(chapter, " ", district) as description'))->groupby('rhq')->groupby('zone')->groupby('chapter')->groupby('district')->groupby('agegroup');
        }
        elseif ( $divisiontype == 'Primary Division')
        {
            return $query->whereIn('rhq', array('H1', 'H2', 'H3', 'H4', 'H5', 'H6', 'H7', 'H8', 'H9'))->where('agegroup', '07 to 12')->whereNotIn('district', array("-"))->select('rhq', 'zone', 'chapter', 'district', 'agegroup', DB::Raw('SUM(dmjan) as "jan"'), DB::Raw('SUM(dmfeb) as "feb"'), DB::Raw('SUM(dmmar) as "mar"'), DB::Raw('SUM(dmapr) as "apr"'), DB::Raw('SUM(dmmay) as "may"'), DB::Raw('SUM(dmjun) as "jun"'), DB::Raw('SUM(dmjul) as "jul"'), DB::Raw('SUM(dmaug) as "aug"'), DB::Raw('SUM(dmsep) as "sep", SUM(dmoct) as "oct"'), DB::Raw('SUM(dmnov) as "nov"'), DB::Raw('SUM(dmdec) as "dec"'), DB::Raw('concat(chapter, " ", district) as description'))->groupby('rhq')->groupby('zone')->groupby('chapter')->groupby('district')->groupby('agegroup');
        }
        elseif ( $divisiontype == 'Future Division')
        {
            return $query->whereIn('rhq', array('H1', 'H2', 'H3', 'H4', 'H5', 'H6', 'H7', 'H8', 'H9'))->where('agegroup', '13 to 16')->whereNotIn('district', array("-"))->select('rhq', 'zone', 'chapter', 'district', 'agegroup', DB::Raw('SUM(dmjan) as "jan"'), DB::Raw('SUM(dmfeb) as "feb"'), DB::Raw('SUM(dmmar) as "mar"'), DB::Raw('SUM(dmapr) as "apr"'), DB::Raw('SUM(dmmay) as "may"'), DB::Raw('SUM(dmjun) as "jun"'), DB::Raw('SUM(dmjul) as "jul"'), DB::Raw('SUM(dmaug) as "aug"'), DB::Raw('SUM(dmsep) as "sep", SUM(dmoct) as "oct"'), DB::Raw('SUM(dmnov) as "nov"'), DB::Raw('SUM(dmdec) as "dec"'), DB::Raw('concat(chapter, " ", district) as description'))->groupby('rhq')->groupby('zone')->groupby('chapter')->groupby('district')->groupby('agegroup');
        }
        elseif ( $divisiontype == 'Student Division')
        {
            return $query->whereIn('rhq', array('H1', 'H2', 'H3', 'H4', 'H5', 'H6', 'H7', 'H8', 'H9'))->where('studentdivision', '!=', '')->whereNotIn('district', array("-"))->select('rhq', 'zone', 'chapter', 'district', 'agegroup', DB::Raw('SUM(dmjan) as "jan"'), DB::Raw('SUM(dmfeb) as "feb"'), DB::Raw('SUM(dmmar) as "mar"'), DB::Raw('SUM(dmapr) as "apr"'), DB::Raw('SUM(dmmay) as "may"'), DB::Raw('SUM(dmjun) as "jun"'), DB::Raw('SUM(dmjul) as "jul"'), DB::Raw('SUM(dmaug) as "aug"'), DB::Raw('SUM(dmsep) as "sep", SUM(dmoct) as "oct"'), DB::Raw('SUM(dmnov) as "nov"'), DB::Raw('SUM(dmdec) as "dec"'), DB::Raw('concat(chapter, " ", district) as description'))->groupby('rhq')->groupby('zone')->groupby('chapter')->groupby('district')->groupby('agegroup');
        }
        elseif ( $divisiontype == 'Adult Division')
        {
            return $query->whereIn('rhq', array('H1', 'H2', 'H3', 'H4', 'H5', 'H6', 'H7', 'H8', 'H9'))->whereIn('division', array('MD', 'WD'))->whereNotIn('district', array("-"))->select('rhq', 'zone', 'chapter', 'district', 'agegroup', DB::Raw('SUM(dmjan) as "jan"'), DB::Raw('SUM(dmfeb) as "feb"'), DB::Raw('SUM(dmmar) as "mar"'), DB::Raw('SUM(dmapr) as "apr"'), DB::Raw('SUM(dmmay) as "may"'), DB::Raw('SUM(dmjun) as "jun"'), DB::Raw('SUM(dmjul) as "jul"'), DB::Raw('SUM(dmaug) as "aug"'), DB::Raw('SUM(dmsep) as "sep", SUM(dmoct) as "oct"'), DB::Raw('SUM(dmnov) as "nov"'), DB::Raw('SUM(dmdec) as "dec"'), DB::Raw('concat(chapter, " ", district) as description'))->groupby('rhq')->groupby('zone')->groupby('chapter')->groupby('district')->groupby('agegroup');
        }
        elseif ( $divisiontype == 'Youth Division')
        {
            return $query->whereIn('rhq', array('H1', 'H2', 'H3', 'H4', 'H5', 'H6', 'H7', 'H8', 'H9'))->whereIn('division', array('YM', 'YW'))->whereNotIn('district', array("-"))->select('rhq', 'zone', 'chapter', 'district', 'agegroup', DB::Raw('SUM(dmjan) as "jan"'), DB::Raw('SUM(dmfeb) as "feb"'), DB::Raw('SUM(dmmar) as "mar"'), DB::Raw('SUM(dmapr) as "apr"'), DB::Raw('SUM(dmmay) as "may"'), DB::Raw('SUM(dmjun) as "jun"'), DB::Raw('SUM(dmjul) as "jul"'), DB::Raw('SUM(dmaug) as "aug"'), DB::Raw('SUM(dmsep) as "sep", SUM(dmoct) as "oct"'), DB::Raw('SUM(dmnov) as "nov"'), DB::Raw('SUM(dmdec) as "dec"'), DB::Raw('concat(chapter, " ", district) as description'))->groupby('rhq')->groupby('zone')->groupby('chapter')->groupby('district')->groupby('agegroup');
        }
    }

    public function scopeNameList($query, $value, $divisiontype)
    {
        if ( $divisiontype == 'All' or $divisiontype == "4 Division")
        {
            return $query->whereIn('rhq', array('H1', 'H2', 'H3', 'H4', 'H5', 'H6', 'H7', 'H8', 'H9'))->whereNotIn('district', array("-"))->select('name', 'rhq', 'zone', 'chapter', 'district', 'division', 'position', DB::Raw('SUM(dmjan) as "jan"'), DB::Raw('SUM(dmfeb) as "feb"'), DB::Raw('SUM(dmmar) as "mar"'), DB::Raw('SUM(dmapr) as "apr"'), DB::Raw('SUM(dmmay) as "may"'), DB::Raw('SUM(dmjun) as "jun"'), DB::Raw('SUM(dmjul) as "jul"'), DB::Raw('SUM(dmaug) as "aug"'), DB::Raw('SUM(dmsep) as "sep", SUM(dmoct) as "oct"'), DB::Raw('SUM(dmnov) as "nov"'), DB::Raw('SUM(dmdec) as "dec"'), DB::Raw('concat(chapter, " ", district) as description'))->groupby('rhq')->groupby('zone')->groupby('chapter')->groupby('district')->groupby('name');
        }
        elseif ( $divisiontype == 'MD')
        {
            return $query->whereIn('rhq', array('H1', 'H2', 'H3', 'H4', 'H5', 'H6', 'H7', 'H8', 'H9'))->where('division', 'MD')->whereNotIn('district', array("-"))->select('name', 'rhq', 'zone', 'chapter', 'district', 'division', 'position', DB::Raw('SUM(dmjan) as "jan"'), DB::Raw('SUM(dmfeb) as "feb"'), DB::Raw('SUM(dmmar) as "mar"'), DB::Raw('SUM(dmapr) as "apr"'), DB::Raw('SUM(dmmay) as "may"'), DB::Raw('SUM(dmjun) as "jun"'), DB::Raw('SUM(dmjul) as "jul"'), DB::Raw('SUM(dmaug) as "aug"'), DB::Raw('SUM(dmsep) as "sep", SUM(dmoct) as "oct"'), DB::Raw('SUM(dmnov) as "nov"'), DB::Raw('SUM(dmdec) as "dec"'), DB::Raw('concat(chapter, " ", district) as description'))->groupby('rhq')->groupby('zone')->groupby('chapter')->groupby('district')->groupby('name');
        }
        elseif ( $divisiontype == 'WD')
        {
            return $query->whereIn('rhq', array('H1', 'H2', 'H3', 'H4', 'H5', 'H6', 'H7', 'H8', 'H9'))->where('division', 'WD')->whereNotIn('district', array("-"))->select('name', 'rhq', 'zone', 'chapter', 'district', 'division', 'position', DB::Raw('SUM(dmjan) as "jan"'), DB::Raw('SUM(dmfeb) as "feb"'), DB::Raw('SUM(dmmar) as "mar"'), DB::Raw('SUM(dmapr) as "apr"'), DB::Raw('SUM(dmmay) as "may"'), DB::Raw('SUM(dmjun) as "jun"'), DB::Raw('SUM(dmjul) as "jul"'), DB::Raw('SUM(dmaug) as "aug"'), DB::Raw('SUM(dmsep) as "sep", SUM(dmoct) as "oct"'), DB::Raw('SUM(dmnov) as "nov"'), DB::Raw('SUM(dmdec) as "dec"'), DB::Raw('concat(chapter, " ", district) as description'))->groupby('rhq')->groupby('zone')->groupby('chapter')->groupby('district')->groupby('name');
        }
        elseif ( $divisiontype == 'YMD')
        {
            return $query->whereIn('rhq', array('H1', 'H2', 'H3', 'H4', 'H5', 'H6', 'H7', 'H8', 'H9'))->where('division', 'YM')->whereNotIn('district', array("-"))->select('name', 'rhq', 'zone', 'chapter', 'district', 'division', 'position', DB::Raw('SUM(dmjan) as "jan"'), DB::Raw('SUM(dmfeb) as "feb"'), DB::Raw('SUM(dmmar) as "mar"'), DB::Raw('SUM(dmapr) as "apr"'), DB::Raw('SUM(dmmay) as "may"'), DB::Raw('SUM(dmjun) as "jun"'), DB::Raw('SUM(dmjul) as "jul"'), DB::Raw('SUM(dmaug) as "aug"'), DB::Raw('SUM(dmsep) as "sep", SUM(dmoct) as "oct"'), DB::Raw('SUM(dmnov) as "nov"'), DB::Raw('SUM(dmdec) as "dec"'), DB::Raw('concat(chapter, " ", district) as description'))->groupby('rhq')->groupby('zone')->groupby('chapter')->groupby('district')->groupby('name');
        }
        elseif ( $divisiontype == 'YWD')
        {
            return $query->whereIn('rhq', array('H1', 'H2', 'H3', 'H4', 'H5', 'H6', 'H7', 'H8', 'H9'))->where('division', 'YW')->whereNotIn('district', array("-"))->select('name', 'rhq', 'zone', 'chapter', 'district', 'division', 'position', DB::Raw('SUM(dmjan) as "jan"'), DB::Raw('SUM(dmfeb) as "feb"'), DB::Raw('SUM(dmmar) as "mar"'), DB::Raw('SUM(dmapr) as "apr"'), DB::Raw('SUM(dmmay) as "may"'), DB::Raw('SUM(dmjun) as "jun"'), DB::Raw('SUM(dmjul) as "jul"'), DB::Raw('SUM(dmaug) as "aug"'), DB::Raw('SUM(dmsep) as "sep", SUM(dmoct) as "oct"'), DB::Raw('SUM(dmnov) as "nov"'), DB::Raw('SUM(dmdec) as "dec"'), DB::Raw('concat(chapter, " ", district) as description'))->groupby('rhq')->groupby('zone')->groupby('chapter')->groupby('district')->groupby('name');
        }
        elseif ( $divisiontype == 'Primary Division')
        {
            return $query->whereIn('rhq', array('H1', 'H2', 'H3', 'H4', 'H5', 'H6', 'H7', 'H8', 'H9'))->where('agegroup', '07 to 12')->whereNotIn('district', array("-"))->select('name', 'rhq', 'zone', 'chapter', 'district', 'division', 'position', DB::Raw('SUM(dmjan) as "jan"'), DB::Raw('SUM(dmfeb) as "feb"'), DB::Raw('SUM(dmmar) as "mar"'), DB::Raw('SUM(dmapr) as "apr"'), DB::Raw('SUM(dmmay) as "may"'), DB::Raw('SUM(dmjun) as "jun"'), DB::Raw('SUM(dmjul) as "jul"'), DB::Raw('SUM(dmaug) as "aug"'), DB::Raw('SUM(dmsep) as "sep", SUM(dmoct) as "oct"'), DB::Raw('SUM(dmnov) as "nov"'), DB::Raw('SUM(dmdec) as "dec"'), DB::Raw('concat(chapter, " ", district) as description'))->groupby('rhq')->groupby('zone')->groupby('chapter')->groupby('district')->groupby('name');
        }
        elseif ( $divisiontype == 'Future Division')
        {
            return $query->whereIn('rhq', array('H1', 'H2', 'H3', 'H4', 'H5', 'H6', 'H7', 'H8', 'H9'))->where('agegroup', '13 to 16')->whereNotIn('district', array("-"))->select('name', 'rhq', 'zone', 'chapter', 'district', 'division', 'position', DB::Raw('SUM(dmjan) as "jan"'), DB::Raw('SUM(dmfeb) as "feb"'), DB::Raw('SUM(dmmar) as "mar"'), DB::Raw('SUM(dmapr) as "apr"'), DB::Raw('SUM(dmmay) as "may"'), DB::Raw('SUM(dmjun) as "jun"'), DB::Raw('SUM(dmjul) as "jul"'), DB::Raw('SUM(dmaug) as "aug"'), DB::Raw('SUM(dmsep) as "sep", SUM(dmoct) as "oct"'), DB::Raw('SUM(dmnov) as "nov"'), DB::Raw('SUM(dmdec) as "dec"'), DB::Raw('concat(chapter, " ", district) as description'))->groupby('rhq')->groupby('zone')->groupby('chapter')->groupby('district')->groupby('name');
        }
        elseif ( $divisiontype == 'Student Division')
        {
            return $query->whereIn('rhq', array('H1', 'H2', 'H3', 'H4', 'H5', 'H6', 'H7', 'H8', 'H9'))->where('studentdivision', '!=', '')->whereNotIn('district', array("-"))->select('name', 'rhq', 'zone', 'chapter', 'district', 'division', 'position', DB::Raw('SUM(dmjan) as "jan"'), DB::Raw('SUM(dmfeb) as "feb"'), DB::Raw('SUM(dmmar) as "mar"'), DB::Raw('SUM(dmapr) as "apr"'), DB::Raw('SUM(dmmay) as "may"'), DB::Raw('SUM(dmjun) as "jun"'), DB::Raw('SUM(dmjul) as "jul"'), DB::Raw('SUM(dmaug) as "aug"'), DB::Raw('SUM(dmsep) as "sep", SUM(dmoct) as "oct"'), DB::Raw('SUM(dmnov) as "nov"'), DB::Raw('SUM(dmdec) as "dec"'), DB::Raw('concat(chapter, " ", district) as description'))->groupby('rhq')->groupby('zone')->groupby('chapter')->groupby('district')->groupby('name');
        }
        elseif ( $divisiontype == 'Adult Division')
        {
            return $query->whereIn('rhq', array('H1', 'H2', 'H3', 'H4', 'H5', 'H6', 'H7', 'H8', 'H9'))->whereIn('division', array('MD', 'WD'))->whereNotIn('district', array("-"))->select('name', 'rhq', 'zone', 'chapter', 'district', 'division', 'position', DB::Raw('SUM(dmjan) as "jan"'), DB::Raw('SUM(dmfeb) as "feb"'), DB::Raw('SUM(dmmar) as "mar"'), DB::Raw('SUM(dmapr) as "apr"'), DB::Raw('SUM(dmmay) as "may"'), DB::Raw('SUM(dmjun) as "jun"'), DB::Raw('SUM(dmjul) as "jul"'), DB::Raw('SUM(dmaug) as "aug"'), DB::Raw('SUM(dmsep) as "sep", SUM(dmoct) as "oct"'), DB::Raw('SUM(dmnov) as "nov"'), DB::Raw('SUM(dmdec) as "dec"'), DB::Raw('concat(chapter, " ", district) as description'))->groupby('rhq')->groupby('zone')->groupby('chapter')->groupby('district')->groupby('name');
        }
        elseif ( $divisiontype == 'Youth Division')
        {
            return $query->whereIn('rhq', array('H1', 'H2', 'H3', 'H4', 'H5', 'H6', 'H7', 'H8', 'H9'))->whereIn('division', array('YM', 'YW'))->whereNotIn('district', array("-"))->select('name', 'rhq', 'zone', 'chapter', 'district', 'division', 'position', DB::Raw('SUM(dmjan) as "jan"'), DB::Raw('SUM(dmfeb) as "feb"'), DB::Raw('SUM(dmmar) as "mar"'), DB::Raw('SUM(dmapr) as "apr"'), DB::Raw('SUM(dmmay) as "may"'), DB::Raw('SUM(dmjun) as "jun"'), DB::Raw('SUM(dmjul) as "jul"'), DB::Raw('SUM(dmaug) as "aug"'), DB::Raw('SUM(dmsep) as "sep", SUM(dmoct) as "oct"'), DB::Raw('SUM(dmnov) as "nov"'), DB::Raw('SUM(dmdec) as "dec"'), DB::Raw('concat(chapter, " ", district) as description'))->groupby('rhq')->groupby('zone')->groupby('chapter')->groupby('district')->groupby('name');
        }
    }

    public function scopeLPRHQAgeGroupStats($query, $value, $divisiontype)
    {
        if ( $divisiontype == 'All' or $divisiontype == "4 Division")
        {
            if (Session::get('gakkaiuserpositionlevel') == 'shq' ) {
                return $query->whereNotIn('district', array("-"))->select('rhq', 'zone', 'chapter', 'district', 'agegroup', DB::Raw('SUM(dmjan) as "jan"'), DB::Raw('SUM(dmfeb) as "feb"'), DB::Raw('SUM(dmmar) as "mar"'), DB::Raw('SUM(dmapr) as "apr"'), DB::Raw('SUM(dmmay) as "may"'), DB::Raw('SUM(dmjun) as "jun"'), DB::Raw('SUM(dmjul) as "jul"'), DB::Raw('SUM(dmaug) as "aug"'), DB::Raw('SUM(dmsep) as "sep", SUM(dmoct) as "oct"'), DB::Raw('SUM(dmnov) as "nov"'), DB::Raw('SUM(dmdec) as "dec"'), DB::Raw('concat(chapter, " ", district) as description'))->groupby('rhq')->groupby('zone')->groupby('chapter')->groupby('district')->groupby('agegroup');
            } else if (Session::get('gakkaiuserpositionlevel') == 'rhq' ) {
                return $query->where('rhq', Session::get('gakkaiuserrhq'))->whereNotIn('district', array("-"))->select('rhq', 'zone', 'chapter', 'district', 'agegroup', DB::Raw('SUM(dmjan) as "jan"'), DB::Raw('SUM(dmfeb) as "feb"'), DB::Raw('SUM(dmmar) as "mar"'), DB::Raw('SUM(dmapr) as "apr"'), DB::Raw('SUM(dmmay) as "may"'), DB::Raw('SUM(dmjun) as "jun"'), DB::Raw('SUM(dmjul) as "jul"'), DB::Raw('SUM(dmaug) as "aug"'), DB::Raw('SUM(dmsep) as "sep", SUM(dmoct) as "oct"'), DB::Raw('SUM(dmnov) as "nov"'), DB::Raw('SUM(dmdec) as "dec"'), DB::Raw('concat(chapter, " ", district) as description'))->groupby('rhq')->groupby('zone')->groupby('chapter')->groupby('district')->groupby('agegroup');
            } else if (Session::get('gakkaiuserpositionlevel') == 'zone' ) {
                return $query->where('zone', Session::get('gakkaiuserzone'))->whereNotIn('district', array("-"))->select('rhq', 'zone', 'chapter', 'district', 'agegroup', DB::Raw('SUM(dmjan) as "jan"'), DB::Raw('SUM(dmfeb) as "feb"'), DB::Raw('SUM(dmmar) as "mar"'), DB::Raw('SUM(dmapr) as "apr"'), DB::Raw('SUM(dmmay) as "may"'), DB::Raw('SUM(dmjun) as "jun"'), DB::Raw('SUM(dmjul) as "jul"'), DB::Raw('SUM(dmaug) as "aug"'), DB::Raw('SUM(dmsep) as "sep", SUM(dmoct) as "oct"'), DB::Raw('SUM(dmnov) as "nov"'), DB::Raw('SUM(dmdec) as "dec"'), DB::Raw('concat(chapter, " ", district) as description'))->groupby('rhq')->groupby('zone')->groupby('chapter')->groupby('district')->groupby('agegroup');
            } else if (Session::get('gakkaiuserpositionlevel') == 'chapter' ) {
                return $query->where('chapter', Session::get('gakkaiuserchapter'))->whereNotIn('district', array("-"))->select('rhq', 'zone', 'chapter', 'district', 'agegroup', DB::Raw('SUM(dmjan) as "jan"'), DB::Raw('SUM(dmfeb) as "feb"'), DB::Raw('SUM(dmmar) as "mar"'), DB::Raw('SUM(dmapr) as "apr"'), DB::Raw('SUM(dmmay) as "may"'), DB::Raw('SUM(dmjun) as "jun"'), DB::Raw('SUM(dmjul) as "jul"'), DB::Raw('SUM(dmaug) as "aug"'), DB::Raw('SUM(dmsep) as "sep", SUM(dmoct) as "oct"'), DB::Raw('SUM(dmnov) as "nov"'), DB::Raw('SUM(dmdec) as "dec"'), DB::Raw('concat(chapter, " ", district) as description'))->groupby('rhq')->groupby('zone')->groupby('chapter')->groupby('district')->groupby('agegroup');
            } else if (Session::get('gakkaiuserpositionlevel') == 'district' ) {
                return $query->where('chapter', Session::get('gakkaiuserchapter'))->where('district', Session::get('gakkaiuserdistrict'))->whereNotIn('district', array("-"))->select('rhq', 'zone', 'chapter', 'district', 'agegroup', DB::Raw('SUM(dmjan) as "jan"'), DB::Raw('SUM(dmfeb) as "feb"'), DB::Raw('SUM(dmmar) as "mar"'), DB::Raw('SUM(dmapr) as "apr"'), DB::Raw('SUM(dmmay) as "may"'), DB::Raw('SUM(dmjun) as "jun"'), DB::Raw('SUM(dmjul) as "jul"'), DB::Raw('SUM(dmaug) as "aug"'), DB::Raw('SUM(dmsep) as "sep", SUM(dmoct) as "oct"'), DB::Raw('SUM(dmnov) as "nov"'), DB::Raw('SUM(dmdec) as "dec"'), DB::Raw('concat(chapter, " ", district) as description'))->groupby('rhq')->groupby('zone')->groupby('chapter')->groupby('district')->groupby('agegroup');
            }
        }
        elseif ( $divisiontype == 'MD')
        {
            if (Session::get('gakkaiuserpositionlevel') == 'shq' ) {
                return $query->where('division', 'MD')->whereNotIn('district', array("-"))->select('rhq', 'zone', 'chapter', 'district', 'agegroup', DB::Raw('SUM(dmjan) as "jan"'), DB::Raw('SUM(dmfeb) as "feb"'), DB::Raw('SUM(dmmar) as "mar"'), DB::Raw('SUM(dmapr) as "apr"'), DB::Raw('SUM(dmmay) as "may"'), DB::Raw('SUM(dmjun) as "jun"'), DB::Raw('SUM(dmjul) as "jul"'), DB::Raw('SUM(dmaug) as "aug"'), DB::Raw('SUM(dmsep) as "sep", SUM(dmoct) as "oct"'), DB::Raw('SUM(dmnov) as "nov"'), DB::Raw('SUM(dmdec) as "dec"'), DB::Raw('concat(chapter, " ", district) as description'))->groupby('rhq')->groupby('zone')->groupby('chapter')->groupby('district')->groupby('agegroup');
            } else if (Session::get('gakkaiuserpositionlevel') == 'rhq' ) {
                return $query->where('rhq', Session::get('gakkaiuserrhq'))->where('division', 'MD')->whereNotIn('district', array("-"))->select('rhq', 'zone', 'chapter', 'district', 'agegroup', DB::Raw('SUM(dmjan) as "jan"'), DB::Raw('SUM(dmfeb) as "feb"'), DB::Raw('SUM(dmmar) as "mar"'), DB::Raw('SUM(dmapr) as "apr"'), DB::Raw('SUM(dmmay) as "may"'), DB::Raw('SUM(dmjun) as "jun"'), DB::Raw('SUM(dmjul) as "jul"'), DB::Raw('SUM(dmaug) as "aug"'), DB::Raw('SUM(dmsep) as "sep", SUM(dmoct) as "oct"'), DB::Raw('SUM(dmnov) as "nov"'), DB::Raw('SUM(dmdec) as "dec"'), DB::Raw('concat(chapter, " ", district) as description'))->groupby('rhq')->groupby('zone')->groupby('chapter')->groupby('district')->groupby('agegroup');
            } else if (Session::get('gakkaiuserpositionlevel') == 'zone' ) {
                return $query->where('zone', Session::get('gakkaiuserzone'))->where('division', 'MD')->whereNotIn('district', array("-"))->select('rhq', 'zone', 'chapter', 'district', 'agegroup', DB::Raw('SUM(dmjan) as "jan"'), DB::Raw('SUM(dmfeb) as "feb"'), DB::Raw('SUM(dmmar) as "mar"'), DB::Raw('SUM(dmapr) as "apr"'), DB::Raw('SUM(dmmay) as "may"'), DB::Raw('SUM(dmjun) as "jun"'), DB::Raw('SUM(dmjul) as "jul"'), DB::Raw('SUM(dmaug) as "aug"'), DB::Raw('SUM(dmsep) as "sep", SUM(dmoct) as "oct"'), DB::Raw('SUM(dmnov) as "nov"'), DB::Raw('SUM(dmdec) as "dec"'), DB::Raw('concat(chapter, " ", district) as description'))->groupby('rhq')->groupby('zone')->groupby('chapter')->groupby('district')->groupby('agegroup');
            } else if (Session::get('gakkaiuserpositionlevel') == 'chapter' ) {
                return $query->where('chapter', Session::get('gakkaiuserchapter'))->where('division', 'MD')->whereNotIn('district', array("-"))->select('rhq', 'zone', 'chapter', 'district', 'agegroup', DB::Raw('SUM(dmjan) as "jan"'), DB::Raw('SUM(dmfeb) as "feb"'), DB::Raw('SUM(dmmar) as "mar"'), DB::Raw('SUM(dmapr) as "apr"'), DB::Raw('SUM(dmmay) as "may"'), DB::Raw('SUM(dmjun) as "jun"'), DB::Raw('SUM(dmjul) as "jul"'), DB::Raw('SUM(dmaug) as "aug"'), DB::Raw('SUM(dmsep) as "sep", SUM(dmoct) as "oct"'), DB::Raw('SUM(dmnov) as "nov"'), DB::Raw('SUM(dmdec) as "dec"'), DB::Raw('concat(chapter, " ", district) as description'))->groupby('rhq')->groupby('zone')->groupby('chapter')->groupby('district')->groupby('agegroup');
            } else if (Session::get('gakkaiuserpositionlevel') == 'district' ) {
                return $query->where('chapter', Session::get('gakkaiuserchapter'))->where('district', Session::get('gakkaiuserdistrict'))->where('division', 'MD')->whereNotIn('district', array("-"))->select('rhq', 'zone', 'chapter', 'district', 'agegroup', DB::Raw('SUM(dmjan) as "jan"'), DB::Raw('SUM(dmfeb) as "feb"'), DB::Raw('SUM(dmmar) as "mar"'), DB::Raw('SUM(dmapr) as "apr"'), DB::Raw('SUM(dmmay) as "may"'), DB::Raw('SUM(dmjun) as "jun"'), DB::Raw('SUM(dmjul) as "jul"'), DB::Raw('SUM(dmaug) as "aug"'), DB::Raw('SUM(dmsep) as "sep", SUM(dmoct) as "oct"'), DB::Raw('SUM(dmnov) as "nov"'), DB::Raw('SUM(dmdec) as "dec"'), DB::Raw('concat(chapter, " ", district) as description'))->groupby('rhq')->groupby('zone')->groupby('chapter')->groupby('district')->groupby('agegroup');
            }
        }
        elseif ( $divisiontype == 'WD')
        {
            if (Session::get('gakkaiuserpositionlevel') == 'shq' ) {
                return $query->where('division', 'WD')->whereNotIn('district', array("-"))->select('rhq', 'zone', 'chapter', 'district', 'agegroup', DB::Raw('SUM(dmjan) as "jan"'), DB::Raw('SUM(dmfeb) as "feb"'), DB::Raw('SUM(dmmar) as "mar"'), DB::Raw('SUM(dmapr) as "apr"'), DB::Raw('SUM(dmmay) as "may"'), DB::Raw('SUM(dmjun) as "jun"'), DB::Raw('SUM(dmjul) as "jul"'), DB::Raw('SUM(dmaug) as "aug"'), DB::Raw('SUM(dmsep) as "sep", SUM(dmoct) as "oct"'), DB::Raw('SUM(dmnov) as "nov"'), DB::Raw('SUM(dmdec) as "dec"'), DB::Raw('concat(chapter, " ", district) as description'))->groupby('rhq')->groupby('zone')->groupby('chapter')->groupby('district')->groupby('agegroup');
            } else if (Session::get('gakkaiuserpositionlevel') == 'rhq' ) {
                return $query->where('rhq', Session::get('gakkaiuserrhq'))->where('division', 'WD')->whereNotIn('district', array("-"))->select('rhq', 'zone', 'chapter', 'district', 'agegroup', DB::Raw('SUM(dmjan) as "jan"'), DB::Raw('SUM(dmfeb) as "feb"'), DB::Raw('SUM(dmmar) as "mar"'), DB::Raw('SUM(dmapr) as "apr"'), DB::Raw('SUM(dmmay) as "may"'), DB::Raw('SUM(dmjun) as "jun"'), DB::Raw('SUM(dmjul) as "jul"'), DB::Raw('SUM(dmaug) as "aug"'), DB::Raw('SUM(dmsep) as "sep", SUM(dmoct) as "oct"'), DB::Raw('SUM(dmnov) as "nov"'), DB::Raw('SUM(dmdec) as "dec"'), DB::Raw('concat(chapter, " ", district) as description'))->groupby('rhq')->groupby('zone')->groupby('chapter')->groupby('district')->groupby('agegroup');
            } else if (Session::get('gakkaiuserpositionlevel') == 'zone' ) {
                return $query->where('zone', Session::get('gakkaiuserzone'))->where('division', 'WD')->whereNotIn('district', array("-"))->select('rhq', 'zone', 'chapter', 'district', 'agegroup', DB::Raw('SUM(dmjan) as "jan"'), DB::Raw('SUM(dmfeb) as "feb"'), DB::Raw('SUM(dmmar) as "mar"'), DB::Raw('SUM(dmapr) as "apr"'), DB::Raw('SUM(dmmay) as "may"'), DB::Raw('SUM(dmjun) as "jun"'), DB::Raw('SUM(dmjul) as "jul"'), DB::Raw('SUM(dmaug) as "aug"'), DB::Raw('SUM(dmsep) as "sep", SUM(dmoct) as "oct"'), DB::Raw('SUM(dmnov) as "nov"'), DB::Raw('SUM(dmdec) as "dec"'), DB::Raw('concat(chapter, " ", district) as description'))->groupby('rhq')->groupby('zone')->groupby('chapter')->groupby('district')->groupby('agegroup');
            } else if (Session::get('gakkaiuserpositionlevel') == 'chapter' ) {
                return $query->where('chapter', Session::get('gakkaiuserchapter'))->where('division', 'WD')->whereNotIn('district', array("-"))->select('rhq', 'zone', 'chapter', 'district', 'agegroup', DB::Raw('SUM(dmjan) as "jan"'), DB::Raw('SUM(dmfeb) as "feb"'), DB::Raw('SUM(dmmar) as "mar"'), DB::Raw('SUM(dmapr) as "apr"'), DB::Raw('SUM(dmmay) as "may"'), DB::Raw('SUM(dmjun) as "jun"'), DB::Raw('SUM(dmjul) as "jul"'), DB::Raw('SUM(dmaug) as "aug"'), DB::Raw('SUM(dmsep) as "sep", SUM(dmoct) as "oct"'), DB::Raw('SUM(dmnov) as "nov"'), DB::Raw('SUM(dmdec) as "dec"'), DB::Raw('concat(chapter, " ", district) as description'))->groupby('rhq')->groupby('zone')->groupby('chapter')->groupby('district')->groupby('agegroup');
            } else if (Session::get('gakkaiuserpositionlevel') == 'district' ) {
                return $query->where('chapter', Session::get('gakkaiuserchapter'))->where('district', Session::get('gakkaiuserdistrict'))->where('division', 'WD')->whereNotIn('district', array("-"))->select('rhq', 'zone', 'chapter', 'district', 'agegroup', DB::Raw('SUM(dmjan) as "jan"'), DB::Raw('SUM(dmfeb) as "feb"'), DB::Raw('SUM(dmmar) as "mar"'), DB::Raw('SUM(dmapr) as "apr"'), DB::Raw('SUM(dmmay) as "may"'), DB::Raw('SUM(dmjun) as "jun"'), DB::Raw('SUM(dmjul) as "jul"'), DB::Raw('SUM(dmaug) as "aug"'), DB::Raw('SUM(dmsep) as "sep", SUM(dmoct) as "oct"'), DB::Raw('SUM(dmnov) as "nov"'), DB::Raw('SUM(dmdec) as "dec"'), DB::Raw('concat(chapter, " ", district) as description'))->groupby('rhq')->groupby('zone')->groupby('chapter')->groupby('district')->groupby('agegroup');
            }
        }
        elseif ( $divisiontype == 'YMD')
        {
            if (Session::get('gakkaiuserpositionlevel') == 'shq' ) {
                return $query->where('division', 'YM')->whereNotIn('district', array("-"))->select('rhq', 'zone', 'chapter', 'district', 'agegroup', DB::Raw('SUM(dmjan) as "jan"'), DB::Raw('SUM(dmfeb) as "feb"'), DB::Raw('SUM(dmmar) as "mar"'), DB::Raw('SUM(dmapr) as "apr"'), DB::Raw('SUM(dmmay) as "may"'), DB::Raw('SUM(dmjun) as "jun"'), DB::Raw('SUM(dmjul) as "jul"'), DB::Raw('SUM(dmaug) as "aug"'), DB::Raw('SUM(dmsep) as "sep", SUM(dmoct) as "oct"'), DB::Raw('SUM(dmnov) as "nov"'), DB::Raw('SUM(dmdec) as "dec"'), DB::Raw('concat(chapter, " ", district) as description'))->groupby('rhq')->groupby('zone')->groupby('chapter')->groupby('district')->groupby('agegroup');
            } else if (Session::get('gakkaiuserpositionlevel') == 'rhq' ) {
                return $query->where('rhq', Session::get('gakkaiuserrhq'))->where('division', 'YM')->whereNotIn('district', array("-"))->select('rhq', 'zone', 'chapter', 'district', 'agegroup', DB::Raw('SUM(dmjan) as "jan"'), DB::Raw('SUM(dmfeb) as "feb"'), DB::Raw('SUM(dmmar) as "mar"'), DB::Raw('SUM(dmapr) as "apr"'), DB::Raw('SUM(dmmay) as "may"'), DB::Raw('SUM(dmjun) as "jun"'), DB::Raw('SUM(dmjul) as "jul"'), DB::Raw('SUM(dmaug) as "aug"'), DB::Raw('SUM(dmsep) as "sep", SUM(dmoct) as "oct"'), DB::Raw('SUM(dmnov) as "nov"'), DB::Raw('SUM(dmdec) as "dec"'), DB::Raw('concat(chapter, " ", district) as description'))->groupby('rhq')->groupby('zone')->groupby('chapter')->groupby('district')->groupby('agegroup');
            } else if (Session::get('gakkaiuserpositionlevel') == 'zone' ) {
                return $query->where('zone', Session::get('gakkaiuserzone'))->where('division', 'YM')->whereNotIn('district', array("-"))->select('rhq', 'zone', 'chapter', 'district', 'agegroup', DB::Raw('SUM(dmjan) as "jan"'), DB::Raw('SUM(dmfeb) as "feb"'), DB::Raw('SUM(dmmar) as "mar"'), DB::Raw('SUM(dmapr) as "apr"'), DB::Raw('SUM(dmmay) as "may"'), DB::Raw('SUM(dmjun) as "jun"'), DB::Raw('SUM(dmjul) as "jul"'), DB::Raw('SUM(dmaug) as "aug"'), DB::Raw('SUM(dmsep) as "sep", SUM(dmoct) as "oct"'), DB::Raw('SUM(dmnov) as "nov"'), DB::Raw('SUM(dmdec) as "dec"'), DB::Raw('concat(chapter, " ", district) as description'))->groupby('rhq')->groupby('zone')->groupby('chapter')->groupby('district')->groupby('agegroup');
            } else if (Session::get('gakkaiuserpositionlevel') == 'chapter' ) {
                return $query->where('chapter', Session::get('gakkaiuserchapter'))->where('division', 'YM')->whereNotIn('district', array("-"))->select('rhq', 'zone', 'chapter', 'district', 'agegroup', DB::Raw('SUM(dmjan) as "jan"'), DB::Raw('SUM(dmfeb) as "feb"'), DB::Raw('SUM(dmmar) as "mar"'), DB::Raw('SUM(dmapr) as "apr"'), DB::Raw('SUM(dmmay) as "may"'), DB::Raw('SUM(dmjun) as "jun"'), DB::Raw('SUM(dmjul) as "jul"'), DB::Raw('SUM(dmaug) as "aug"'), DB::Raw('SUM(dmsep) as "sep", SUM(dmoct) as "oct"'), DB::Raw('SUM(dmnov) as "nov"'), DB::Raw('SUM(dmdec) as "dec"'), DB::Raw('concat(chapter, " ", district) as description'))->groupby('rhq')->groupby('zone')->groupby('chapter')->groupby('district')->groupby('agegroup');
            } else if (Session::get('gakkaiuserpositionlevel') == 'district' ) {
                return $query->where('chapter', Session::get('gakkaiuserchapter'))->where('district', Session::get('gakkaiuserdistrict'))->where('division', 'YM')->whereNotIn('district', array("-"))->select('rhq', 'zone', 'chapter', 'district', 'agegroup', DB::Raw('SUM(dmjan) as "jan"'), DB::Raw('SUM(dmfeb) as "feb"'), DB::Raw('SUM(dmmar) as "mar"'), DB::Raw('SUM(dmapr) as "apr"'), DB::Raw('SUM(dmmay) as "may"'), DB::Raw('SUM(dmjun) as "jun"'), DB::Raw('SUM(dmjul) as "jul"'), DB::Raw('SUM(dmaug) as "aug"'), DB::Raw('SUM(dmsep) as "sep", SUM(dmoct) as "oct"'), DB::Raw('SUM(dmnov) as "nov"'), DB::Raw('SUM(dmdec) as "dec"'), DB::Raw('concat(chapter, " ", district) as description'))->groupby('rhq')->groupby('zone')->groupby('chapter')->groupby('district')->groupby('agegroup');
            }
        }
        elseif ( $divisiontype == 'YWD')
        {
            if (Session::get('gakkaiuserpositionlevel') == 'shq' ) {
                return $query->where('division', 'YW')->whereNotIn('district', array("-"))->select('rhq', 'zone', 'chapter', 'district', 'agegroup', DB::Raw('SUM(dmjan) as "jan"'), DB::Raw('SUM(dmfeb) as "feb"'), DB::Raw('SUM(dmmar) as "mar"'), DB::Raw('SUM(dmapr) as "apr"'), DB::Raw('SUM(dmmay) as "may"'), DB::Raw('SUM(dmjun) as "jun"'), DB::Raw('SUM(dmjul) as "jul"'), DB::Raw('SUM(dmaug) as "aug"'), DB::Raw('SUM(dmsep) as "sep", SUM(dmoct) as "oct"'), DB::Raw('SUM(dmnov) as "nov"'), DB::Raw('SUM(dmdec) as "dec"'), DB::Raw('concat(chapter, " ", district) as description'))->groupby('rhq')->groupby('zone')->groupby('chapter')->groupby('district')->groupby('agegroup');
            } else if (Session::get('gakkaiuserpositionlevel') == 'rhq' ) {
                return $query->where('rhq', Session::get('gakkaiuserrhq'))->where('division', 'YW')->whereNotIn('district', array("-"))->select('rhq', 'zone', 'chapter', 'district', 'agegroup', DB::Raw('SUM(dmjan) as "jan"'), DB::Raw('SUM(dmfeb) as "feb"'), DB::Raw('SUM(dmmar) as "mar"'), DB::Raw('SUM(dmapr) as "apr"'), DB::Raw('SUM(dmmay) as "may"'), DB::Raw('SUM(dmjun) as "jun"'), DB::Raw('SUM(dmjul) as "jul"'), DB::Raw('SUM(dmaug) as "aug"'), DB::Raw('SUM(dmsep) as "sep", SUM(dmoct) as "oct"'), DB::Raw('SUM(dmnov) as "nov"'), DB::Raw('SUM(dmdec) as "dec"'), DB::Raw('concat(chapter, " ", district) as description'))->groupby('rhq')->groupby('zone')->groupby('chapter')->groupby('district')->groupby('agegroup');
            } else if (Session::get('gakkaiuserpositionlevel') == 'zone' ) {
                return $query->where('zone', Session::get('gakkaiuserzone'))->where('division', 'YW')->whereNotIn('district', array("-"))->select('rhq', 'zone', 'chapter', 'district', 'agegroup', DB::Raw('SUM(dmjan) as "jan"'), DB::Raw('SUM(dmfeb) as "feb"'), DB::Raw('SUM(dmmar) as "mar"'), DB::Raw('SUM(dmapr) as "apr"'), DB::Raw('SUM(dmmay) as "may"'), DB::Raw('SUM(dmjun) as "jun"'), DB::Raw('SUM(dmjul) as "jul"'), DB::Raw('SUM(dmaug) as "aug"'), DB::Raw('SUM(dmsep) as "sep", SUM(dmoct) as "oct"'), DB::Raw('SUM(dmnov) as "nov"'), DB::Raw('SUM(dmdec) as "dec"'), DB::Raw('concat(chapter, " ", district) as description'))->groupby('rhq')->groupby('zone')->groupby('chapter')->groupby('district')->groupby('agegroup');
            } else if (Session::get('gakkaiuserpositionlevel') == 'chapter' ) {
                return $query->where('chapter', Session::get('gakkaiuserchapter'))->where('division', 'YW')->whereNotIn('district', array("-"))->select('rhq', 'zone', 'chapter', 'district', 'agegroup', DB::Raw('SUM(dmjan) as "jan"'), DB::Raw('SUM(dmfeb) as "feb"'), DB::Raw('SUM(dmmar) as "mar"'), DB::Raw('SUM(dmapr) as "apr"'), DB::Raw('SUM(dmmay) as "may"'), DB::Raw('SUM(dmjun) as "jun"'), DB::Raw('SUM(dmjul) as "jul"'), DB::Raw('SUM(dmaug) as "aug"'), DB::Raw('SUM(dmsep) as "sep", SUM(dmoct) as "oct"'), DB::Raw('SUM(dmnov) as "nov"'), DB::Raw('SUM(dmdec) as "dec"'), DB::Raw('concat(chapter, " ", district) as description'))->groupby('rhq')->groupby('zone')->groupby('chapter')->groupby('district')->groupby('agegroup');
            } else if (Session::get('gakkaiuserpositionlevel') == 'district' ) {
                return $query->where('chapter', Session::get('gakkaiuserchapter'))->where('district', Session::get('gakkaiuserdistrict'))->where('division', 'YW')->whereNotIn('district', array("-"))->select('rhq', 'zone', 'chapter', 'district', 'agegroup', DB::Raw('SUM(dmjan) as "jan"'), DB::Raw('SUM(dmfeb) as "feb"'), DB::Raw('SUM(dmmar) as "mar"'), DB::Raw('SUM(dmapr) as "apr"'), DB::Raw('SUM(dmmay) as "may"'), DB::Raw('SUM(dmjun) as "jun"'), DB::Raw('SUM(dmjul) as "jul"'), DB::Raw('SUM(dmaug) as "aug"'), DB::Raw('SUM(dmsep) as "sep", SUM(dmoct) as "oct"'), DB::Raw('SUM(dmnov) as "nov"'), DB::Raw('SUM(dmdec) as "dec"'), DB::Raw('concat(chapter, " ", district) as description'))->groupby('rhq')->groupby('zone')->groupby('chapter')->groupby('district')->groupby('agegroup');
            }
        }
        elseif ( $divisiontype == 'Primary Division')
        {
            if (Session::get('gakkaiuserpositionlevel') == 'shq' ) {
                return $query->where('agegroup', '07 to 12')->whereNotIn('district', array("-"))->select('rhq', 'zone', 'chapter', 'district', 'agegroup', DB::Raw('SUM(dmjan) as "jan"'), DB::Raw('SUM(dmfeb) as "feb"'), DB::Raw('SUM(dmmar) as "mar"'), DB::Raw('SUM(dmapr) as "apr"'), DB::Raw('SUM(dmmay) as "may"'), DB::Raw('SUM(dmjun) as "jun"'), DB::Raw('SUM(dmjul) as "jul"'), DB::Raw('SUM(dmaug) as "aug"'), DB::Raw('SUM(dmsep) as "sep", SUM(dmoct) as "oct"'), DB::Raw('SUM(dmnov) as "nov"'), DB::Raw('SUM(dmdec) as "dec"'), DB::Raw('concat(chapter, " ", district) as description'))->groupby('rhq')->groupby('zone')->groupby('chapter')->groupby('district')->groupby('agegroup');
            } else if (Session::get('gakkaiuserpositionlevel') == 'rhq' ) {
                return $query->where('rhq', Session::get('gakkaiuserrhq'))->where('agegroup', '07 to 12')->whereNotIn('district', array("-"))->select('rhq', 'zone', 'chapter', 'district', 'agegroup', DB::Raw('SUM(dmjan) as "jan"'), DB::Raw('SUM(dmfeb) as "feb"'), DB::Raw('SUM(dmmar) as "mar"'), DB::Raw('SUM(dmapr) as "apr"'), DB::Raw('SUM(dmmay) as "may"'), DB::Raw('SUM(dmjun) as "jun"'), DB::Raw('SUM(dmjul) as "jul"'), DB::Raw('SUM(dmaug) as "aug"'), DB::Raw('SUM(dmsep) as "sep", SUM(dmoct) as "oct"'), DB::Raw('SUM(dmnov) as "nov"'), DB::Raw('SUM(dmdec) as "dec"'), DB::Raw('concat(chapter, " ", district) as description'))->groupby('rhq')->groupby('zone')->groupby('chapter')->groupby('district')->groupby('agegroup');
            } else if (Session::get('gakkaiuserpositionlevel') == 'zone' ) {
                return $query->where('zone', Session::get('gakkaiuserzone'))->where('agegroup', '07 to 12')->whereNotIn('district', array("-"))->select('rhq', 'zone', 'chapter', 'district', 'agegroup', DB::Raw('SUM(dmjan) as "jan"'), DB::Raw('SUM(dmfeb) as "feb"'), DB::Raw('SUM(dmmar) as "mar"'), DB::Raw('SUM(dmapr) as "apr"'), DB::Raw('SUM(dmmay) as "may"'), DB::Raw('SUM(dmjun) as "jun"'), DB::Raw('SUM(dmjul) as "jul"'), DB::Raw('SUM(dmaug) as "aug"'), DB::Raw('SUM(dmsep) as "sep", SUM(dmoct) as "oct"'), DB::Raw('SUM(dmnov) as "nov"'), DB::Raw('SUM(dmdec) as "dec"'), DB::Raw('concat(chapter, " ", district) as description'))->groupby('rhq')->groupby('zone')->groupby('chapter')->groupby('district')->groupby('agegroup');
            } else if (Session::get('gakkaiuserpositionlevel') == 'chapter' ) {
                return $query->where('chapter', Session::get('gakkaiuserchapter'))->where('agegroup', '07 to 12')->whereNotIn('district', array("-"))->select('rhq', 'zone', 'chapter', 'district', 'agegroup', DB::Raw('SUM(dmjan) as "jan"'), DB::Raw('SUM(dmfeb) as "feb"'), DB::Raw('SUM(dmmar) as "mar"'), DB::Raw('SUM(dmapr) as "apr"'), DB::Raw('SUM(dmmay) as "may"'), DB::Raw('SUM(dmjun) as "jun"'), DB::Raw('SUM(dmjul) as "jul"'), DB::Raw('SUM(dmaug) as "aug"'), DB::Raw('SUM(dmsep) as "sep", SUM(dmoct) as "oct"'), DB::Raw('SUM(dmnov) as "nov"'), DB::Raw('SUM(dmdec) as "dec"'), DB::Raw('concat(chapter, " ", district) as description'))->groupby('rhq')->groupby('zone')->groupby('chapter')->groupby('district')->groupby('agegroup');
            } else if (Session::get('gakkaiuserpositionlevel') == 'district' ) {
                return $query->where('chapter', Session::get('gakkaiuserchapter'))->where('district', Session::get('gakkaiuserdistrict'))->where('agegroup', '07 to 12')->whereNotIn('district', array("-"))->select('rhq', 'zone', 'chapter', 'district', 'agegroup', DB::Raw('SUM(dmjan) as "jan"'), DB::Raw('SUM(dmfeb) as "feb"'), DB::Raw('SUM(dmmar) as "mar"'), DB::Raw('SUM(dmapr) as "apr"'), DB::Raw('SUM(dmmay) as "may"'), DB::Raw('SUM(dmjun) as "jun"'), DB::Raw('SUM(dmjul) as "jul"'), DB::Raw('SUM(dmaug) as "aug"'), DB::Raw('SUM(dmsep) as "sep", SUM(dmoct) as "oct"'), DB::Raw('SUM(dmnov) as "nov"'), DB::Raw('SUM(dmdec) as "dec"'), DB::Raw('concat(chapter, " ", district) as description'))->groupby('rhq')->groupby('zone')->groupby('chapter')->groupby('district')->groupby('agegroup');
            }
        }
        elseif ( $divisiontype == 'Future Division')
        {
            if (Session::get('gakkaiuserpositionlevel') == 'shq' ) {
                return $query->where('agegroup', '13 to 16')->whereNotIn('district', array("-"))->select('rhq', 'zone', 'chapter', 'district', 'agegroup', DB::Raw('SUM(dmjan) as "jan"'), DB::Raw('SUM(dmfeb) as "feb"'), DB::Raw('SUM(dmmar) as "mar"'), DB::Raw('SUM(dmapr) as "apr"'), DB::Raw('SUM(dmmay) as "may"'), DB::Raw('SUM(dmjun) as "jun"'), DB::Raw('SUM(dmjul) as "jul"'), DB::Raw('SUM(dmaug) as "aug"'), DB::Raw('SUM(dmsep) as "sep", SUM(dmoct) as "oct"'), DB::Raw('SUM(dmnov) as "nov"'), DB::Raw('SUM(dmdec) as "dec"'), DB::Raw('concat(chapter, " ", district) as description'))->groupby('rhq')->groupby('zone')->groupby('chapter')->groupby('district')->groupby('agegroup');
            } else if (Session::get('gakkaiuserpositionlevel') == 'rhq' ) {
                return $query->where('rhq', Session::get('gakkaiuserrhq'))->where('agegroup', '13 to 16')->whereNotIn('district', array("-"))->select('rhq', 'zone', 'chapter', 'district', 'agegroup', DB::Raw('SUM(dmjan) as "jan"'), DB::Raw('SUM(dmfeb) as "feb"'), DB::Raw('SUM(dmmar) as "mar"'), DB::Raw('SUM(dmapr) as "apr"'), DB::Raw('SUM(dmmay) as "may"'), DB::Raw('SUM(dmjun) as "jun"'), DB::Raw('SUM(dmjul) as "jul"'), DB::Raw('SUM(dmaug) as "aug"'), DB::Raw('SUM(dmsep) as "sep", SUM(dmoct) as "oct"'), DB::Raw('SUM(dmnov) as "nov"'), DB::Raw('SUM(dmdec) as "dec"'), DB::Raw('concat(chapter, " ", district) as description'))->groupby('rhq')->groupby('zone')->groupby('chapter')->groupby('district')->groupby('agegroup');
            } else if (Session::get('gakkaiuserpositionlevel') == 'zone' ) {
                return $query->where('zone', Session::get('gakkaiuserzone'))->where('agegroup', '13 to 16')->whereNotIn('district', array("-"))->select('rhq', 'zone', 'chapter', 'district', 'agegroup', DB::Raw('SUM(dmjan) as "jan"'), DB::Raw('SUM(dmfeb) as "feb"'), DB::Raw('SUM(dmmar) as "mar"'), DB::Raw('SUM(dmapr) as "apr"'), DB::Raw('SUM(dmmay) as "may"'), DB::Raw('SUM(dmjun) as "jun"'), DB::Raw('SUM(dmjul) as "jul"'), DB::Raw('SUM(dmaug) as "aug"'), DB::Raw('SUM(dmsep) as "sep", SUM(dmoct) as "oct"'), DB::Raw('SUM(dmnov) as "nov"'), DB::Raw('SUM(dmdec) as "dec"'), DB::Raw('concat(chapter, " ", district) as description'))->groupby('rhq')->groupby('zone')->groupby('chapter')->groupby('district')->groupby('agegroup');
            } else if (Session::get('gakkaiuserpositionlevel') == 'chapter' ) {
                return $query->where('chapter', Session::get('gakkaiuserchapter'))->where('agegroup', '13 to 16')->whereNotIn('district', array("-"))->select('rhq', 'zone', 'chapter', 'district', 'agegroup', DB::Raw('SUM(dmjan) as "jan"'), DB::Raw('SUM(dmfeb) as "feb"'), DB::Raw('SUM(dmmar) as "mar"'), DB::Raw('SUM(dmapr) as "apr"'), DB::Raw('SUM(dmmay) as "may"'), DB::Raw('SUM(dmjun) as "jun"'), DB::Raw('SUM(dmjul) as "jul"'), DB::Raw('SUM(dmaug) as "aug"'), DB::Raw('SUM(dmsep) as "sep", SUM(dmoct) as "oct"'), DB::Raw('SUM(dmnov) as "nov"'), DB::Raw('SUM(dmdec) as "dec"'), DB::Raw('concat(chapter, " ", district) as description'))->groupby('rhq')->groupby('zone')->groupby('chapter')->groupby('district')->groupby('agegroup');
            } else if (Session::get('gakkaiuserpositionlevel') == 'district' ) {
                return $query->where('chapter', Session::get('gakkaiuserchapter'))->where('district', Session::get('gakkaiuserdistrict'))->where('agegroup', '13 to 16')->whereNotIn('district', array("-"))->select('rhq', 'zone', 'chapter', 'district', 'agegroup', DB::Raw('SUM(dmjan) as "jan"'), DB::Raw('SUM(dmfeb) as "feb"'), DB::Raw('SUM(dmmar) as "mar"'), DB::Raw('SUM(dmapr) as "apr"'), DB::Raw('SUM(dmmay) as "may"'), DB::Raw('SUM(dmjun) as "jun"'), DB::Raw('SUM(dmjul) as "jul"'), DB::Raw('SUM(dmaug) as "aug"'), DB::Raw('SUM(dmsep) as "sep", SUM(dmoct) as "oct"'), DB::Raw('SUM(dmnov) as "nov"'), DB::Raw('SUM(dmdec) as "dec"'), DB::Raw('concat(chapter, " ", district) as description'))->groupby('rhq')->groupby('zone')->groupby('chapter')->groupby('district')->groupby('agegroup');
            }
        }
        elseif ( $divisiontype == 'Student Division')
        {
            if (Session::get('gakkaiuserpositionlevel') == 'shq' ) {
                return $query->whereNotIn('district', array("-"))->select('rhq', 'zone', 'chapter', 'district', 'agegroup', DB::Raw('SUM(dmjan) as "jan"'), DB::Raw('SUM(dmfeb) as "feb"'), DB::Raw('SUM(dmmar) as "mar"'), DB::Raw('SUM(dmapr) as "apr"'), DB::Raw('SUM(dmmay) as "may"'), DB::Raw('SUM(dmjun) as "jun"'), DB::Raw('SUM(dmjul) as "jul"'), DB::Raw('SUM(dmaug) as "aug"'), DB::Raw('SUM(dmsep) as "sep", SUM(dmoct) as "oct"'), DB::Raw('SUM(dmnov) as "nov"'), DB::Raw('SUM(dmdec) as "dec"'), DB::Raw('concat(chapter, " ", district) as description'))->groupby('rhq')->groupby('zone')->groupby('chapter')->groupby('district')->groupby('agegroup');
            } else if (Session::get('gakkaiuserpositionlevel') == 'rhq' ) {
                return $query->where('rhq', Session::get('gakkaiuserrhq'))->where('studentdivision', '!=', '')->whereNotIn('district', array("-"))->select('rhq', 'zone', 'chapter', 'district', 'agegroup', DB::Raw('SUM(dmjan) as "jan"'), DB::Raw('SUM(dmfeb) as "feb"'), DB::Raw('SUM(dmmar) as "mar"'), DB::Raw('SUM(dmapr) as "apr"'), DB::Raw('SUM(dmmay) as "may"'), DB::Raw('SUM(dmjun) as "jun"'), DB::Raw('SUM(dmjul) as "jul"'), DB::Raw('SUM(dmaug) as "aug"'), DB::Raw('SUM(dmsep) as "sep", SUM(dmoct) as "oct"'), DB::Raw('SUM(dmnov) as "nov"'), DB::Raw('SUM(dmdec) as "dec"'), DB::Raw('concat(chapter, " ", district) as description'))->groupby('rhq')->groupby('zone')->groupby('chapter')->groupby('district')->groupby('agegroup');
            } else if (Session::get('gakkaiuserpositionlevel') == 'zone' ) {
                return $query->where('zone', Session::get('gakkaiuserzone'))->where('studentdivision', '!=', '')->whereNotIn('district', array("-"))->select('rhq', 'zone', 'chapter', 'district', 'agegroup', DB::Raw('SUM(dmjan) as "jan"'), DB::Raw('SUM(dmfeb) as "feb"'), DB::Raw('SUM(dmmar) as "mar"'), DB::Raw('SUM(dmapr) as "apr"'), DB::Raw('SUM(dmmay) as "may"'), DB::Raw('SUM(dmjun) as "jun"'), DB::Raw('SUM(dmjul) as "jul"'), DB::Raw('SUM(dmaug) as "aug"'), DB::Raw('SUM(dmsep) as "sep", SUM(dmoct) as "oct"'), DB::Raw('SUM(dmnov) as "nov"'), DB::Raw('SUM(dmdec) as "dec"'), DB::Raw('concat(chapter, " ", district) as description'))->groupby('rhq')->groupby('zone')->groupby('chapter')->groupby('district')->groupby('agegroup');
            } else if (Session::get('gakkaiuserpositionlevel') == 'chapter' ) {
                return $query->where('chapter', Session::get('gakkaiuserchapter'))->where('studentdivision', '!=', '')->whereNotIn('district', array("-"))->select('rhq', 'zone', 'chapter', 'district', 'agegroup', DB::Raw('SUM(dmjan) as "jan"'), DB::Raw('SUM(dmfeb) as "feb"'), DB::Raw('SUM(dmmar) as "mar"'), DB::Raw('SUM(dmapr) as "apr"'), DB::Raw('SUM(dmmay) as "may"'), DB::Raw('SUM(dmjun) as "jun"'), DB::Raw('SUM(dmjul) as "jul"'), DB::Raw('SUM(dmaug) as "aug"'), DB::Raw('SUM(dmsep) as "sep", SUM(dmoct) as "oct"'), DB::Raw('SUM(dmnov) as "nov"'), DB::Raw('SUM(dmdec) as "dec"'), DB::Raw('concat(chapter, " ", district) as description'))->groupby('rhq')->groupby('zone')->groupby('chapter')->groupby('district')->groupby('agegroup');
            } else if (Session::get('gakkaiuserpositionlevel') == 'district' ) {
                return $query->where('chapter', Session::get('gakkaiuserchapter'))->where('district', Session::get('gakkaiuserdistrict'))->where('studentdivision', '!=', '')->whereNotIn('district', array("-"))->select('rhq', 'zone', 'chapter', 'district', 'agegroup', DB::Raw('SUM(dmjan) as "jan"'), DB::Raw('SUM(dmfeb) as "feb"'), DB::Raw('SUM(dmmar) as "mar"'), DB::Raw('SUM(dmapr) as "apr"'), DB::Raw('SUM(dmmay) as "may"'), DB::Raw('SUM(dmjun) as "jun"'), DB::Raw('SUM(dmjul) as "jul"'), DB::Raw('SUM(dmaug) as "aug"'), DB::Raw('SUM(dmsep) as "sep", SUM(dmoct) as "oct"'), DB::Raw('SUM(dmnov) as "nov"'), DB::Raw('SUM(dmdec) as "dec"'), DB::Raw('concat(chapter, " ", district) as description'))->groupby('rhq')->groupby('zone')->groupby('chapter')->groupby('district')->groupby('agegroup');
            }
        }
        elseif ( $divisiontype == 'Adult Division')
        {
            if (Session::get('gakkaiuserpositionlevel') == 'shq' ) {
                return $query->whereIn('division', array('MD', 'WD'))->whereNotIn('district', array("-"))->select('rhq', 'zone', 'chapter', 'district', 'agegroup', DB::Raw('SUM(dmjan) as "jan"'), DB::Raw('SUM(dmfeb) as "feb"'), DB::Raw('SUM(dmmar) as "mar"'), DB::Raw('SUM(dmapr) as "apr"'), DB::Raw('SUM(dmmay) as "may"'), DB::Raw('SUM(dmjun) as "jun"'), DB::Raw('SUM(dmjul) as "jul"'), DB::Raw('SUM(dmaug) as "aug"'), DB::Raw('SUM(dmsep) as "sep", SUM(dmoct) as "oct"'), DB::Raw('SUM(dmnov) as "nov"'), DB::Raw('SUM(dmdec) as "dec"'), DB::Raw('concat(chapter, " ", district) as description'))->groupby('rhq')->groupby('zone')->groupby('chapter')->groupby('district')->groupby('agegroup');
            } else if (Session::get('gakkaiuserpositionlevel') == 'rhq' ) {
                return $query->where('rhq', Session::get('gakkaiuserrhq'))->whereIn('division', array('MD', 'WD'))->whereNotIn('district', array("-"))->select('rhq', 'zone', 'chapter', 'district', 'agegroup', DB::Raw('SUM(dmjan) as "jan"'), DB::Raw('SUM(dmfeb) as "feb"'), DB::Raw('SUM(dmmar) as "mar"'), DB::Raw('SUM(dmapr) as "apr"'), DB::Raw('SUM(dmmay) as "may"'), DB::Raw('SUM(dmjun) as "jun"'), DB::Raw('SUM(dmjul) as "jul"'), DB::Raw('SUM(dmaug) as "aug"'), DB::Raw('SUM(dmsep) as "sep", SUM(dmoct) as "oct"'), DB::Raw('SUM(dmnov) as "nov"'), DB::Raw('SUM(dmdec) as "dec"'), DB::Raw('concat(chapter, " ", district) as description'))->groupby('rhq')->groupby('zone')->groupby('chapter')->groupby('district')->groupby('agegroup');
            } else if (Session::get('gakkaiuserpositionlevel') == 'zone' ) {
                return $query->where('zone', Session::get('gakkaiuserzone'))->whereIn('division', array('MD', 'WD'))->whereNotIn('district', array("-"))->select('rhq', 'zone', 'chapter', 'district', 'agegroup', DB::Raw('SUM(dmjan) as "jan"'), DB::Raw('SUM(dmfeb) as "feb"'), DB::Raw('SUM(dmmar) as "mar"'), DB::Raw('SUM(dmapr) as "apr"'), DB::Raw('SUM(dmmay) as "may"'), DB::Raw('SUM(dmjun) as "jun"'), DB::Raw('SUM(dmjul) as "jul"'), DB::Raw('SUM(dmaug) as "aug"'), DB::Raw('SUM(dmsep) as "sep", SUM(dmoct) as "oct"'), DB::Raw('SUM(dmnov) as "nov"'), DB::Raw('SUM(dmdec) as "dec"'), DB::Raw('concat(chapter, " ", district) as description'))->groupby('rhq')->groupby('zone')->groupby('chapter')->groupby('district')->groupby('agegroup');
            } else if (Session::get('gakkaiuserpositionlevel') == 'chapter' ) {
                return $query->where('chapter', Session::get('gakkaiuserchapter'))->whereIn('division', array('MD', 'WD'))->whereNotIn('district', array("-"))->select('rhq', 'zone', 'chapter', 'district', 'agegroup', DB::Raw('SUM(dmjan) as "jan"'), DB::Raw('SUM(dmfeb) as "feb"'), DB::Raw('SUM(dmmar) as "mar"'), DB::Raw('SUM(dmapr) as "apr"'), DB::Raw('SUM(dmmay) as "may"'), DB::Raw('SUM(dmjun) as "jun"'), DB::Raw('SUM(dmjul) as "jul"'), DB::Raw('SUM(dmaug) as "aug"'), DB::Raw('SUM(dmsep) as "sep", SUM(dmoct) as "oct"'), DB::Raw('SUM(dmnov) as "nov"'), DB::Raw('SUM(dmdec) as "dec"'), DB::Raw('concat(chapter, " ", district) as description'))->groupby('rhq')->groupby('zone')->groupby('chapter')->groupby('district')->groupby('agegroup');
            } else if (Session::get('gakkaiuserpositionlevel') == 'district' ) {
                return $query->where('chapter', Session::get('gakkaiuserchapter'))->where('district', Session::get('gakkaiuserdistrict'))->whereIn('division', array('MD', 'WD'))->whereNotIn('district', array("-"))->select('rhq', 'zone', 'chapter', 'district', 'agegroup', DB::Raw('SUM(dmjan) as "jan"'), DB::Raw('SUM(dmfeb) as "feb"'), DB::Raw('SUM(dmmar) as "mar"'), DB::Raw('SUM(dmapr) as "apr"'), DB::Raw('SUM(dmmay) as "may"'), DB::Raw('SUM(dmjun) as "jun"'), DB::Raw('SUM(dmjul) as "jul"'), DB::Raw('SUM(dmaug) as "aug"'), DB::Raw('SUM(dmsep) as "sep", SUM(dmoct) as "oct"'), DB::Raw('SUM(dmnov) as "nov"'), DB::Raw('SUM(dmdec) as "dec"'), DB::Raw('concat(chapter, " ", district) as description'))->groupby('rhq')->groupby('zone')->groupby('chapter')->groupby('district')->groupby('agegroup');
            }
        }
        elseif ( $divisiontype == 'Youth Division')
        {
            if (Session::get('gakkaiuserpositionlevel') == 'shq' ) {
                return $query->whereIn('division', array('YM', 'YW'))->whereNotIn('district', array("-"))->select('rhq', 'zone', 'chapter', 'district', 'agegroup', DB::Raw('SUM(dmjan) as "jan"'), DB::Raw('SUM(dmfeb) as "feb"'), DB::Raw('SUM(dmmar) as "mar"'), DB::Raw('SUM(dmapr) as "apr"'), DB::Raw('SUM(dmmay) as "may"'), DB::Raw('SUM(dmjun) as "jun"'), DB::Raw('SUM(dmjul) as "jul"'), DB::Raw('SUM(dmaug) as "aug"'), DB::Raw('SUM(dmsep) as "sep", SUM(dmoct) as "oct"'), DB::Raw('SUM(dmnov) as "nov"'), DB::Raw('SUM(dmdec) as "dec"'), DB::Raw('concat(chapter, " ", district) as description'))->groupby('rhq')->groupby('zone')->groupby('chapter')->groupby('district')->groupby('agegroup');
            } else if (Session::get('gakkaiuserpositionlevel') == 'rhq' ) {
                return $query->where('rhq', Session::get('gakkaiuserrhq'))->whereIn('division', array('YM', 'YW'))->whereNotIn('district', array("-"))->select('rhq', 'zone', 'chapter', 'district', 'agegroup', DB::Raw('SUM(dmjan) as "jan"'), DB::Raw('SUM(dmfeb) as "feb"'), DB::Raw('SUM(dmmar) as "mar"'), DB::Raw('SUM(dmapr) as "apr"'), DB::Raw('SUM(dmmay) as "may"'), DB::Raw('SUM(dmjun) as "jun"'), DB::Raw('SUM(dmjul) as "jul"'), DB::Raw('SUM(dmaug) as "aug"'), DB::Raw('SUM(dmsep) as "sep", SUM(dmoct) as "oct"'), DB::Raw('SUM(dmnov) as "nov"'), DB::Raw('SUM(dmdec) as "dec"'), DB::Raw('concat(chapter, " ", district) as description'))->groupby('rhq')->groupby('zone')->groupby('chapter')->groupby('district')->groupby('agegroup');
            } else if (Session::get('gakkaiuserpositionlevel') == 'zone' ) {
                return $query->where('zone', Session::get('gakkaiuserzone'))->whereIn('division', array('YM', 'YW'))->whereNotIn('district', array("-"))->select('rhq', 'zone', 'chapter', 'district', 'agegroup', DB::Raw('SUM(dmjan) as "jan"'), DB::Raw('SUM(dmfeb) as "feb"'), DB::Raw('SUM(dmmar) as "mar"'), DB::Raw('SUM(dmapr) as "apr"'), DB::Raw('SUM(dmmay) as "may"'), DB::Raw('SUM(dmjun) as "jun"'), DB::Raw('SUM(dmjul) as "jul"'), DB::Raw('SUM(dmaug) as "aug"'), DB::Raw('SUM(dmsep) as "sep", SUM(dmoct) as "oct"'), DB::Raw('SUM(dmnov) as "nov"'), DB::Raw('SUM(dmdec) as "dec"'), DB::Raw('concat(chapter, " ", district) as description'))->groupby('rhq')->groupby('zone')->groupby('chapter')->groupby('district')->groupby('agegroup');
            } else if (Session::get('gakkaiuserpositionlevel') == 'chapter' ) {
                return $query->where('chapter', Session::get('gakkaiuserchapter'))->whereIn('division', array('YM', 'YW'))->whereNotIn('district', array("-"))->select('rhq', 'zone', 'chapter', 'district', 'agegroup', DB::Raw('SUM(dmjan) as "jan"'), DB::Raw('SUM(dmfeb) as "feb"'), DB::Raw('SUM(dmmar) as "mar"'), DB::Raw('SUM(dmapr) as "apr"'), DB::Raw('SUM(dmmay) as "may"'), DB::Raw('SUM(dmjun) as "jun"'), DB::Raw('SUM(dmjul) as "jul"'), DB::Raw('SUM(dmaug) as "aug"'), DB::Raw('SUM(dmsep) as "sep", SUM(dmoct) as "oct"'), DB::Raw('SUM(dmnov) as "nov"'), DB::Raw('SUM(dmdec) as "dec"'), DB::Raw('concat(chapter, " ", district) as description'))->groupby('rhq')->groupby('zone')->groupby('chapter')->groupby('district')->groupby('agegroup');
            } else if (Session::get('gakkaiuserpositionlevel') == 'district' ) {
                return $query->where('chapter', Session::get('gakkaiuserchapter'))->where('district', Session::get('gakkaiuserdistrict'))->whereIn('division', array('YM', 'YW'))->whereNotIn('district', array("-"))->select('rhq', 'zone', 'chapter', 'district', 'agegroup', DB::Raw('SUM(dmjan) as "jan"'), DB::Raw('SUM(dmfeb) as "feb"'), DB::Raw('SUM(dmmar) as "mar"'), DB::Raw('SUM(dmapr) as "apr"'), DB::Raw('SUM(dmmay) as "may"'), DB::Raw('SUM(dmjun) as "jun"'), DB::Raw('SUM(dmjul) as "jul"'), DB::Raw('SUM(dmaug) as "aug"'), DB::Raw('SUM(dmsep) as "sep", SUM(dmoct) as "oct"'), DB::Raw('SUM(dmnov) as "nov"'), DB::Raw('SUM(dmdec) as "dec"'), DB::Raw('concat(chapter, " ", district) as description'))->groupby('rhq')->groupby('zone')->groupby('chapter')->groupby('district')->groupby('agegroup');
            }
        }
    }

    public function scopeLPRHQStats($query, $value, $divisiontype)
    {
        if ( $divisiontype == 'All' or $divisiontype == "4 Division")
        {
            if (Session::get('gakkaiuserpositionlevel') == 'shq' ) {
                return $query->whereNotIn('district', array("-"))->select('rhq', 'zone', 'chapter', 'district', DB::Raw('SUM(dmjan) as "jan"'), DB::Raw('SUM(dmfeb) as "feb"'), DB::Raw('SUM(dmmar) as "mar"'), DB::Raw('SUM(dmapr) as "apr"'), DB::Raw('SUM(dmmay) as "may"'), DB::Raw('SUM(dmjun) as "jun"'), DB::Raw('SUM(dmjul) as "jul"'), DB::Raw('SUM(dmaug) as "aug"'), DB::Raw('SUM(dmsep) as "sep", SUM(dmoct) as "oct"'), DB::Raw('SUM(dmnov) as "nov"'), DB::Raw('SUM(dmdec) as "dec"'), DB::Raw('concat(chapter, " ", district) as description'))->groupby('rhq')->groupby('zone')->groupby('chapter')->groupby('district');
            } else if (Session::get('gakkaiuserpositionlevel') == 'rhq' ) {
                return $query->where('rhq', Session::get('gakkaiuserrhq'))->whereNotIn('district', array("-"))->select('rhq', 'zone', 'chapter', 'district', DB::Raw('SUM(dmjan) as "jan"'), DB::Raw('SUM(dmfeb) as "feb"'), DB::Raw('SUM(dmmar) as "mar"'), DB::Raw('SUM(dmapr) as "apr"'), DB::Raw('SUM(dmmay) as "may"'), DB::Raw('SUM(dmjun) as "jun"'), DB::Raw('SUM(dmjul) as "jul"'), DB::Raw('SUM(dmaug) as "aug"'), DB::Raw('SUM(dmsep) as "sep", SUM(dmoct) as "oct"'), DB::Raw('SUM(dmnov) as "nov"'), DB::Raw('SUM(dmdec) as "dec"'), DB::Raw('concat(chapter, " ", district) as description'))->groupby('rhq')->groupby('zone')->groupby('chapter')->groupby('district');
            } else if (Session::get('gakkaiuserpositionlevel') == 'zone' ) {
                return $query->where('zone', Session::get('gakkaiuserzone'))->whereNotIn('district', array("-"))->select('rhq', 'zone', 'chapter', 'district', DB::Raw('SUM(dmjan) as "jan"'), DB::Raw('SUM(dmfeb) as "feb"'), DB::Raw('SUM(dmmar) as "mar"'), DB::Raw('SUM(dmapr) as "apr"'), DB::Raw('SUM(dmmay) as "may"'), DB::Raw('SUM(dmjun) as "jun"'), DB::Raw('SUM(dmjul) as "jul"'), DB::Raw('SUM(dmaug) as "aug"'), DB::Raw('SUM(dmsep) as "sep", SUM(dmoct) as "oct"'), DB::Raw('SUM(dmnov) as "nov"'), DB::Raw('SUM(dmdec) as "dec"'), DB::Raw('concat(chapter, " ", district) as description'))->groupby('rhq')->groupby('zone')->groupby('chapter')->groupby('district');
            } else if (Session::get('gakkaiuserpositionlevel') == 'chapter' ) {
                return $query->where('chapter', Session::get('gakkaiuserchapter'))->whereNotIn('district', array("-"))->select('rhq', 'zone', 'chapter', 'district', DB::Raw('SUM(dmjan) as "jan"'), DB::Raw('SUM(dmfeb) as "feb"'), DB::Raw('SUM(dmmar) as "mar"'), DB::Raw('SUM(dmapr) as "apr"'), DB::Raw('SUM(dmmay) as "may"'), DB::Raw('SUM(dmjun) as "jun"'), DB::Raw('SUM(dmjul) as "jul"'), DB::Raw('SUM(dmaug) as "aug"'), DB::Raw('SUM(dmsep) as "sep", SUM(dmoct) as "oct"'), DB::Raw('SUM(dmnov) as "nov"'), DB::Raw('SUM(dmdec) as "dec"'), DB::Raw('concat(chapter, " ", district) as description'))->groupby('rhq')->groupby('zone')->groupby('chapter')->groupby('district');
            } else if (Session::get('gakkaiuserpositionlevel') == 'district' ) {
                return $query->where('chapter', Session::get('gakkaiuserchapter'))->where('district', Session::get('gakkaiuserdistrict'))->whereNotIn('district', array("-"))->select('rhq', 'zone', 'chapter', 'district', DB::Raw('SUM(dmjan) as "jan"'), DB::Raw('SUM(dmfeb) as "feb"'), DB::Raw('SUM(dmmar) as "mar"'), DB::Raw('SUM(dmapr) as "apr"'), DB::Raw('SUM(dmmay) as "may"'), DB::Raw('SUM(dmjun) as "jun"'), DB::Raw('SUM(dmjul) as "jul"'), DB::Raw('SUM(dmaug) as "aug"'), DB::Raw('SUM(dmsep) as "sep", SUM(dmoct) as "oct"'), DB::Raw('SUM(dmnov) as "nov"'), DB::Raw('SUM(dmdec) as "dec"'), DB::Raw('concat(chapter, " ", district) as description'))->groupby('rhq')->groupby('zone')->groupby('chapter')->groupby('district');
            }
        }
        elseif ( $divisiontype == 'MD')
        {
            if (Session::get('gakkaiuserpositionlevel') == 'shq' ) {
                return $query->where('division', 'MD')->whereNotIn('district', array("-"))->select('rhq', 'zone', 'chapter', 'district', DB::Raw('SUM(dmjan) as "jan"'), DB::Raw('SUM(dmfeb) as "feb"'), DB::Raw('SUM(dmmar) as "mar"'), DB::Raw('SUM(dmapr) as "apr"'), DB::Raw('SUM(dmmay) as "may"'), DB::Raw('SUM(dmjun) as "jun"'), DB::Raw('SUM(dmjul) as "jul"'), DB::Raw('SUM(dmaug) as "aug"'), DB::Raw('SUM(dmsep) as "sep", SUM(dmoct) as "oct"'), DB::Raw('SUM(dmnov) as "nov"'), DB::Raw('SUM(dmdec) as "dec"'), DB::Raw('concat(chapter, " ", district) as description'))->groupby('rhq')->groupby('zone')->groupby('chapter')->groupby('district');
            } else if (Session::get('gakkaiuserpositionlevel') == 'rhq' ) {
                return $query->where('rhq', Session::get('gakkaiuserrhq'))->where('division', 'MD')->whereNotIn('district', array("-"))->select('rhq', 'zone', 'chapter', 'district', DB::Raw('SUM(dmjan) as "jan"'), DB::Raw('SUM(dmfeb) as "feb"'), DB::Raw('SUM(dmmar) as "mar"'), DB::Raw('SUM(dmapr) as "apr"'), DB::Raw('SUM(dmmay) as "may"'), DB::Raw('SUM(dmjun) as "jun"'), DB::Raw('SUM(dmjul) as "jul"'), DB::Raw('SUM(dmaug) as "aug"'), DB::Raw('SUM(dmsep) as "sep", SUM(dmoct) as "oct"'), DB::Raw('SUM(dmnov) as "nov"'), DB::Raw('SUM(dmdec) as "dec"'), DB::Raw('concat(chapter, " ", district) as description'))->groupby('rhq')->groupby('zone')->groupby('chapter')->groupby('district');
            } else if (Session::get('gakkaiuserpositionlevel') == 'zone' ) {
                return $query->where('zone', Session::get('gakkaiuserzone'))->where('division', 'MD')->whereNotIn('district', array("-"))->select('rhq', 'zone', 'chapter', 'district', DB::Raw('SUM(dmjan) as "jan"'), DB::Raw('SUM(dmfeb) as "feb"'), DB::Raw('SUM(dmmar) as "mar"'), DB::Raw('SUM(dmapr) as "apr"'), DB::Raw('SUM(dmmay) as "may"'), DB::Raw('SUM(dmjun) as "jun"'), DB::Raw('SUM(dmjul) as "jul"'), DB::Raw('SUM(dmaug) as "aug"'), DB::Raw('SUM(dmsep) as "sep", SUM(dmoct) as "oct"'), DB::Raw('SUM(dmnov) as "nov"'), DB::Raw('SUM(dmdec) as "dec"'), DB::Raw('concat(chapter, " ", district) as description'))->groupby('rhq')->groupby('zone')->groupby('chapter')->groupby('district');
            } else if (Session::get('gakkaiuserpositionlevel') == 'chapter' ) {
                return $query->where('chapter', Session::get('gakkaiuserchapter'))->where('division', 'MD')->whereNotIn('district', array("-"))->select('rhq', 'zone', 'chapter', 'district', DB::Raw('SUM(dmjan) as "jan"'), DB::Raw('SUM(dmfeb) as "feb"'), DB::Raw('SUM(dmmar) as "mar"'), DB::Raw('SUM(dmapr) as "apr"'), DB::Raw('SUM(dmmay) as "may"'), DB::Raw('SUM(dmjun) as "jun"'), DB::Raw('SUM(dmjul) as "jul"'), DB::Raw('SUM(dmaug) as "aug"'), DB::Raw('SUM(dmsep) as "sep", SUM(dmoct) as "oct"'), DB::Raw('SUM(dmnov) as "nov"'), DB::Raw('SUM(dmdec) as "dec"'), DB::Raw('concat(chapter, " ", district) as description'))->groupby('rhq')->groupby('zone')->groupby('chapter')->groupby('district');
            } else if (Session::get('gakkaiuserpositionlevel') == 'district' ) {
                return $query->where('chapter', Session::get('gakkaiuserchapter'))->where('district', Session::get('gakkaiuserdistrict'))->where('division', 'MD')->whereNotIn('district', array("-"))->select('rhq', 'zone', 'chapter', 'district', DB::Raw('SUM(dmjan) as "jan"'), DB::Raw('SUM(dmfeb) as "feb"'), DB::Raw('SUM(dmmar) as "mar"'), DB::Raw('SUM(dmapr) as "apr"'), DB::Raw('SUM(dmmay) as "may"'), DB::Raw('SUM(dmjun) as "jun"'), DB::Raw('SUM(dmjul) as "jul"'), DB::Raw('SUM(dmaug) as "aug"'), DB::Raw('SUM(dmsep) as "sep", SUM(dmoct) as "oct"'), DB::Raw('SUM(dmnov) as "nov"'), DB::Raw('SUM(dmdec) as "dec"'), DB::Raw('concat(chapter, " ", district) as description'))->groupby('rhq')->groupby('zone')->groupby('chapter')->groupby('district');
            }
        }
        elseif ( $divisiontype == 'WD')
        {
            if (Session::get('gakkaiuserpositionlevel') == 'shq' ) {
                return $query->where('division', 'WD')->whereNotIn('district', array("-"))->select('rhq', 'zone', 'chapter', 'district', DB::Raw('SUM(dmjan) as "jan"'), DB::Raw('SUM(dmfeb) as "feb"'), DB::Raw('SUM(dmmar) as "mar"'), DB::Raw('SUM(dmapr) as "apr"'), DB::Raw('SUM(dmmay) as "may"'), DB::Raw('SUM(dmjun) as "jun"'), DB::Raw('SUM(dmjul) as "jul"'), DB::Raw('SUM(dmaug) as "aug"'), DB::Raw('SUM(dmsep) as "sep", SUM(dmoct) as "oct"'), DB::Raw('SUM(dmnov) as "nov"'), DB::Raw('SUM(dmdec) as "dec"'), DB::Raw('concat(chapter, " ", district) as description'))->groupby('rhq')->groupby('zone')->groupby('chapter')->groupby('district');
            } else if (Session::get('gakkaiuserpositionlevel') == 'rhq' ) {
                return $query->where('rhq', Session::get('gakkaiuserrhq'))->where('division', 'WD')->whereNotIn('district', array("-"))->select('rhq', 'zone', 'chapter', 'district', DB::Raw('SUM(dmjan) as "jan"'), DB::Raw('SUM(dmfeb) as "feb"'), DB::Raw('SUM(dmmar) as "mar"'), DB::Raw('SUM(dmapr) as "apr"'), DB::Raw('SUM(dmmay) as "may"'), DB::Raw('SUM(dmjun) as "jun"'), DB::Raw('SUM(dmjul) as "jul"'), DB::Raw('SUM(dmaug) as "aug"'), DB::Raw('SUM(dmsep) as "sep", SUM(dmoct) as "oct"'), DB::Raw('SUM(dmnov) as "nov"'), DB::Raw('SUM(dmdec) as "dec"'), DB::Raw('concat(chapter, " ", district) as description'))->groupby('rhq')->groupby('zone')->groupby('chapter')->groupby('district');
            } else if (Session::get('gakkaiuserpositionlevel') == 'zone' ) {
                return $query->where('zone', Session::get('gakkaiuserzone'))->where('division', 'WD')->whereNotIn('district', array("-"))->select('rhq', 'zone', 'chapter', 'district', DB::Raw('SUM(dmjan) as "jan"'), DB::Raw('SUM(dmfeb) as "feb"'), DB::Raw('SUM(dmmar) as "mar"'), DB::Raw('SUM(dmapr) as "apr"'), DB::Raw('SUM(dmmay) as "may"'), DB::Raw('SUM(dmjun) as "jun"'), DB::Raw('SUM(dmjul) as "jul"'), DB::Raw('SUM(dmaug) as "aug"'), DB::Raw('SUM(dmsep) as "sep", SUM(dmoct) as "oct"'), DB::Raw('SUM(dmnov) as "nov"'), DB::Raw('SUM(dmdec) as "dec"'), DB::Raw('concat(chapter, " ", district) as description'))->groupby('rhq')->groupby('zone')->groupby('chapter')->groupby('district');
            } else if (Session::get('gakkaiuserpositionlevel') == 'chapter' ) {
                return $query->where('chapter', Session::get('gakkaiuserchapter'))->where('division', 'WD')->whereNotIn('district', array("-"))->select('rhq', 'zone', 'chapter', 'district', DB::Raw('SUM(dmjan) as "jan"'), DB::Raw('SUM(dmfeb) as "feb"'), DB::Raw('SUM(dmmar) as "mar"'), DB::Raw('SUM(dmapr) as "apr"'), DB::Raw('SUM(dmmay) as "may"'), DB::Raw('SUM(dmjun) as "jun"'), DB::Raw('SUM(dmjul) as "jul"'), DB::Raw('SUM(dmaug) as "aug"'), DB::Raw('SUM(dmsep) as "sep", SUM(dmoct) as "oct"'), DB::Raw('SUM(dmnov) as "nov"'), DB::Raw('SUM(dmdec) as "dec"'), DB::Raw('concat(chapter, " ", district) as description'))->groupby('rhq')->groupby('zone')->groupby('chapter')->groupby('district');
            } else if (Session::get('gakkaiuserpositionlevel') == 'district' ) {
                return $query->where('chapter', Session::get('gakkaiuserchapter'))->where('district', Session::get('gakkaiuserdistrict'))->where('division', 'WD')->whereNotIn('district', array("-"))->select('rhq', 'zone', 'chapter', 'district', DB::Raw('SUM(dmjan) as "jan"'), DB::Raw('SUM(dmfeb) as "feb"'), DB::Raw('SUM(dmmar) as "mar"'), DB::Raw('SUM(dmapr) as "apr"'), DB::Raw('SUM(dmmay) as "may"'), DB::Raw('SUM(dmjun) as "jun"'), DB::Raw('SUM(dmjul) as "jul"'), DB::Raw('SUM(dmaug) as "aug"'), DB::Raw('SUM(dmsep) as "sep", SUM(dmoct) as "oct"'), DB::Raw('SUM(dmnov) as "nov"'), DB::Raw('SUM(dmdec) as "dec"'), DB::Raw('concat(chapter, " ", district) as description'))->groupby('rhq')->groupby('zone')->groupby('chapter')->groupby('district');
            }
        }
        elseif ( $divisiontype == 'YMD')
        {
            if (Session::get('gakkaiuserpositionlevel') == 'shq' ) {
                return $query->where('division', 'YM')->whereNotIn('district', array("-"))->select('rhq', 'zone', 'chapter', 'district', DB::Raw('SUM(dmjan) as "jan"'), DB::Raw('SUM(dmfeb) as "feb"'), DB::Raw('SUM(dmmar) as "mar"'), DB::Raw('SUM(dmapr) as "apr"'), DB::Raw('SUM(dmmay) as "may"'), DB::Raw('SUM(dmjun) as "jun"'), DB::Raw('SUM(dmjul) as "jul"'), DB::Raw('SUM(dmaug) as "aug"'), DB::Raw('SUM(dmsep) as "sep", SUM(dmoct) as "oct"'), DB::Raw('SUM(dmnov) as "nov"'), DB::Raw('SUM(dmdec) as "dec"'), DB::Raw('concat(chapter, " ", district) as description'))->groupby('rhq')->groupby('zone')->groupby('chapter')->groupby('district');
            } else if (Session::get('gakkaiuserpositionlevel') == 'rhq' ) {
                return $query->where('rhq', Session::get('gakkaiuserrhq'))->where('division', 'YM')->whereNotIn('district', array("-"))->select('rhq', 'zone', 'chapter', 'district', DB::Raw('SUM(dmjan) as "jan"'), DB::Raw('SUM(dmfeb) as "feb"'), DB::Raw('SUM(dmmar) as "mar"'), DB::Raw('SUM(dmapr) as "apr"'), DB::Raw('SUM(dmmay) as "may"'), DB::Raw('SUM(dmjun) as "jun"'), DB::Raw('SUM(dmjul) as "jul"'), DB::Raw('SUM(dmaug) as "aug"'), DB::Raw('SUM(dmsep) as "sep", SUM(dmoct) as "oct"'), DB::Raw('SUM(dmnov) as "nov"'), DB::Raw('SUM(dmdec) as "dec"'), DB::Raw('concat(chapter, " ", district) as description'))->groupby('rhq')->groupby('zone')->groupby('chapter')->groupby('district');
            } else if (Session::get('gakkaiuserpositionlevel') == 'zone' ) {
                return $query->where('zone', Session::get('gakkaiuserzone'))->where('division', 'YM')->whereNotIn('district', array("-"))->select('rhq', 'zone', 'chapter', 'district', DB::Raw('SUM(dmjan) as "jan"'), DB::Raw('SUM(dmfeb) as "feb"'), DB::Raw('SUM(dmmar) as "mar"'), DB::Raw('SUM(dmapr) as "apr"'), DB::Raw('SUM(dmmay) as "may"'), DB::Raw('SUM(dmjun) as "jun"'), DB::Raw('SUM(dmjul) as "jul"'), DB::Raw('SUM(dmaug) as "aug"'), DB::Raw('SUM(dmsep) as "sep", SUM(dmoct) as "oct"'), DB::Raw('SUM(dmnov) as "nov"'), DB::Raw('SUM(dmdec) as "dec"'), DB::Raw('concat(chapter, " ", district) as description'))->groupby('rhq')->groupby('zone')->groupby('chapter')->groupby('district');
            } else if (Session::get('gakkaiuserpositionlevel') == 'chapter' ) {
                return $query->where('chapter', Session::get('gakkaiuserchapter'))->where('division', 'YM')->whereNotIn('district', array("-"))->select('rhq', 'zone', 'chapter', 'district', DB::Raw('SUM(dmjan) as "jan"'), DB::Raw('SUM(dmfeb) as "feb"'), DB::Raw('SUM(dmmar) as "mar"'), DB::Raw('SUM(dmapr) as "apr"'), DB::Raw('SUM(dmmay) as "may"'), DB::Raw('SUM(dmjun) as "jun"'), DB::Raw('SUM(dmjul) as "jul"'), DB::Raw('SUM(dmaug) as "aug"'), DB::Raw('SUM(dmsep) as "sep", SUM(dmoct) as "oct"'), DB::Raw('SUM(dmnov) as "nov"'), DB::Raw('SUM(dmdec) as "dec"'), DB::Raw('concat(chapter, " ", district) as description'))->groupby('rhq')->groupby('zone')->groupby('chapter')->groupby('district');
            } else if (Session::get('gakkaiuserpositionlevel') == 'district' ) {
                return $query->where('chapter', Session::get('gakkaiuserchapter'))->where('district', Session::get('gakkaiuserdistrict'))->where('division', 'YM')->whereNotIn('district', array("-"))->select('rhq', 'zone', 'chapter', 'district', DB::Raw('SUM(dmjan) as "jan"'), DB::Raw('SUM(dmfeb) as "feb"'), DB::Raw('SUM(dmmar) as "mar"'), DB::Raw('SUM(dmapr) as "apr"'), DB::Raw('SUM(dmmay) as "may"'), DB::Raw('SUM(dmjun) as "jun"'), DB::Raw('SUM(dmjul) as "jul"'), DB::Raw('SUM(dmaug) as "aug"'), DB::Raw('SUM(dmsep) as "sep", SUM(dmoct) as "oct"'), DB::Raw('SUM(dmnov) as "nov"'), DB::Raw('SUM(dmdec) as "dec"'), DB::Raw('concat(chapter, " ", district) as description'))->groupby('rhq')->groupby('zone')->groupby('chapter')->groupby('district');
            }
        }
        elseif ( $divisiontype == 'YWD')
        {
            if (Session::get('gakkaiuserpositionlevel') == 'shq' ) {
                return $query->where('division', 'YW')->whereNotIn('district', array("-"))->select('rhq', 'zone', 'chapter', 'district', DB::Raw('SUM(dmjan) as "jan"'), DB::Raw('SUM(dmfeb) as "feb"'), DB::Raw('SUM(dmmar) as "mar"'), DB::Raw('SUM(dmapr) as "apr"'), DB::Raw('SUM(dmmay) as "may"'), DB::Raw('SUM(dmjun) as "jun"'), DB::Raw('SUM(dmjul) as "jul"'), DB::Raw('SUM(dmaug) as "aug"'), DB::Raw('SUM(dmsep) as "sep", SUM(dmoct) as "oct"'), DB::Raw('SUM(dmnov) as "nov"'), DB::Raw('SUM(dmdec) as "dec"'), DB::Raw('concat(chapter, " ", district) as description'))->groupby('rhq')->groupby('zone')->groupby('chapter')->groupby('district');
            } else if (Session::get('gakkaiuserpositionlevel') == 'rhq' ) {
                return $query->where('rhq', Session::get('gakkaiuserrhq'))->where('division', 'YW')->whereNotIn('district', array("-"))->select('rhq', 'zone', 'chapter', 'district', DB::Raw('SUM(dmjan) as "jan"'), DB::Raw('SUM(dmfeb) as "feb"'), DB::Raw('SUM(dmmar) as "mar"'), DB::Raw('SUM(dmapr) as "apr"'), DB::Raw('SUM(dmmay) as "may"'), DB::Raw('SUM(dmjun) as "jun"'), DB::Raw('SUM(dmjul) as "jul"'), DB::Raw('SUM(dmaug) as "aug"'), DB::Raw('SUM(dmsep) as "sep", SUM(dmoct) as "oct"'), DB::Raw('SUM(dmnov) as "nov"'), DB::Raw('SUM(dmdec) as "dec"'), DB::Raw('concat(chapter, " ", district) as description'))->groupby('rhq')->groupby('zone')->groupby('chapter')->groupby('district');
            } else if (Session::get('gakkaiuserpositionlevel') == 'zone' ) {
                return $query->where('zone', Session::get('gakkaiuserzone'))->where('division', 'YW')->whereNotIn('district', array("-"))->select('rhq', 'zone', 'chapter', 'district', DB::Raw('SUM(dmjan) as "jan"'), DB::Raw('SUM(dmfeb) as "feb"'), DB::Raw('SUM(dmmar) as "mar"'), DB::Raw('SUM(dmapr) as "apr"'), DB::Raw('SUM(dmmay) as "may"'), DB::Raw('SUM(dmjun) as "jun"'), DB::Raw('SUM(dmjul) as "jul"'), DB::Raw('SUM(dmaug) as "aug"'), DB::Raw('SUM(dmsep) as "sep", SUM(dmoct) as "oct"'), DB::Raw('SUM(dmnov) as "nov"'), DB::Raw('SUM(dmdec) as "dec"'), DB::Raw('concat(chapter, " ", district) as description'))->groupby('rhq')->groupby('zone')->groupby('chapter')->groupby('district');
            } else if (Session::get('gakkaiuserpositionlevel') == 'chapter' ) {
                return $query->where('chapter', Session::get('gakkaiuserchapter'))->where('division', 'YW')->whereNotIn('district', array("-"))->select('rhq', 'zone', 'chapter', 'district', DB::Raw('SUM(dmjan) as "jan"'), DB::Raw('SUM(dmfeb) as "feb"'), DB::Raw('SUM(dmmar) as "mar"'), DB::Raw('SUM(dmapr) as "apr"'), DB::Raw('SUM(dmmay) as "may"'), DB::Raw('SUM(dmjun) as "jun"'), DB::Raw('SUM(dmjul) as "jul"'), DB::Raw('SUM(dmaug) as "aug"'), DB::Raw('SUM(dmsep) as "sep", SUM(dmoct) as "oct"'), DB::Raw('SUM(dmnov) as "nov"'), DB::Raw('SUM(dmdec) as "dec"'), DB::Raw('concat(chapter, " ", district) as description'))->groupby('rhq')->groupby('zone')->groupby('chapter')->groupby('district');
            } else if (Session::get('gakkaiuserpositionlevel') == 'district' ) {
                return $query->where('chapter', Session::get('gakkaiuserchapter'))->where('district', Session::get('gakkaiuserdistrict'))->where('division', 'YW')->whereNotIn('district', array("-"))->select('rhq', 'zone', 'chapter', 'district', DB::Raw('SUM(dmjan) as "jan"'), DB::Raw('SUM(dmfeb) as "feb"'), DB::Raw('SUM(dmmar) as "mar"'), DB::Raw('SUM(dmapr) as "apr"'), DB::Raw('SUM(dmmay) as "may"'), DB::Raw('SUM(dmjun) as "jun"'), DB::Raw('SUM(dmjul) as "jul"'), DB::Raw('SUM(dmaug) as "aug"'), DB::Raw('SUM(dmsep) as "sep", SUM(dmoct) as "oct"'), DB::Raw('SUM(dmnov) as "nov"'), DB::Raw('SUM(dmdec) as "dec"'), DB::Raw('concat(chapter, " ", district) as description'))->groupby('rhq')->groupby('zone')->groupby('chapter')->groupby('district');
            }
        }
        elseif ( $divisiontype == 'Primary Division')
        {
            if (Session::get('gakkaiuserpositionlevel') == 'shq' ) {
                return $query->where('agegroup', '07 to 12')->whereNotIn('district', array("-"))->select('rhq', 'zone', 'chapter', 'district', DB::Raw('SUM(dmjan) as "jan"'), DB::Raw('SUM(dmfeb) as "feb"'), DB::Raw('SUM(dmmar) as "mar"'), DB::Raw('SUM(dmapr) as "apr"'), DB::Raw('SUM(dmmay) as "may"'), DB::Raw('SUM(dmjun) as "jun"'), DB::Raw('SUM(dmjul) as "jul"'), DB::Raw('SUM(dmaug) as "aug"'), DB::Raw('SUM(dmsep) as "sep", SUM(dmoct) as "oct"'), DB::Raw('SUM(dmnov) as "nov"'), DB::Raw('SUM(dmdec) as "dec"'), DB::Raw('concat(chapter, " ", district) as description'))->groupby('rhq')->groupby('zone')->groupby('chapter')->groupby('district');
            } else if (Session::get('gakkaiuserpositionlevel') == 'rhq' ) {
                return $query->where('rhq', Session::get('gakkaiuserrhq'))->where('agegroup', '07 to 12')->whereNotIn('district', array("-"))->select('rhq', 'zone', 'chapter', 'district', DB::Raw('SUM(dmjan) as "jan"'), DB::Raw('SUM(dmfeb) as "feb"'), DB::Raw('SUM(dmmar) as "mar"'), DB::Raw('SUM(dmapr) as "apr"'), DB::Raw('SUM(dmmay) as "may"'), DB::Raw('SUM(dmjun) as "jun"'), DB::Raw('SUM(dmjul) as "jul"'), DB::Raw('SUM(dmaug) as "aug"'), DB::Raw('SUM(dmsep) as "sep", SUM(dmoct) as "oct"'), DB::Raw('SUM(dmnov) as "nov"'), DB::Raw('SUM(dmdec) as "dec"'), DB::Raw('concat(chapter, " ", district) as description'))->groupby('rhq')->groupby('zone')->groupby('chapter')->groupby('district');
            } else if (Session::get('gakkaiuserpositionlevel') == 'zone' ) {
                return $query->where('zone', Session::get('gakkaiuserzone'))->where('agegroup', '07 to 12')->whereNotIn('district', array("-"))->select('rhq', 'zone', 'chapter', 'district', DB::Raw('SUM(dmjan) as "jan"'), DB::Raw('SUM(dmfeb) as "feb"'), DB::Raw('SUM(dmmar) as "mar"'), DB::Raw('SUM(dmapr) as "apr"'), DB::Raw('SUM(dmmay) as "may"'), DB::Raw('SUM(dmjun) as "jun"'), DB::Raw('SUM(dmjul) as "jul"'), DB::Raw('SUM(dmaug) as "aug"'), DB::Raw('SUM(dmsep) as "sep", SUM(dmoct) as "oct"'), DB::Raw('SUM(dmnov) as "nov"'), DB::Raw('SUM(dmdec) as "dec"'), DB::Raw('concat(chapter, " ", district) as description'))->groupby('rhq')->groupby('zone')->groupby('chapter')->groupby('district');
            } else if (Session::get('gakkaiuserpositionlevel') == 'chapter' ) {
                return $query->where('chapter', Session::get('gakkaiuserchapter'))->where('agegroup', '07 to 12')->whereNotIn('district', array("-"))->select('rhq', 'zone', 'chapter', 'district', DB::Raw('SUM(dmjan) as "jan"'), DB::Raw('SUM(dmfeb) as "feb"'), DB::Raw('SUM(dmmar) as "mar"'), DB::Raw('SUM(dmapr) as "apr"'), DB::Raw('SUM(dmmay) as "may"'), DB::Raw('SUM(dmjun) as "jun"'), DB::Raw('SUM(dmjul) as "jul"'), DB::Raw('SUM(dmaug) as "aug"'), DB::Raw('SUM(dmsep) as "sep", SUM(dmoct) as "oct"'), DB::Raw('SUM(dmnov) as "nov"'), DB::Raw('SUM(dmdec) as "dec"'), DB::Raw('concat(chapter, " ", district) as description'))->groupby('rhq')->groupby('zone')->groupby('chapter')->groupby('district');
            } else if (Session::get('gakkaiuserpositionlevel') == 'district' ) {
                return $query->where('chapter', Session::get('gakkaiuserchapter'))->where('district', Session::get('gakkaiuserdistrict'))->where('agegroup', '07 to 12')->whereNotIn('district', array("-"))->select('rhq', 'zone', 'chapter', 'district', DB::Raw('SUM(dmjan) as "jan"'), DB::Raw('SUM(dmfeb) as "feb"'), DB::Raw('SUM(dmmar) as "mar"'), DB::Raw('SUM(dmapr) as "apr"'), DB::Raw('SUM(dmmay) as "may"'), DB::Raw('SUM(dmjun) as "jun"'), DB::Raw('SUM(dmjul) as "jul"'), DB::Raw('SUM(dmaug) as "aug"'), DB::Raw('SUM(dmsep) as "sep", SUM(dmoct) as "oct"'), DB::Raw('SUM(dmnov) as "nov"'), DB::Raw('SUM(dmdec) as "dec"'), DB::Raw('concat(chapter, " ", district) as description'))->groupby('rhq')->groupby('zone')->groupby('chapter')->groupby('district');
            }
        }
        elseif ( $divisiontype == 'Future Division')
        {
            if (Session::get('gakkaiuserpositionlevel') == 'shq' ) {
                return $query->where('agegroup', '13 to 16')->whereNotIn('district', array("-"))->select('rhq', 'zone', 'chapter', 'district', DB::Raw('SUM(dmjan) as "jan"'), DB::Raw('SUM(dmfeb) as "feb"'), DB::Raw('SUM(dmmar) as "mar"'), DB::Raw('SUM(dmapr) as "apr"'), DB::Raw('SUM(dmmay) as "may"'), DB::Raw('SUM(dmjun) as "jun"'), DB::Raw('SUM(dmjul) as "jul"'), DB::Raw('SUM(dmaug) as "aug"'), DB::Raw('SUM(dmsep) as "sep", SUM(dmoct) as "oct"'), DB::Raw('SUM(dmnov) as "nov"'), DB::Raw('SUM(dmdec) as "dec"'), DB::Raw('concat(chapter, " ", district) as description'))->groupby('rhq')->groupby('zone')->groupby('chapter')->groupby('district');
            } else if (Session::get('gakkaiuserpositionlevel') == 'rhq' ) {
                return $query->where('rhq', Session::get('gakkaiuserrhq'))->where('agegroup', '13 to 16')->whereNotIn('district', array("-"))->select('rhq', 'zone', 'chapter', 'district', DB::Raw('SUM(dmjan) as "jan"'), DB::Raw('SUM(dmfeb) as "feb"'), DB::Raw('SUM(dmmar) as "mar"'), DB::Raw('SUM(dmapr) as "apr"'), DB::Raw('SUM(dmmay) as "may"'), DB::Raw('SUM(dmjun) as "jun"'), DB::Raw('SUM(dmjul) as "jul"'), DB::Raw('SUM(dmaug) as "aug"'), DB::Raw('SUM(dmsep) as "sep", SUM(dmoct) as "oct"'), DB::Raw('SUM(dmnov) as "nov"'), DB::Raw('SUM(dmdec) as "dec"'), DB::Raw('concat(chapter, " ", district) as description'))->groupby('rhq')->groupby('zone')->groupby('chapter')->groupby('district');
            } else if (Session::get('gakkaiuserpositionlevel') == 'zone' ) {
                return $query->where('zone', Session::get('gakkaiuserzone'))->where('agegroup', '13 to 16')->whereNotIn('district', array("-"))->select('rhq', 'zone', 'chapter', 'district', DB::Raw('SUM(dmjan) as "jan"'), DB::Raw('SUM(dmfeb) as "feb"'), DB::Raw('SUM(dmmar) as "mar"'), DB::Raw('SUM(dmapr) as "apr"'), DB::Raw('SUM(dmmay) as "may"'), DB::Raw('SUM(dmjun) as "jun"'), DB::Raw('SUM(dmjul) as "jul"'), DB::Raw('SUM(dmaug) as "aug"'), DB::Raw('SUM(dmsep) as "sep", SUM(dmoct) as "oct"'), DB::Raw('SUM(dmnov) as "nov"'), DB::Raw('SUM(dmdec) as "dec"'), DB::Raw('concat(chapter, " ", district) as description'))->groupby('rhq')->groupby('zone')->groupby('chapter')->groupby('district');
            } else if (Session::get('gakkaiuserpositionlevel') == 'chapter' ) {
                return $query->where('chapter', Session::get('gakkaiuserchapter'))->where('agegroup', '13 to 16')->whereNotIn('district', array("-"))->select('rhq', 'zone', 'chapter', 'district', DB::Raw('SUM(dmjan) as "jan"'), DB::Raw('SUM(dmfeb) as "feb"'), DB::Raw('SUM(dmmar) as "mar"'), DB::Raw('SUM(dmapr) as "apr"'), DB::Raw('SUM(dmmay) as "may"'), DB::Raw('SUM(dmjun) as "jun"'), DB::Raw('SUM(dmjul) as "jul"'), DB::Raw('SUM(dmaug) as "aug"'), DB::Raw('SUM(dmsep) as "sep", SUM(dmoct) as "oct"'), DB::Raw('SUM(dmnov) as "nov"'), DB::Raw('SUM(dmdec) as "dec"'), DB::Raw('concat(chapter, " ", district) as description'))->groupby('rhq')->groupby('zone')->groupby('chapter')->groupby('district');
            } else if (Session::get('gakkaiuserpositionlevel') == 'district' ) {
                return $query->where('chapter', Session::get('gakkaiuserchapter'))->where('district', Session::get('gakkaiuserdistrict'))->where('agegroup', '13 to 16')->whereNotIn('district', array("-"))->select('rhq', 'zone', 'chapter', 'district', DB::Raw('SUM(dmjan) as "jan"'), DB::Raw('SUM(dmfeb) as "feb"'), DB::Raw('SUM(dmmar) as "mar"'), DB::Raw('SUM(dmapr) as "apr"'), DB::Raw('SUM(dmmay) as "may"'), DB::Raw('SUM(dmjun) as "jun"'), DB::Raw('SUM(dmjul) as "jul"'), DB::Raw('SUM(dmaug) as "aug"'), DB::Raw('SUM(dmsep) as "sep", SUM(dmoct) as "oct"'), DB::Raw('SUM(dmnov) as "nov"'), DB::Raw('SUM(dmdec) as "dec"'), DB::Raw('concat(chapter, " ", district) as description'))->groupby('rhq')->groupby('zone')->groupby('chapter')->groupby('district');
            }
        }
        elseif ( $divisiontype == 'Student Division')
        {
            if (Session::get('gakkaiuserpositionlevel') == 'shq' ) {
                return $query->whereNotIn('district', array("-"))->select('rhq', 'zone', 'chapter', 'district', DB::Raw('SUM(dmjan) as "jan"'), DB::Raw('SUM(dmfeb) as "feb"'), DB::Raw('SUM(dmmar) as "mar"'), DB::Raw('SUM(dmapr) as "apr"'), DB::Raw('SUM(dmmay) as "may"'), DB::Raw('SUM(dmjun) as "jun"'), DB::Raw('SUM(dmjul) as "jul"'), DB::Raw('SUM(dmaug) as "aug"'), DB::Raw('SUM(dmsep) as "sep", SUM(dmoct) as "oct"'), DB::Raw('SUM(dmnov) as "nov"'), DB::Raw('SUM(dmdec) as "dec"'), DB::Raw('concat(chapter, " ", district) as description'))->groupby('rhq')->groupby('zone')->groupby('chapter')->groupby('district');
            } else if (Session::get('gakkaiuserpositionlevel') == 'rhq' ) {
                return $query->where('rhq', Session::get('gakkaiuserrhq'))->where('studentdivision', '!=', '')->whereNotIn('district', array("-"))->select('rhq', 'zone', 'chapter', 'district', DB::Raw('SUM(dmjan) as "jan"'), DB::Raw('SUM(dmfeb) as "feb"'), DB::Raw('SUM(dmmar) as "mar"'), DB::Raw('SUM(dmapr) as "apr"'), DB::Raw('SUM(dmmay) as "may"'), DB::Raw('SUM(dmjun) as "jun"'), DB::Raw('SUM(dmjul) as "jul"'), DB::Raw('SUM(dmaug) as "aug"'), DB::Raw('SUM(dmsep) as "sep", SUM(dmoct) as "oct"'), DB::Raw('SUM(dmnov) as "nov"'), DB::Raw('SUM(dmdec) as "dec"'), DB::Raw('concat(chapter, " ", district) as description'))->groupby('rhq')->groupby('zone')->groupby('chapter')->groupby('district');
            } else if (Session::get('gakkaiuserpositionlevel') == 'zone' ) {
                return $query->where('zone', Session::get('gakkaiuserzone'))->where('studentdivision', '!=', '')->whereNotIn('district', array("-"))->select('rhq', 'zone', 'chapter', 'district', DB::Raw('SUM(dmjan) as "jan"'), DB::Raw('SUM(dmfeb) as "feb"'), DB::Raw('SUM(dmmar) as "mar"'), DB::Raw('SUM(dmapr) as "apr"'), DB::Raw('SUM(dmmay) as "may"'), DB::Raw('SUM(dmjun) as "jun"'), DB::Raw('SUM(dmjul) as "jul"'), DB::Raw('SUM(dmaug) as "aug"'), DB::Raw('SUM(dmsep) as "sep", SUM(dmoct) as "oct"'), DB::Raw('SUM(dmnov) as "nov"'), DB::Raw('SUM(dmdec) as "dec"'), DB::Raw('concat(chapter, " ", district) as description'))->groupby('rhq')->groupby('zone')->groupby('chapter')->groupby('district');
            } else if (Session::get('gakkaiuserpositionlevel') == 'chapter' ) {
                return $query->where('chapter', Session::get('gakkaiuserchapter'))->where('studentdivision', '!=', '')->whereNotIn('district', array("-"))->select('rhq', 'zone', 'chapter', 'district', DB::Raw('SUM(dmjan) as "jan"'), DB::Raw('SUM(dmfeb) as "feb"'), DB::Raw('SUM(dmmar) as "mar"'), DB::Raw('SUM(dmapr) as "apr"'), DB::Raw('SUM(dmmay) as "may"'), DB::Raw('SUM(dmjun) as "jun"'), DB::Raw('SUM(dmjul) as "jul"'), DB::Raw('SUM(dmaug) as "aug"'), DB::Raw('SUM(dmsep) as "sep", SUM(dmoct) as "oct"'), DB::Raw('SUM(dmnov) as "nov"'), DB::Raw('SUM(dmdec) as "dec"'), DB::Raw('concat(chapter, " ", district) as description'))->groupby('rhq')->groupby('zone')->groupby('chapter')->groupby('district');
            } else if (Session::get('gakkaiuserpositionlevel') == 'district' ) {
                return $query->where('chapter', Session::get('gakkaiuserchapter'))->where('district', Session::get('gakkaiuserdistrict'))->where('studentdivision', '!=', '')->whereNotIn('district', array("-"))->select('rhq', 'zone', 'chapter', 'district', DB::Raw('SUM(dmjan) as "jan"'), DB::Raw('SUM(dmfeb) as "feb"'), DB::Raw('SUM(dmmar) as "mar"'), DB::Raw('SUM(dmapr) as "apr"'), DB::Raw('SUM(dmmay) as "may"'), DB::Raw('SUM(dmjun) as "jun"'), DB::Raw('SUM(dmjul) as "jul"'), DB::Raw('SUM(dmaug) as "aug"'), DB::Raw('SUM(dmsep) as "sep", SUM(dmoct) as "oct"'), DB::Raw('SUM(dmnov) as "nov"'), DB::Raw('SUM(dmdec) as "dec"'), DB::Raw('concat(chapter, " ", district) as description'))->groupby('rhq')->groupby('zone')->groupby('chapter')->groupby('district');
            }
        }
        elseif ( $divisiontype == 'Adult Division')
        {
            if (Session::get('gakkaiuserpositionlevel') == 'shq' ) {
                return $query->whereIn('division', array('MD', 'WD'))->whereNotIn('district', array("-"))->select('rhq', 'zone', 'chapter', 'district', DB::Raw('SUM(dmjan) as "jan"'), DB::Raw('SUM(dmfeb) as "feb"'), DB::Raw('SUM(dmmar) as "mar"'), DB::Raw('SUM(dmapr) as "apr"'), DB::Raw('SUM(dmmay) as "may"'), DB::Raw('SUM(dmjun) as "jun"'), DB::Raw('SUM(dmjul) as "jul"'), DB::Raw('SUM(dmaug) as "aug"'), DB::Raw('SUM(dmsep) as "sep", SUM(dmoct) as "oct"'), DB::Raw('SUM(dmnov) as "nov"'), DB::Raw('SUM(dmdec) as "dec"'), DB::Raw('concat(chapter, " ", district) as description'))->groupby('rhq')->groupby('zone')->groupby('chapter')->groupby('district');
            } else if (Session::get('gakkaiuserpositionlevel') == 'rhq' ) {
                return $query->where('rhq', Session::get('gakkaiuserrhq'))->whereIn('division', array('MD', 'WD'))->whereNotIn('district', array("-"))->select('rhq', 'zone', 'chapter', 'district', DB::Raw('SUM(dmjan) as "jan"'), DB::Raw('SUM(dmfeb) as "feb"'), DB::Raw('SUM(dmmar) as "mar"'), DB::Raw('SUM(dmapr) as "apr"'), DB::Raw('SUM(dmmay) as "may"'), DB::Raw('SUM(dmjun) as "jun"'), DB::Raw('SUM(dmjul) as "jul"'), DB::Raw('SUM(dmaug) as "aug"'), DB::Raw('SUM(dmsep) as "sep", SUM(dmoct) as "oct"'), DB::Raw('SUM(dmnov) as "nov"'), DB::Raw('SUM(dmdec) as "dec"'), DB::Raw('concat(chapter, " ", district) as description'))->groupby('rhq')->groupby('zone')->groupby('chapter')->groupby('district');
            } else if (Session::get('gakkaiuserpositionlevel') == 'zone' ) {
                return $query->where('zone', Session::get('gakkaiuserzone'))->whereIn('division', array('MD', 'WD'))->whereNotIn('district', array("-"))->select('rhq', 'zone', 'chapter', 'district', DB::Raw('SUM(dmjan) as "jan"'), DB::Raw('SUM(dmfeb) as "feb"'), DB::Raw('SUM(dmmar) as "mar"'), DB::Raw('SUM(dmapr) as "apr"'), DB::Raw('SUM(dmmay) as "may"'), DB::Raw('SUM(dmjun) as "jun"'), DB::Raw('SUM(dmjul) as "jul"'), DB::Raw('SUM(dmaug) as "aug"'), DB::Raw('SUM(dmsep) as "sep", SUM(dmoct) as "oct"'), DB::Raw('SUM(dmnov) as "nov"'), DB::Raw('SUM(dmdec) as "dec"'), DB::Raw('concat(chapter, " ", district) as description'))->groupby('rhq')->groupby('zone')->groupby('chapter')->groupby('district');
            } else if (Session::get('gakkaiuserpositionlevel') == 'chapter' ) {
                return $query->where('chapter', Session::get('gakkaiuserchapter'))->whereIn('division', array('MD', 'WD'))->whereNotIn('district', array("-"))->select('rhq', 'zone', 'chapter', 'district', DB::Raw('SUM(dmjan) as "jan"'), DB::Raw('SUM(dmfeb) as "feb"'), DB::Raw('SUM(dmmar) as "mar"'), DB::Raw('SUM(dmapr) as "apr"'), DB::Raw('SUM(dmmay) as "may"'), DB::Raw('SUM(dmjun) as "jun"'), DB::Raw('SUM(dmjul) as "jul"'), DB::Raw('SUM(dmaug) as "aug"'), DB::Raw('SUM(dmsep) as "sep", SUM(dmoct) as "oct"'), DB::Raw('SUM(dmnov) as "nov"'), DB::Raw('SUM(dmdec) as "dec"'), DB::Raw('concat(chapter, " ", district) as description'))->groupby('rhq')->groupby('zone')->groupby('chapter')->groupby('district');
            } else if (Session::get('gakkaiuserpositionlevel') == 'district' ) {
                return $query->where('chapter', Session::get('gakkaiuserchapter'))->where('district', Session::get('gakkaiuserdistrict'))->whereIn('division', array('MD', 'WD'))->whereNotIn('district', array("-"))->select('rhq', 'zone', 'chapter', 'district', DB::Raw('SUM(dmjan) as "jan"'), DB::Raw('SUM(dmfeb) as "feb"'), DB::Raw('SUM(dmmar) as "mar"'), DB::Raw('SUM(dmapr) as "apr"'), DB::Raw('SUM(dmmay) as "may"'), DB::Raw('SUM(dmjun) as "jun"'), DB::Raw('SUM(dmjul) as "jul"'), DB::Raw('SUM(dmaug) as "aug"'), DB::Raw('SUM(dmsep) as "sep", SUM(dmoct) as "oct"'), DB::Raw('SUM(dmnov) as "nov"'), DB::Raw('SUM(dmdec) as "dec"'), DB::Raw('concat(chapter, " ", district) as description'))->groupby('rhq')->groupby('zone')->groupby('chapter')->groupby('district');
            }
        }
        elseif ( $divisiontype == 'Youth Division')
        {
            if (Session::get('gakkaiuserpositionlevel') == 'shq' ) {
                return $query->whereIn('division', array('YM', 'YW'))->whereNotIn('district', array("-"))->select('rhq', 'zone', 'chapter', 'district', DB::Raw('SUM(dmjan) as "jan"'), DB::Raw('SUM(dmfeb) as "feb"'), DB::Raw('SUM(dmmar) as "mar"'), DB::Raw('SUM(dmapr) as "apr"'), DB::Raw('SUM(dmmay) as "may"'), DB::Raw('SUM(dmjun) as "jun"'), DB::Raw('SUM(dmjul) as "jul"'), DB::Raw('SUM(dmaug) as "aug"'), DB::Raw('SUM(dmsep) as "sep", SUM(dmoct) as "oct"'), DB::Raw('SUM(dmnov) as "nov"'), DB::Raw('SUM(dmdec) as "dec"'), DB::Raw('concat(chapter, " ", district) as description'))->groupby('rhq')->groupby('zone')->groupby('chapter')->groupby('district');
            } else if (Session::get('gakkaiuserpositionlevel') == 'rhq' ) {
                return $query->where('rhq', Session::get('gakkaiuserrhq'))->whereIn('division', array('YM', 'YW'))->whereNotIn('district', array("-"))->select('rhq', 'zone', 'chapter', 'district', DB::Raw('SUM(dmjan) as "jan"'), DB::Raw('SUM(dmfeb) as "feb"'), DB::Raw('SUM(dmmar) as "mar"'), DB::Raw('SUM(dmapr) as "apr"'), DB::Raw('SUM(dmmay) as "may"'), DB::Raw('SUM(dmjun) as "jun"'), DB::Raw('SUM(dmjul) as "jul"'), DB::Raw('SUM(dmaug) as "aug"'), DB::Raw('SUM(dmsep) as "sep", SUM(dmoct) as "oct"'), DB::Raw('SUM(dmnov) as "nov"'), DB::Raw('SUM(dmdec) as "dec"'), DB::Raw('concat(chapter, " ", district) as description'))->groupby('rhq')->groupby('zone')->groupby('chapter')->groupby('district');
            } else if (Session::get('gakkaiuserpositionlevel') == 'zone' ) {
                return $query->where('zone', Session::get('gakkaiuserzone'))->whereIn('division', array('YM', 'YW'))->whereNotIn('district', array("-"))->select('rhq', 'zone', 'chapter', 'district', DB::Raw('SUM(dmjan) as "jan"'), DB::Raw('SUM(dmfeb) as "feb"'), DB::Raw('SUM(dmmar) as "mar"'), DB::Raw('SUM(dmapr) as "apr"'), DB::Raw('SUM(dmmay) as "may"'), DB::Raw('SUM(dmjun) as "jun"'), DB::Raw('SUM(dmjul) as "jul"'), DB::Raw('SUM(dmaug) as "aug"'), DB::Raw('SUM(dmsep) as "sep", SUM(dmoct) as "oct"'), DB::Raw('SUM(dmnov) as "nov"'), DB::Raw('SUM(dmdec) as "dec"'), DB::Raw('concat(chapter, " ", district) as description'))->groupby('rhq')->groupby('zone')->groupby('chapter')->groupby('district');
            } else if (Session::get('gakkaiuserpositionlevel') == 'chapter' ) {
                return $query->where('chapter', Session::get('gakkaiuserchapter'))->whereIn('division', array('YM', 'YW'))->whereNotIn('district', array("-"))->select('rhq', 'zone', 'chapter', 'district', DB::Raw('SUM(dmjan) as "jan"'), DB::Raw('SUM(dmfeb) as "feb"'), DB::Raw('SUM(dmmar) as "mar"'), DB::Raw('SUM(dmapr) as "apr"'), DB::Raw('SUM(dmmay) as "may"'), DB::Raw('SUM(dmjun) as "jun"'), DB::Raw('SUM(dmjul) as "jul"'), DB::Raw('SUM(dmaug) as "aug"'), DB::Raw('SUM(dmsep) as "sep", SUM(dmoct) as "oct"'), DB::Raw('SUM(dmnov) as "nov"'), DB::Raw('SUM(dmdec) as "dec"'), DB::Raw('concat(chapter, " ", district) as description'))->groupby('rhq')->groupby('zone')->groupby('chapter')->groupby('district');
            } else if (Session::get('gakkaiuserpositionlevel') == 'district' ) {
                return $query->where('chapter', Session::get('gakkaiuserchapter'))->where('district', Session::get('gakkaiuserdistrict'))->whereIn('division', array('YM', 'YW'))->whereNotIn('district', array("-"))->select('rhq', 'zone', 'chapter', 'district', DB::Raw('SUM(dmjan) as "jan"'), DB::Raw('SUM(dmfeb) as "feb"'), DB::Raw('SUM(dmmar) as "mar"'), DB::Raw('SUM(dmapr) as "apr"'), DB::Raw('SUM(dmmay) as "may"'), DB::Raw('SUM(dmjun) as "jun"'), DB::Raw('SUM(dmjul) as "jul"'), DB::Raw('SUM(dmaug) as "aug"'), DB::Raw('SUM(dmsep) as "sep", SUM(dmoct) as "oct"'), DB::Raw('SUM(dmnov) as "nov"'), DB::Raw('SUM(dmdec) as "dec"'), DB::Raw('concat(chapter, " ", district) as description'))->groupby('rhq')->groupby('zone')->groupby('chapter')->groupby('district');
            }
        }
    }

    public function scopeLPNameList($query, $value, $divisiontype)
    {
        if ( $divisiontype == 'All' or $divisiontype == "4 Division")
        {
            if (Session::get('gakkaiuserpositionlevel') == 'shq' ) {
                return $query->whereNotIn('district', array("-"))->select('name', 'rhq', 'zone', 'chapter', 'district', 'division', 'position', DB::Raw('SUM(dmjan) as "jan"'), DB::Raw('SUM(dmfeb) as "feb"'), DB::Raw('SUM(dmmar) as "mar"'), DB::Raw('SUM(dmapr) as "apr"'), DB::Raw('SUM(dmmay) as "may"'), DB::Raw('SUM(dmjun) as "jun"'), DB::Raw('SUM(dmjul) as "jul"'), DB::Raw('SUM(dmaug) as "aug"'), DB::Raw('SUM(dmsep) as "sep", SUM(dmoct) as "oct"'), DB::Raw('SUM(dmnov) as "nov"'), DB::Raw('SUM(dmdec) as "dec"'), DB::Raw('concat(chapter, " ", district) as description'))->groupby('rhq')->groupby('zone')->groupby('chapter')->groupby('district')->groupby('name');
            } else if (Session::get('gakkaiuserpositionlevel') == 'rhq' ) {
                return $query->where('rhq', Session::get('gakkaiuserrhq'))->whereNotIn('district', array("-"))->select('name', 'rhq', 'zone', 'chapter', 'district', 'division', 'position', DB::Raw('SUM(dmjan) as "jan"'), DB::Raw('SUM(dmfeb) as "feb"'), DB::Raw('SUM(dmmar) as "mar"'), DB::Raw('SUM(dmapr) as "apr"'), DB::Raw('SUM(dmmay) as "may"'), DB::Raw('SUM(dmjun) as "jun"'), DB::Raw('SUM(dmjul) as "jul"'), DB::Raw('SUM(dmaug) as "aug"'), DB::Raw('SUM(dmsep) as "sep", SUM(dmoct) as "oct"'), DB::Raw('SUM(dmnov) as "nov"'), DB::Raw('SUM(dmdec) as "dec"'), DB::Raw('concat(chapter, " ", district) as description'))->groupby('rhq')->groupby('zone')->groupby('chapter')->groupby('district')->groupby('name');
            } else if (Session::get('gakkaiuserpositionlevel') == 'zone' ) {
                return $query->where('zone', Session::get('gakkaiuserzone'))->whereNotIn('district', array("-"))->select('name', 'rhq', 'zone', 'chapter', 'district', 'division', 'position', DB::Raw('SUM(dmjan) as "jan"'), DB::Raw('SUM(dmfeb) as "feb"'), DB::Raw('SUM(dmmar) as "mar"'), DB::Raw('SUM(dmapr) as "apr"'), DB::Raw('SUM(dmmay) as "may"'), DB::Raw('SUM(dmjun) as "jun"'), DB::Raw('SUM(dmjul) as "jul"'), DB::Raw('SUM(dmaug) as "aug"'), DB::Raw('SUM(dmsep) as "sep", SUM(dmoct) as "oct"'), DB::Raw('SUM(dmnov) as "nov"'), DB::Raw('SUM(dmdec) as "dec"'), DB::Raw('concat(chapter, " ", district) as description'))->groupby('rhq')->groupby('zone')->groupby('chapter')->groupby('district')->groupby('name');
            } else if (Session::get('gakkaiuserpositionlevel') == 'chapter' ) {
                return $query->where('chapter', Session::get('gakkaiuserchapter'))->whereNotIn('district', array("-"))->select('name', 'rhq', 'zone', 'chapter', 'district', 'division', 'position', DB::Raw('SUM(dmjan) as "jan"'), DB::Raw('SUM(dmfeb) as "feb"'), DB::Raw('SUM(dmmar) as "mar"'), DB::Raw('SUM(dmapr) as "apr"'), DB::Raw('SUM(dmmay) as "may"'), DB::Raw('SUM(dmjun) as "jun"'), DB::Raw('SUM(dmjul) as "jul"'), DB::Raw('SUM(dmaug) as "aug"'), DB::Raw('SUM(dmsep) as "sep", SUM(dmoct) as "oct"'), DB::Raw('SUM(dmnov) as "nov"'), DB::Raw('SUM(dmdec) as "dec"'), DB::Raw('concat(chapter, " ", district) as description'))->groupby('rhq')->groupby('zone')->groupby('chapter')->groupby('district')->groupby('name');
            } else if (Session::get('gakkaiuserpositionlevel') == 'district' ) {
                return $query->where('chapter', Session::get('gakkaiuserchapter'))->where('district', Session::get('gakkaiuserdistrict'))->whereNotIn('district', array("-"))->select('name', 'rhq', 'zone', 'chapter', 'district', 'division', 'position', DB::Raw('SUM(dmjan) as "jan"'), DB::Raw('SUM(dmfeb) as "feb"'), DB::Raw('SUM(dmmar) as "mar"'), DB::Raw('SUM(dmapr) as "apr"'), DB::Raw('SUM(dmmay) as "may"'), DB::Raw('SUM(dmjun) as "jun"'), DB::Raw('SUM(dmjul) as "jul"'), DB::Raw('SUM(dmaug) as "aug"'), DB::Raw('SUM(dmsep) as "sep", SUM(dmoct) as "oct"'), DB::Raw('SUM(dmnov) as "nov"'), DB::Raw('SUM(dmdec) as "dec"'), DB::Raw('concat(chapter, " ", district) as description'))->groupby('rhq')->groupby('zone')->groupby('chapter')->groupby('district')->groupby('name');
            }
        }
        elseif ( $divisiontype == 'MD')
        {
            if (Session::get('gakkaiuserpositionlevel') == 'shq' ) {
                return $query->where('division', 'MD')->whereNotIn('district', array("-"))->select('name', 'rhq', 'zone', 'chapter', 'district', 'division', 'position', DB::Raw('SUM(dmjan) as "jan"'), DB::Raw('SUM(dmfeb) as "feb"'), DB::Raw('SUM(dmmar) as "mar"'), DB::Raw('SUM(dmapr) as "apr"'), DB::Raw('SUM(dmmay) as "may"'), DB::Raw('SUM(dmjun) as "jun"'), DB::Raw('SUM(dmjul) as "jul"'), DB::Raw('SUM(dmaug) as "aug"'), DB::Raw('SUM(dmsep) as "sep", SUM(dmoct) as "oct"'), DB::Raw('SUM(dmnov) as "nov"'), DB::Raw('SUM(dmdec) as "dec"'), DB::Raw('concat(chapter, " ", district) as description'))->groupby('rhq')->groupby('zone')->groupby('chapter')->groupby('district')->groupby('name');
            } else if (Session::get('gakkaiuserpositionlevel') == 'rhq' ) {
                return $query->where('rhq', Session::get('gakkaiuserrhq'))->where('division', 'MD')->whereNotIn('district', array("-"))->select('name', 'rhq', 'zone', 'chapter', 'district', 'division', 'position', DB::Raw('SUM(dmjan) as "jan"'), DB::Raw('SUM(dmfeb) as "feb"'), DB::Raw('SUM(dmmar) as "mar"'), DB::Raw('SUM(dmapr) as "apr"'), DB::Raw('SUM(dmmay) as "may"'), DB::Raw('SUM(dmjun) as "jun"'), DB::Raw('SUM(dmjul) as "jul"'), DB::Raw('SUM(dmaug) as "aug"'), DB::Raw('SUM(dmsep) as "sep", SUM(dmoct) as "oct"'), DB::Raw('SUM(dmnov) as "nov"'), DB::Raw('SUM(dmdec) as "dec"'), DB::Raw('concat(chapter, " ", district) as description'))->groupby('rhq')->groupby('zone')->groupby('chapter')->groupby('district')->groupby('name');
            } else if (Session::get('gakkaiuserpositionlevel') == 'zone' ) {
                return $query->where('zone', Session::get('gakkaiuserzone'))->where('division', 'MD')->whereNotIn('district', array("-"))->select('name', 'rhq', 'zone', 'chapter', 'district', 'division', 'position', DB::Raw('SUM(dmjan) as "jan"'), DB::Raw('SUM(dmfeb) as "feb"'), DB::Raw('SUM(dmmar) as "mar"'), DB::Raw('SUM(dmapr) as "apr"'), DB::Raw('SUM(dmmay) as "may"'), DB::Raw('SUM(dmjun) as "jun"'), DB::Raw('SUM(dmjul) as "jul"'), DB::Raw('SUM(dmaug) as "aug"'), DB::Raw('SUM(dmsep) as "sep", SUM(dmoct) as "oct"'), DB::Raw('SUM(dmnov) as "nov"'), DB::Raw('SUM(dmdec) as "dec"'), DB::Raw('concat(chapter, " ", district) as description'))->groupby('rhq')->groupby('zone')->groupby('chapter')->groupby('district')->groupby('name');
            } else if (Session::get('gakkaiuserpositionlevel') == 'chapter' ) {
                return $query->where('chapter', Session::get('gakkaiuserchapter'))->where('division', 'MD')->whereNotIn('district', array("-"))->select('name', 'rhq', 'zone', 'chapter', 'district', 'division', 'position', DB::Raw('SUM(dmjan) as "jan"'), DB::Raw('SUM(dmfeb) as "feb"'), DB::Raw('SUM(dmmar) as "mar"'), DB::Raw('SUM(dmapr) as "apr"'), DB::Raw('SUM(dmmay) as "may"'), DB::Raw('SUM(dmjun) as "jun"'), DB::Raw('SUM(dmjul) as "jul"'), DB::Raw('SUM(dmaug) as "aug"'), DB::Raw('SUM(dmsep) as "sep", SUM(dmoct) as "oct"'), DB::Raw('SUM(dmnov) as "nov"'), DB::Raw('SUM(dmdec) as "dec"'), DB::Raw('concat(chapter, " ", district) as description'))->groupby('rhq')->groupby('zone')->groupby('chapter')->groupby('district')->groupby('name');
            } else if (Session::get('gakkaiuserpositionlevel') == 'district' ) {
                return $query->where('chapter', Session::get('gakkaiuserchapter'))->where('district', Session::get('gakkaiuserdistrict'))->where('division', 'MD')->whereNotIn('district', array("-"))->select('name', 'rhq', 'zone', 'chapter', 'district', 'division', 'position', DB::Raw('SUM(dmjan) as "jan"'), DB::Raw('SUM(dmfeb) as "feb"'), DB::Raw('SUM(dmmar) as "mar"'), DB::Raw('SUM(dmapr) as "apr"'), DB::Raw('SUM(dmmay) as "may"'), DB::Raw('SUM(dmjun) as "jun"'), DB::Raw('SUM(dmjul) as "jul"'), DB::Raw('SUM(dmaug) as "aug"'), DB::Raw('SUM(dmsep) as "sep", SUM(dmoct) as "oct"'), DB::Raw('SUM(dmnov) as "nov"'), DB::Raw('SUM(dmdec) as "dec"'), DB::Raw('concat(chapter, " ", district) as description'))->groupby('rhq')->groupby('zone')->groupby('chapter')->groupby('district')->groupby('name');
            }
        }
        elseif ( $divisiontype == 'WD')
        {
            if (Session::get('gakkaiuserpositionlevel') == 'shq' ) {
                return $query->where('division', 'WD')->whereNotIn('district', array("-"))->select('name', 'rhq', 'zone', 'chapter', 'district', 'division', 'position', DB::Raw('SUM(dmjan) as "jan"'), DB::Raw('SUM(dmfeb) as "feb"'), DB::Raw('SUM(dmmar) as "mar"'), DB::Raw('SUM(dmapr) as "apr"'), DB::Raw('SUM(dmmay) as "may"'), DB::Raw('SUM(dmjun) as "jun"'), DB::Raw('SUM(dmjul) as "jul"'), DB::Raw('SUM(dmaug) as "aug"'), DB::Raw('SUM(dmsep) as "sep", SUM(dmoct) as "oct"'), DB::Raw('SUM(dmnov) as "nov"'), DB::Raw('SUM(dmdec) as "dec"'), DB::Raw('concat(chapter, " ", district) as description'))->groupby('rhq')->groupby('zone')->groupby('chapter')->groupby('district')->groupby('name');
            } else if (Session::get('gakkaiuserpositionlevel') == 'rhq' ) {
                return $query->where('rhq', Session::get('gakkaiuserrhq'))->where('division', 'WD')->whereNotIn('district', array("-"))->select('name', 'rhq', 'zone', 'chapter', 'district', 'division', 'position', DB::Raw('SUM(dmjan) as "jan"'), DB::Raw('SUM(dmfeb) as "feb"'), DB::Raw('SUM(dmmar) as "mar"'), DB::Raw('SUM(dmapr) as "apr"'), DB::Raw('SUM(dmmay) as "may"'), DB::Raw('SUM(dmjun) as "jun"'), DB::Raw('SUM(dmjul) as "jul"'), DB::Raw('SUM(dmaug) as "aug"'), DB::Raw('SUM(dmsep) as "sep", SUM(dmoct) as "oct"'), DB::Raw('SUM(dmnov) as "nov"'), DB::Raw('SUM(dmdec) as "dec"'), DB::Raw('concat(chapter, " ", district) as description'))->groupby('rhq')->groupby('zone')->groupby('chapter')->groupby('district')->groupby('name');
            } else if (Session::get('gakkaiuserpositionlevel') == 'zone' ) {
                return $query->where('zone', Session::get('gakkaiuserzone'))->where('division', 'WD')->whereNotIn('district', array("-"))->select('name', 'rhq', 'zone', 'chapter', 'district', 'division', 'position', DB::Raw('SUM(dmjan) as "jan"'), DB::Raw('SUM(dmfeb) as "feb"'), DB::Raw('SUM(dmmar) as "mar"'), DB::Raw('SUM(dmapr) as "apr"'), DB::Raw('SUM(dmmay) as "may"'), DB::Raw('SUM(dmjun) as "jun"'), DB::Raw('SUM(dmjul) as "jul"'), DB::Raw('SUM(dmaug) as "aug"'), DB::Raw('SUM(dmsep) as "sep", SUM(dmoct) as "oct"'), DB::Raw('SUM(dmnov) as "nov"'), DB::Raw('SUM(dmdec) as "dec"'), DB::Raw('concat(chapter, " ", district) as description'))->groupby('rhq')->groupby('zone')->groupby('chapter')->groupby('district')->groupby('name');
            } else if (Session::get('gakkaiuserpositionlevel') == 'chapter' ) {
                return $query->where('chapter', Session::get('gakkaiuserchapter'))->where('division', 'WD')->whereNotIn('district', array("-"))->select('name', 'rhq', 'zone', 'chapter', 'district', 'division', 'position', DB::Raw('SUM(dmjan) as "jan"'), DB::Raw('SUM(dmfeb) as "feb"'), DB::Raw('SUM(dmmar) as "mar"'), DB::Raw('SUM(dmapr) as "apr"'), DB::Raw('SUM(dmmay) as "may"'), DB::Raw('SUM(dmjun) as "jun"'), DB::Raw('SUM(dmjul) as "jul"'), DB::Raw('SUM(dmaug) as "aug"'), DB::Raw('SUM(dmsep) as "sep", SUM(dmoct) as "oct"'), DB::Raw('SUM(dmnov) as "nov"'), DB::Raw('SUM(dmdec) as "dec"'), DB::Raw('concat(chapter, " ", district) as description'))->groupby('rhq')->groupby('zone')->groupby('chapter')->groupby('district')->groupby('name');
            } else if (Session::get('gakkaiuserpositionlevel') == 'district' ) {
                return $query->where('chapter', Session::get('gakkaiuserchapter'))->where('district', Session::get('gakkaiuserdistrict'))->where('division', 'WD')->whereNotIn('district', array("-"))->select('name', 'rhq', 'zone', 'chapter', 'district', 'division', 'position', DB::Raw('SUM(dmjan) as "jan"'), DB::Raw('SUM(dmfeb) as "feb"'), DB::Raw('SUM(dmmar) as "mar"'), DB::Raw('SUM(dmapr) as "apr"'), DB::Raw('SUM(dmmay) as "may"'), DB::Raw('SUM(dmjun) as "jun"'), DB::Raw('SUM(dmjul) as "jul"'), DB::Raw('SUM(dmaug) as "aug"'), DB::Raw('SUM(dmsep) as "sep", SUM(dmoct) as "oct"'), DB::Raw('SUM(dmnov) as "nov"'), DB::Raw('SUM(dmdec) as "dec"'), DB::Raw('concat(chapter, " ", district) as description'))->groupby('rhq')->groupby('zone')->groupby('chapter')->groupby('district')->groupby('name');
            }
        }
        elseif ( $divisiontype == 'YMD')
        {
            if (Session::get('gakkaiuserpositionlevel') == 'shq' ) {
                return $query->where('division', 'YM')->whereNotIn('district', array("-"))->select('name', 'rhq', 'zone', 'chapter', 'district', 'division', 'position', DB::Raw('SUM(dmjan) as "jan"'), DB::Raw('SUM(dmfeb) as "feb"'), DB::Raw('SUM(dmmar) as "mar"'), DB::Raw('SUM(dmapr) as "apr"'), DB::Raw('SUM(dmmay) as "may"'), DB::Raw('SUM(dmjun) as "jun"'), DB::Raw('SUM(dmjul) as "jul"'), DB::Raw('SUM(dmaug) as "aug"'), DB::Raw('SUM(dmsep) as "sep", SUM(dmoct) as "oct"'), DB::Raw('SUM(dmnov) as "nov"'), DB::Raw('SUM(dmdec) as "dec"'), DB::Raw('concat(chapter, " ", district) as description'))->groupby('rhq')->groupby('zone')->groupby('chapter')->groupby('district')->groupby('name');
            } else if (Session::get('gakkaiuserpositionlevel') == 'rhq' ) {
                return $query->where('rhq', Session::get('gakkaiuserrhq'))->where('division', 'YM')->whereNotIn('district', array("-"))->select('name', 'rhq', 'zone', 'chapter', 'district', 'division', 'position', DB::Raw('SUM(dmjan) as "jan"'), DB::Raw('SUM(dmfeb) as "feb"'), DB::Raw('SUM(dmmar) as "mar"'), DB::Raw('SUM(dmapr) as "apr"'), DB::Raw('SUM(dmmay) as "may"'), DB::Raw('SUM(dmjun) as "jun"'), DB::Raw('SUM(dmjul) as "jul"'), DB::Raw('SUM(dmaug) as "aug"'), DB::Raw('SUM(dmsep) as "sep", SUM(dmoct) as "oct"'), DB::Raw('SUM(dmnov) as "nov"'), DB::Raw('SUM(dmdec) as "dec"'), DB::Raw('concat(chapter, " ", district) as description'))->groupby('rhq')->groupby('zone')->groupby('chapter')->groupby('district')->groupby('name');
            } else if (Session::get('gakkaiuserpositionlevel') == 'zone' ) {
                return $query->where('zone', Session::get('gakkaiuserzone'))->where('division', 'YM')->whereNotIn('district', array("-"))->select('name', 'rhq', 'zone', 'chapter', 'district', 'division', 'position', DB::Raw('SUM(dmjan) as "jan"'), DB::Raw('SUM(dmfeb) as "feb"'), DB::Raw('SUM(dmmar) as "mar"'), DB::Raw('SUM(dmapr) as "apr"'), DB::Raw('SUM(dmmay) as "may"'), DB::Raw('SUM(dmjun) as "jun"'), DB::Raw('SUM(dmjul) as "jul"'), DB::Raw('SUM(dmaug) as "aug"'), DB::Raw('SUM(dmsep) as "sep", SUM(dmoct) as "oct"'), DB::Raw('SUM(dmnov) as "nov"'), DB::Raw('SUM(dmdec) as "dec"'), DB::Raw('concat(chapter, " ", district) as description'))->groupby('rhq')->groupby('zone')->groupby('chapter')->groupby('district')->groupby('name');
            } else if (Session::get('gakkaiuserpositionlevel') == 'chapter' ) {
                return $query->where('chapter', Session::get('gakkaiuserchapter'))->where('division', 'YM')->whereNotIn('district', array("-"))->select('name', 'rhq', 'zone', 'chapter', 'district', 'division', 'position', DB::Raw('SUM(dmjan) as "jan"'), DB::Raw('SUM(dmfeb) as "feb"'), DB::Raw('SUM(dmmar) as "mar"'), DB::Raw('SUM(dmapr) as "apr"'), DB::Raw('SUM(dmmay) as "may"'), DB::Raw('SUM(dmjun) as "jun"'), DB::Raw('SUM(dmjul) as "jul"'), DB::Raw('SUM(dmaug) as "aug"'), DB::Raw('SUM(dmsep) as "sep", SUM(dmoct) as "oct"'), DB::Raw('SUM(dmnov) as "nov"'), DB::Raw('SUM(dmdec) as "dec"'), DB::Raw('concat(chapter, " ", district) as description'))->groupby('rhq')->groupby('zone')->groupby('chapter')->groupby('district')->groupby('name');
            } else if (Session::get('gakkaiuserpositionlevel') == 'district' ) {
                return $query->where('chapter', Session::get('gakkaiuserchapter'))->where('district', Session::get('gakkaiuserdistrict'))->where('division', 'YM')->whereNotIn('district', array("-"))->select('name', 'rhq', 'zone', 'chapter', 'district', 'division', 'position', DB::Raw('SUM(dmjan) as "jan"'), DB::Raw('SUM(dmfeb) as "feb"'), DB::Raw('SUM(dmmar) as "mar"'), DB::Raw('SUM(dmapr) as "apr"'), DB::Raw('SUM(dmmay) as "may"'), DB::Raw('SUM(dmjun) as "jun"'), DB::Raw('SUM(dmjul) as "jul"'), DB::Raw('SUM(dmaug) as "aug"'), DB::Raw('SUM(dmsep) as "sep", SUM(dmoct) as "oct"'), DB::Raw('SUM(dmnov) as "nov"'), DB::Raw('SUM(dmdec) as "dec"'), DB::Raw('concat(chapter, " ", district) as description'))->groupby('rhq')->groupby('zone')->groupby('chapter')->groupby('district')->groupby('name');
            }
        }
        elseif ( $divisiontype == 'YWD')
        {
            if (Session::get('gakkaiuserpositionlevel') == 'shq' ) {
                return $query->where('division', 'YW')->whereNotIn('district', array("-"))->select('name', 'rhq', 'zone', 'chapter', 'district', 'division', 'position', DB::Raw('SUM(dmjan) as "jan"'), DB::Raw('SUM(dmfeb) as "feb"'), DB::Raw('SUM(dmmar) as "mar"'), DB::Raw('SUM(dmapr) as "apr"'), DB::Raw('SUM(dmmay) as "may"'), DB::Raw('SUM(dmjun) as "jun"'), DB::Raw('SUM(dmjul) as "jul"'), DB::Raw('SUM(dmaug) as "aug"'), DB::Raw('SUM(dmsep) as "sep", SUM(dmoct) as "oct"'), DB::Raw('SUM(dmnov) as "nov"'), DB::Raw('SUM(dmdec) as "dec"'), DB::Raw('concat(chapter, " ", district) as description'))->groupby('rhq')->groupby('zone')->groupby('chapter')->groupby('district')->groupby('name');
            } else if (Session::get('gakkaiuserpositionlevel') == 'rhq' ) {
                return $query->where('rhq', Session::get('gakkaiuserrhq'))->where('division', 'YW')->whereNotIn('district', array("-"))->select('name', 'rhq', 'zone', 'chapter', 'district', 'division', 'position', DB::Raw('SUM(dmjan) as "jan"'), DB::Raw('SUM(dmfeb) as "feb"'), DB::Raw('SUM(dmmar) as "mar"'), DB::Raw('SUM(dmapr) as "apr"'), DB::Raw('SUM(dmmay) as "may"'), DB::Raw('SUM(dmjun) as "jun"'), DB::Raw('SUM(dmjul) as "jul"'), DB::Raw('SUM(dmaug) as "aug"'), DB::Raw('SUM(dmsep) as "sep", SUM(dmoct) as "oct"'), DB::Raw('SUM(dmnov) as "nov"'), DB::Raw('SUM(dmdec) as "dec"'), DB::Raw('concat(chapter, " ", district) as description'))->groupby('rhq')->groupby('zone')->groupby('chapter')->groupby('district')->groupby('name');
            } else if (Session::get('gakkaiuserpositionlevel') == 'zone' ) {
                return $query->where('zone', Session::get('gakkaiuserzone'))->where('division', 'YW')->whereNotIn('district', array("-"))->select('name', 'rhq', 'zone', 'chapter', 'district', 'division', 'position', DB::Raw('SUM(dmjan) as "jan"'), DB::Raw('SUM(dmfeb) as "feb"'), DB::Raw('SUM(dmmar) as "mar"'), DB::Raw('SUM(dmapr) as "apr"'), DB::Raw('SUM(dmmay) as "may"'), DB::Raw('SUM(dmjun) as "jun"'), DB::Raw('SUM(dmjul) as "jul"'), DB::Raw('SUM(dmaug) as "aug"'), DB::Raw('SUM(dmsep) as "sep", SUM(dmoct) as "oct"'), DB::Raw('SUM(dmnov) as "nov"'), DB::Raw('SUM(dmdec) as "dec"'), DB::Raw('concat(chapter, " ", district) as description'))->groupby('rhq')->groupby('zone')->groupby('chapter')->groupby('district')->groupby('name');
            } else if (Session::get('gakkaiuserpositionlevel') == 'chapter' ) {
                return $query->where('chapter', Session::get('gakkaiuserchapter'))->where('division', 'YW')->whereNotIn('district', array("-"))->select('name', 'rhq', 'zone', 'chapter', 'district', 'division', 'position', DB::Raw('SUM(dmjan) as "jan"'), DB::Raw('SUM(dmfeb) as "feb"'), DB::Raw('SUM(dmmar) as "mar"'), DB::Raw('SUM(dmapr) as "apr"'), DB::Raw('SUM(dmmay) as "may"'), DB::Raw('SUM(dmjun) as "jun"'), DB::Raw('SUM(dmjul) as "jul"'), DB::Raw('SUM(dmaug) as "aug"'), DB::Raw('SUM(dmsep) as "sep", SUM(dmoct) as "oct"'), DB::Raw('SUM(dmnov) as "nov"'), DB::Raw('SUM(dmdec) as "dec"'), DB::Raw('concat(chapter, " ", district) as description'))->groupby('rhq')->groupby('zone')->groupby('chapter')->groupby('district')->groupby('name');
            } else if (Session::get('gakkaiuserpositionlevel') == 'district' ) {
                return $query->where('chapter', Session::get('gakkaiuserchapter'))->where('district', Session::get('gakkaiuserdistrict'))->where('division', 'YW')->whereNotIn('district', array("-"))->select('name', 'rhq', 'zone', 'chapter', 'district', 'division', 'position', DB::Raw('SUM(dmjan) as "jan"'), DB::Raw('SUM(dmfeb) as "feb"'), DB::Raw('SUM(dmmar) as "mar"'), DB::Raw('SUM(dmapr) as "apr"'), DB::Raw('SUM(dmmay) as "may"'), DB::Raw('SUM(dmjun) as "jun"'), DB::Raw('SUM(dmjul) as "jul"'), DB::Raw('SUM(dmaug) as "aug"'), DB::Raw('SUM(dmsep) as "sep", SUM(dmoct) as "oct"'), DB::Raw('SUM(dmnov) as "nov"'), DB::Raw('SUM(dmdec) as "dec"'), DB::Raw('concat(chapter, " ", district) as description'))->groupby('rhq')->groupby('zone')->groupby('chapter')->groupby('district')->groupby('name');
            }
        }
        elseif ( $divisiontype == 'Primary Division')
        {
            if (Session::get('gakkaiuserpositionlevel') == 'shq' ) {
                return $query->where('agegroup', '07 to 12')->whereNotIn('district', array("-"))->select('name', 'rhq', 'zone', 'chapter', 'district', 'division', 'position', DB::Raw('SUM(dmjan) as "jan"'), DB::Raw('SUM(dmfeb) as "feb"'), DB::Raw('SUM(dmmar) as "mar"'), DB::Raw('SUM(dmapr) as "apr"'), DB::Raw('SUM(dmmay) as "may"'), DB::Raw('SUM(dmjun) as "jun"'), DB::Raw('SUM(dmjul) as "jul"'), DB::Raw('SUM(dmaug) as "aug"'), DB::Raw('SUM(dmsep) as "sep", SUM(dmoct) as "oct"'), DB::Raw('SUM(dmnov) as "nov"'), DB::Raw('SUM(dmdec) as "dec"'), DB::Raw('concat(chapter, " ", district) as description'))->groupby('rhq')->groupby('zone')->groupby('chapter')->groupby('district')->groupby('name');
            } else if (Session::get('gakkaiuserpositionlevel') == 'rhq' ) {
                return $query->where('rhq', Session::get('gakkaiuserrhq'))->where('agegroup', '07 to 12')->whereNotIn('district', array("-"))->select('name', 'rhq', 'zone', 'chapter', 'district', 'division', 'position', DB::Raw('SUM(dmjan) as "jan"'), DB::Raw('SUM(dmfeb) as "feb"'), DB::Raw('SUM(dmmar) as "mar"'), DB::Raw('SUM(dmapr) as "apr"'), DB::Raw('SUM(dmmay) as "may"'), DB::Raw('SUM(dmjun) as "jun"'), DB::Raw('SUM(dmjul) as "jul"'), DB::Raw('SUM(dmaug) as "aug"'), DB::Raw('SUM(dmsep) as "sep", SUM(dmoct) as "oct"'), DB::Raw('SUM(dmnov) as "nov"'), DB::Raw('SUM(dmdec) as "dec"'), DB::Raw('concat(chapter, " ", district) as description'))->groupby('rhq')->groupby('zone')->groupby('chapter')->groupby('district')->groupby('name');
            } else if (Session::get('gakkaiuserpositionlevel') == 'zone' ) {
                return $query->where('zone', Session::get('gakkaiuserzone'))->where('agegroup', '07 to 12')->whereNotIn('district', array("-"))->select('name', 'rhq', 'zone', 'chapter', 'district', 'division', 'position', DB::Raw('SUM(dmjan) as "jan"'), DB::Raw('SUM(dmfeb) as "feb"'), DB::Raw('SUM(dmmar) as "mar"'), DB::Raw('SUM(dmapr) as "apr"'), DB::Raw('SUM(dmmay) as "may"'), DB::Raw('SUM(dmjun) as "jun"'), DB::Raw('SUM(dmjul) as "jul"'), DB::Raw('SUM(dmaug) as "aug"'), DB::Raw('SUM(dmsep) as "sep", SUM(dmoct) as "oct"'), DB::Raw('SUM(dmnov) as "nov"'), DB::Raw('SUM(dmdec) as "dec"'), DB::Raw('concat(chapter, " ", district) as description'))->groupby('rhq')->groupby('zone')->groupby('chapter')->groupby('district')->groupby('name');
            } else if (Session::get('gakkaiuserpositionlevel') == 'chapter' ) {
                return $query->where('chapter', Session::get('gakkaiuserchapter'))->where('agegroup', '07 to 12')->whereNotIn('district', array("-"))->select('name', 'rhq', 'zone', 'chapter', 'district', 'division', 'position', DB::Raw('SUM(dmjan) as "jan"'), DB::Raw('SUM(dmfeb) as "feb"'), DB::Raw('SUM(dmmar) as "mar"'), DB::Raw('SUM(dmapr) as "apr"'), DB::Raw('SUM(dmmay) as "may"'), DB::Raw('SUM(dmjun) as "jun"'), DB::Raw('SUM(dmjul) as "jul"'), DB::Raw('SUM(dmaug) as "aug"'), DB::Raw('SUM(dmsep) as "sep", SUM(dmoct) as "oct"'), DB::Raw('SUM(dmnov) as "nov"'), DB::Raw('SUM(dmdec) as "dec"'), DB::Raw('concat(chapter, " ", district) as description'))->groupby('rhq')->groupby('zone')->groupby('chapter')->groupby('district')->groupby('name');
            } else if (Session::get('gakkaiuserpositionlevel') == 'district' ) {
                return $query->where('chapter', Session::get('gakkaiuserchapter'))->where('district', Session::get('gakkaiuserdistrict'))->where('agegroup', '07 to 12')->whereNotIn('district', array("-"))->select('name', 'rhq', 'zone', 'chapter', 'district', 'division', 'position', DB::Raw('SUM(dmjan) as "jan"'), DB::Raw('SUM(dmfeb) as "feb"'), DB::Raw('SUM(dmmar) as "mar"'), DB::Raw('SUM(dmapr) as "apr"'), DB::Raw('SUM(dmmay) as "may"'), DB::Raw('SUM(dmjun) as "jun"'), DB::Raw('SUM(dmjul) as "jul"'), DB::Raw('SUM(dmaug) as "aug"'), DB::Raw('SUM(dmsep) as "sep", SUM(dmoct) as "oct"'), DB::Raw('SUM(dmnov) as "nov"'), DB::Raw('SUM(dmdec) as "dec"'), DB::Raw('concat(chapter, " ", district) as description'))->groupby('rhq')->groupby('zone')->groupby('chapter')->groupby('district')->groupby('name');
            }
        }
        elseif ( $divisiontype == 'Future Division')
        {
            if (Session::get('gakkaiuserpositionlevel') == 'shq' ) {
                return $query->where('agegroup', '13 to 16')->whereNotIn('district', array("-"))->select('name', 'rhq', 'zone', 'chapter', 'district', 'division', 'position', DB::Raw('SUM(dmjan) as "jan"'), DB::Raw('SUM(dmfeb) as "feb"'), DB::Raw('SUM(dmmar) as "mar"'), DB::Raw('SUM(dmapr) as "apr"'), DB::Raw('SUM(dmmay) as "may"'), DB::Raw('SUM(dmjun) as "jun"'), DB::Raw('SUM(dmjul) as "jul"'), DB::Raw('SUM(dmaug) as "aug"'), DB::Raw('SUM(dmsep) as "sep", SUM(dmoct) as "oct"'), DB::Raw('SUM(dmnov) as "nov"'), DB::Raw('SUM(dmdec) as "dec"'), DB::Raw('concat(chapter, " ", district) as description'))->groupby('rhq')->groupby('zone')->groupby('chapter')->groupby('district')->groupby('name');
            } else if (Session::get('gakkaiuserpositionlevel') == 'rhq' ) {
                return $query->where('rhq', Session::get('gakkaiuserrhq'))->where('agegroup', '13 to 16')->whereNotIn('district', array("-"))->select('name', 'rhq', 'zone', 'chapter', 'district', 'division', 'position', DB::Raw('SUM(dmjan) as "jan"'), DB::Raw('SUM(dmfeb) as "feb"'), DB::Raw('SUM(dmmar) as "mar"'), DB::Raw('SUM(dmapr) as "apr"'), DB::Raw('SUM(dmmay) as "may"'), DB::Raw('SUM(dmjun) as "jun"'), DB::Raw('SUM(dmjul) as "jul"'), DB::Raw('SUM(dmaug) as "aug"'), DB::Raw('SUM(dmsep) as "sep", SUM(dmoct) as "oct"'), DB::Raw('SUM(dmnov) as "nov"'), DB::Raw('SUM(dmdec) as "dec"'), DB::Raw('concat(chapter, " ", district) as description'))->groupby('rhq')->groupby('zone')->groupby('chapter')->groupby('district')->groupby('name');
            } else if (Session::get('gakkaiuserpositionlevel') == 'zone' ) {
                return $query->where('zone', Session::get('gakkaiuserzone'))->where('agegroup', '13 to 16')->whereNotIn('district', array("-"))->select('name', 'rhq', 'zone', 'chapter', 'district', 'division', 'position', DB::Raw('SUM(dmjan) as "jan"'), DB::Raw('SUM(dmfeb) as "feb"'), DB::Raw('SUM(dmmar) as "mar"'), DB::Raw('SUM(dmapr) as "apr"'), DB::Raw('SUM(dmmay) as "may"'), DB::Raw('SUM(dmjun) as "jun"'), DB::Raw('SUM(dmjul) as "jul"'), DB::Raw('SUM(dmaug) as "aug"'), DB::Raw('SUM(dmsep) as "sep", SUM(dmoct) as "oct"'), DB::Raw('SUM(dmnov) as "nov"'), DB::Raw('SUM(dmdec) as "dec"'), DB::Raw('concat(chapter, " ", district) as description'))->groupby('rhq')->groupby('zone')->groupby('chapter')->groupby('district')->groupby('name');
            } else if (Session::get('gakkaiuserpositionlevel') == 'chapter' ) {
                return $query->where('chapter', Session::get('gakkaiuserchapter'))->where('agegroup', '13 to 16')->whereNotIn('district', array("-"))->select('name', 'rhq', 'zone', 'chapter', 'district', 'division', 'position', DB::Raw('SUM(dmjan) as "jan"'), DB::Raw('SUM(dmfeb) as "feb"'), DB::Raw('SUM(dmmar) as "mar"'), DB::Raw('SUM(dmapr) as "apr"'), DB::Raw('SUM(dmmay) as "may"'), DB::Raw('SUM(dmjun) as "jun"'), DB::Raw('SUM(dmjul) as "jul"'), DB::Raw('SUM(dmaug) as "aug"'), DB::Raw('SUM(dmsep) as "sep", SUM(dmoct) as "oct"'), DB::Raw('SUM(dmnov) as "nov"'), DB::Raw('SUM(dmdec) as "dec"'), DB::Raw('concat(chapter, " ", district) as description'))->groupby('rhq')->groupby('zone')->groupby('chapter')->groupby('district')->groupby('name');
            } else if (Session::get('gakkaiuserpositionlevel') == 'district' ) {
                return $query->where('chapter', Session::get('gakkaiuserchapter'))->where('district', Session::get('gakkaiuserdistrict'))->where('agegroup', '13 to 16')->whereNotIn('district', array("-"))->select('name', 'rhq', 'zone', 'chapter', 'district', 'division', 'position', DB::Raw('SUM(dmjan) as "jan"'), DB::Raw('SUM(dmfeb) as "feb"'), DB::Raw('SUM(dmmar) as "mar"'), DB::Raw('SUM(dmapr) as "apr"'), DB::Raw('SUM(dmmay) as "may"'), DB::Raw('SUM(dmjun) as "jun"'), DB::Raw('SUM(dmjul) as "jul"'), DB::Raw('SUM(dmaug) as "aug"'), DB::Raw('SUM(dmsep) as "sep", SUM(dmoct) as "oct"'), DB::Raw('SUM(dmnov) as "nov"'), DB::Raw('SUM(dmdec) as "dec"'), DB::Raw('concat(chapter, " ", district) as description'))->groupby('rhq')->groupby('zone')->groupby('chapter')->groupby('district')->groupby('name');
            }
        }
        elseif ( $divisiontype == 'Student Division')
        {
            if (Session::get('gakkaiuserpositionlevel') == 'shq' ) {
                return $query->whereNotIn('district', array("-"))->select('name', 'rhq', 'zone', 'chapter', 'district', 'division', 'position', DB::Raw('SUM(dmjan) as "jan"'), DB::Raw('SUM(dmfeb) as "feb"'), DB::Raw('SUM(dmmar) as "mar"'), DB::Raw('SUM(dmapr) as "apr"'), DB::Raw('SUM(dmmay) as "may"'), DB::Raw('SUM(dmjun) as "jun"'), DB::Raw('SUM(dmjul) as "jul"'), DB::Raw('SUM(dmaug) as "aug"'), DB::Raw('SUM(dmsep) as "sep", SUM(dmoct) as "oct"'), DB::Raw('SUM(dmnov) as "nov"'), DB::Raw('SUM(dmdec) as "dec"'), DB::Raw('concat(chapter, " ", district) as description'))->groupby('rhq')->groupby('zone')->groupby('chapter')->groupby('district')->groupby('name');
            } else if (Session::get('gakkaiuserpositionlevel') == 'rhq' ) {
                return $query->where('rhq', Session::get('gakkaiuserrhq'))->where('studentdivision', '!=', '')->whereNotIn('district', array("-"))->select('name', 'rhq', 'zone', 'chapter', 'district', 'division', 'position', DB::Raw('SUM(dmjan) as "jan"'), DB::Raw('SUM(dmfeb) as "feb"'), DB::Raw('SUM(dmmar) as "mar"'), DB::Raw('SUM(dmapr) as "apr"'), DB::Raw('SUM(dmmay) as "may"'), DB::Raw('SUM(dmjun) as "jun"'), DB::Raw('SUM(dmjul) as "jul"'), DB::Raw('SUM(dmaug) as "aug"'), DB::Raw('SUM(dmsep) as "sep", SUM(dmoct) as "oct"'), DB::Raw('SUM(dmnov) as "nov"'), DB::Raw('SUM(dmdec) as "dec"'), DB::Raw('concat(chapter, " ", district) as description'))->groupby('rhq')->groupby('zone')->groupby('chapter')->groupby('district')->groupby('name');
            } else if (Session::get('gakkaiuserpositionlevel') == 'zone' ) {
                return $query->where('zone', Session::get('gakkaiuserzone'))->where('studentdivision', '!=', '')->whereNotIn('district', array("-"))->select('name', 'rhq', 'zone', 'chapter', 'district', 'division', 'position', DB::Raw('SUM(dmjan) as "jan"'), DB::Raw('SUM(dmfeb) as "feb"'), DB::Raw('SUM(dmmar) as "mar"'), DB::Raw('SUM(dmapr) as "apr"'), DB::Raw('SUM(dmmay) as "may"'), DB::Raw('SUM(dmjun) as "jun"'), DB::Raw('SUM(dmjul) as "jul"'), DB::Raw('SUM(dmaug) as "aug"'), DB::Raw('SUM(dmsep) as "sep", SUM(dmoct) as "oct"'), DB::Raw('SUM(dmnov) as "nov"'), DB::Raw('SUM(dmdec) as "dec"'), DB::Raw('concat(chapter, " ", district) as description'))->groupby('rhq')->groupby('zone')->groupby('chapter')->groupby('district')->groupby('name');
            } else if (Session::get('gakkaiuserpositionlevel') == 'chapter' ) {
                return $query->where('chapter', Session::get('gakkaiuserchapter'))->where('studentdivision', '!=', '')->whereNotIn('district', array("-"))->select('name', 'rhq', 'zone', 'chapter', 'district', 'division', 'position', DB::Raw('SUM(dmjan) as "jan"'), DB::Raw('SUM(dmfeb) as "feb"'), DB::Raw('SUM(dmmar) as "mar"'), DB::Raw('SUM(dmapr) as "apr"'), DB::Raw('SUM(dmmay) as "may"'), DB::Raw('SUM(dmjun) as "jun"'), DB::Raw('SUM(dmjul) as "jul"'), DB::Raw('SUM(dmaug) as "aug"'), DB::Raw('SUM(dmsep) as "sep", SUM(dmoct) as "oct"'), DB::Raw('SUM(dmnov) as "nov"'), DB::Raw('SUM(dmdec) as "dec"'), DB::Raw('concat(chapter, " ", district) as description'))->groupby('rhq')->groupby('zone')->groupby('chapter')->groupby('district')->groupby('name');
            } else if (Session::get('gakkaiuserpositionlevel') == 'district' ) {
                return $query->where('chapter', Session::get('gakkaiuserchapter'))->where('district', Session::get('gakkaiuserdistrict'))->where('studentdivision', '!=', '')->whereNotIn('district', array("-"))->select('name', 'rhq', 'zone', 'chapter', 'district', 'division', 'position', DB::Raw('SUM(dmjan) as "jan"'), DB::Raw('SUM(dmfeb) as "feb"'), DB::Raw('SUM(dmmar) as "mar"'), DB::Raw('SUM(dmapr) as "apr"'), DB::Raw('SUM(dmmay) as "may"'), DB::Raw('SUM(dmjun) as "jun"'), DB::Raw('SUM(dmjul) as "jul"'), DB::Raw('SUM(dmaug) as "aug"'), DB::Raw('SUM(dmsep) as "sep", SUM(dmoct) as "oct"'), DB::Raw('SUM(dmnov) as "nov"'), DB::Raw('SUM(dmdec) as "dec"'), DB::Raw('concat(chapter, " ", district) as description'))->groupby('rhq')->groupby('zone')->groupby('chapter')->groupby('district')->groupby('name');
            }
        }
        elseif ( $divisiontype == 'Adult Division')
        {
            if (Session::get('gakkaiuserpositionlevel') == 'shq' ) {
                return $query->whereIn('division', array('MD', 'WD'))->whereNotIn('district', array("-"))->select('name', 'rhq', 'zone', 'chapter', 'district', 'division', 'position', DB::Raw('SUM(dmjan) as "jan"'), DB::Raw('SUM(dmfeb) as "feb"'), DB::Raw('SUM(dmmar) as "mar"'), DB::Raw('SUM(dmapr) as "apr"'), DB::Raw('SUM(dmmay) as "may"'), DB::Raw('SUM(dmjun) as "jun"'), DB::Raw('SUM(dmjul) as "jul"'), DB::Raw('SUM(dmaug) as "aug"'), DB::Raw('SUM(dmsep) as "sep", SUM(dmoct) as "oct"'), DB::Raw('SUM(dmnov) as "nov"'), DB::Raw('SUM(dmdec) as "dec"'), DB::Raw('concat(chapter, " ", district) as description'))->groupby('rhq')->groupby('zone')->groupby('chapter')->groupby('district')->groupby('name');
            } else if (Session::get('gakkaiuserpositionlevel') == 'rhq' ) {
                return $query->where('rhq', Session::get('gakkaiuserrhq'))->whereIn('division', array('MD', 'WD'))->whereNotIn('district', array("-"))->select('name', 'rhq', 'zone', 'chapter', 'district', 'division', 'position', DB::Raw('SUM(dmjan) as "jan"'), DB::Raw('SUM(dmfeb) as "feb"'), DB::Raw('SUM(dmmar) as "mar"'), DB::Raw('SUM(dmapr) as "apr"'), DB::Raw('SUM(dmmay) as "may"'), DB::Raw('SUM(dmjun) as "jun"'), DB::Raw('SUM(dmjul) as "jul"'), DB::Raw('SUM(dmaug) as "aug"'), DB::Raw('SUM(dmsep) as "sep", SUM(dmoct) as "oct"'), DB::Raw('SUM(dmnov) as "nov"'), DB::Raw('SUM(dmdec) as "dec"'), DB::Raw('concat(chapter, " ", district) as description'))->groupby('rhq')->groupby('zone')->groupby('chapter')->groupby('district')->groupby('name');
            } else if (Session::get('gakkaiuserpositionlevel') == 'zone' ) {
                return $query->where('zone', Session::get('gakkaiuserzone'))->whereIn('division', array('MD', 'WD'))->whereNotIn('district', array("-"))->select('name', 'rhq', 'zone', 'chapter', 'district', 'division', 'position', DB::Raw('SUM(dmjan) as "jan"'), DB::Raw('SUM(dmfeb) as "feb"'), DB::Raw('SUM(dmmar) as "mar"'), DB::Raw('SUM(dmapr) as "apr"'), DB::Raw('SUM(dmmay) as "may"'), DB::Raw('SUM(dmjun) as "jun"'), DB::Raw('SUM(dmjul) as "jul"'), DB::Raw('SUM(dmaug) as "aug"'), DB::Raw('SUM(dmsep) as "sep", SUM(dmoct) as "oct"'), DB::Raw('SUM(dmnov) as "nov"'), DB::Raw('SUM(dmdec) as "dec"'), DB::Raw('concat(chapter, " ", district) as description'))->groupby('rhq')->groupby('zone')->groupby('chapter')->groupby('district')->groupby('name');
            } else if (Session::get('gakkaiuserpositionlevel') == 'chapter' ) {
                return $query->where('chapter', Session::get('gakkaiuserchapter'))->whereIn('division', array('MD', 'WD'))->whereNotIn('district', array("-"))->select('name', 'rhq', 'zone', 'chapter', 'district', 'division', 'position', DB::Raw('SUM(dmjan) as "jan"'), DB::Raw('SUM(dmfeb) as "feb"'), DB::Raw('SUM(dmmar) as "mar"'), DB::Raw('SUM(dmapr) as "apr"'), DB::Raw('SUM(dmmay) as "may"'), DB::Raw('SUM(dmjun) as "jun"'), DB::Raw('SUM(dmjul) as "jul"'), DB::Raw('SUM(dmaug) as "aug"'), DB::Raw('SUM(dmsep) as "sep", SUM(dmoct) as "oct"'), DB::Raw('SUM(dmnov) as "nov"'), DB::Raw('SUM(dmdec) as "dec"'), DB::Raw('concat(chapter, " ", district) as description'))->groupby('rhq')->groupby('zone')->groupby('chapter')->groupby('district')->groupby('name');
            } else if (Session::get('gakkaiuserpositionlevel') == 'district' ) {
                return $query->where('chapter', Session::get('gakkaiuserchapter'))->where('district', Session::get('gakkaiuserdistrict'))->whereIn('division', array('MD', 'WD'))->whereNotIn('district', array("-"))->select('name', 'rhq', 'zone', 'chapter', 'district', 'division', 'position', DB::Raw('SUM(dmjan) as "jan"'), DB::Raw('SUM(dmfeb) as "feb"'), DB::Raw('SUM(dmmar) as "mar"'), DB::Raw('SUM(dmapr) as "apr"'), DB::Raw('SUM(dmmay) as "may"'), DB::Raw('SUM(dmjun) as "jun"'), DB::Raw('SUM(dmjul) as "jul"'), DB::Raw('SUM(dmaug) as "aug"'), DB::Raw('SUM(dmsep) as "sep", SUM(dmoct) as "oct"'), DB::Raw('SUM(dmnov) as "nov"'), DB::Raw('SUM(dmdec) as "dec"'), DB::Raw('concat(chapter, " ", district) as description'))->groupby('rhq')->groupby('zone')->groupby('chapter')->groupby('district')->groupby('name');
            }
        }
        elseif ( $divisiontype == 'Youth Division')
        {
            if (Session::get('gakkaiuserpositionlevel') == 'shq' ) {
                return $query->whereIn('division', array('YM', 'YW'))->whereNotIn('district', array("-"))->select('name', 'rhq', 'zone', 'chapter', 'district', 'division', 'position', DB::Raw('SUM(dmjan) as "jan"'), DB::Raw('SUM(dmfeb) as "feb"'), DB::Raw('SUM(dmmar) as "mar"'), DB::Raw('SUM(dmapr) as "apr"'), DB::Raw('SUM(dmmay) as "may"'), DB::Raw('SUM(dmjun) as "jun"'), DB::Raw('SUM(dmjul) as "jul"'), DB::Raw('SUM(dmaug) as "aug"'), DB::Raw('SUM(dmsep) as "sep", SUM(dmoct) as "oct"'), DB::Raw('SUM(dmnov) as "nov"'), DB::Raw('SUM(dmdec) as "dec"'), DB::Raw('concat(chapter, " ", district) as description'))->groupby('rhq')->groupby('zone')->groupby('chapter')->groupby('district')->groupby('name');
            } else if (Session::get('gakkaiuserpositionlevel') == 'rhq' ) {
                return $query->where('rhq', Session::get('gakkaiuserrhq'))->whereIn('division', array('YM', 'YW'))->whereNotIn('district', array("-"))->select('name', 'rhq', 'zone', 'chapter', 'district', 'division', 'position', DB::Raw('SUM(dmjan) as "jan"'), DB::Raw('SUM(dmfeb) as "feb"'), DB::Raw('SUM(dmmar) as "mar"'), DB::Raw('SUM(dmapr) as "apr"'), DB::Raw('SUM(dmmay) as "may"'), DB::Raw('SUM(dmjun) as "jun"'), DB::Raw('SUM(dmjul) as "jul"'), DB::Raw('SUM(dmaug) as "aug"'), DB::Raw('SUM(dmsep) as "sep", SUM(dmoct) as "oct"'), DB::Raw('SUM(dmnov) as "nov"'), DB::Raw('SUM(dmdec) as "dec"'), DB::Raw('concat(chapter, " ", district) as description'))->groupby('rhq')->groupby('zone')->groupby('chapter')->groupby('district')->groupby('name');
            } else if (Session::get('gakkaiuserpositionlevel') == 'zone' ) {
                return $query->where('zone', Session::get('gakkaiuserzone'))->whereIn('division', array('YM', 'YW'))->whereNotIn('district', array("-"))->select('name', 'rhq', 'zone', 'chapter', 'district', 'division', 'position', DB::Raw('SUM(dmjan) as "jan"'), DB::Raw('SUM(dmfeb) as "feb"'), DB::Raw('SUM(dmmar) as "mar"'), DB::Raw('SUM(dmapr) as "apr"'), DB::Raw('SUM(dmmay) as "may"'), DB::Raw('SUM(dmjun) as "jun"'), DB::Raw('SUM(dmjul) as "jul"'), DB::Raw('SUM(dmaug) as "aug"'), DB::Raw('SUM(dmsep) as "sep", SUM(dmoct) as "oct"'), DB::Raw('SUM(dmnov) as "nov"'), DB::Raw('SUM(dmdec) as "dec"'), DB::Raw('concat(chapter, " ", district) as description'))->groupby('rhq')->groupby('zone')->groupby('chapter')->groupby('district')->groupby('name');
            } else if (Session::get('gakkaiuserpositionlevel') == 'chapter' ) {
                return $query->where('chapter', Session::get('gakkaiuserchapter'))->whereIn('division', array('YM', 'YW'))->whereNotIn('district', array("-"))->select('name', 'rhq', 'zone', 'chapter', 'district', 'division', 'position', DB::Raw('SUM(dmjan) as "jan"'), DB::Raw('SUM(dmfeb) as "feb"'), DB::Raw('SUM(dmmar) as "mar"'), DB::Raw('SUM(dmapr) as "apr"'), DB::Raw('SUM(dmmay) as "may"'), DB::Raw('SUM(dmjun) as "jun"'), DB::Raw('SUM(dmjul) as "jul"'), DB::Raw('SUM(dmaug) as "aug"'), DB::Raw('SUM(dmsep) as "sep", SUM(dmoct) as "oct"'), DB::Raw('SUM(dmnov) as "nov"'), DB::Raw('SUM(dmdec) as "dec"'), DB::Raw('concat(chapter, " ", district) as description'))->groupby('rhq')->groupby('zone')->groupby('chapter')->groupby('district')->groupby('name');
            } else if (Session::get('gakkaiuserpositionlevel') == 'district' ) {
                return $query->where('chapter', Session::get('gakkaiuserchapter'))->where('district', Session::get('gakkaiuserdistrict'))->whereIn('division', array('YM', 'YW'))->whereNotIn('district', array("-"))->select('name', 'rhq', 'zone', 'chapter', 'district', 'division', 'position', DB::Raw('SUM(dmjan) as "jan"'), DB::Raw('SUM(dmfeb) as "feb"'), DB::Raw('SUM(dmmar) as "mar"'), DB::Raw('SUM(dmapr) as "apr"'), DB::Raw('SUM(dmmay) as "may"'), DB::Raw('SUM(dmjun) as "jun"'), DB::Raw('SUM(dmjul) as "jul"'), DB::Raw('SUM(dmaug) as "aug"'), DB::Raw('SUM(dmsep) as "sep", SUM(dmoct) as "oct"'), DB::Raw('SUM(dmnov) as "nov"'), DB::Raw('SUM(dmdec) as "dec"'), DB::Raw('concat(chapter, " ", district) as description'))->groupby('rhq')->groupby('zone')->groupby('chapter')->groupby('district')->groupby('name');
            }
        }
    }

    public function scopePUBCLRHQStats($query, $value, $divisiontype)
    {
        if ( $divisiontype == 'All' or $divisiontype == "4 Division")
        {
            return $query->whereIn('rhq', array('', 'H0', 'H1', 'H2', 'H3', 'H4', 'H5', 'H6', 'H7', 'H8', 'H9'))->select('rhq', DB::Raw('SUM(pubcljan) as "jan"'), DB::Raw('SUM(pubclfeb) as "feb"'), DB::Raw('SUM(pubclmar) as "mar"'), DB::Raw('SUM(pubclapr) as "apr"'), DB::Raw('SUM(pubclmay) as "may"'), DB::Raw('SUM(pubcljun) as "jun"'), DB::Raw('SUM(pubcljul) as "jul"'), DB::Raw('SUM(pubclaug) as "aug"'), DB::Raw('SUM(pubclsep) as "sep", SUM(pubcloct) as "oct"'), DB::Raw('SUM(pubclnov) as "nov"'), DB::Raw('SUM(pubcldec) as "dec"'), DB::Raw('concat(chapter, " ", district) as description'))->groupby('rhq');
        }
        elseif ( $divisiontype == 'MD')
        {
            return $query->whereIn('rhq', array('', 'H0', 'H1', 'H2', 'H3', 'H4', 'H5', 'H6', 'H7', 'H8', 'H9'))->where('division', 'MD')->select('rhq', DB::Raw('SUM(pubcljan) as "jan"'), DB::Raw('SUM(pubclfeb) as "feb"'), DB::Raw('SUM(pubclmar) as "mar"'), DB::Raw('SUM(pubclapr) as "apr"'), DB::Raw('SUM(pubclmay) as "may"'), DB::Raw('SUM(pubcljun) as "jun"'), DB::Raw('SUM(pubcljul) as "jul"'), DB::Raw('SUM(pubclaug) as "aug"'), DB::Raw('SUM(pubclsep) as "sep", SUM(pubcloct) as "oct"'), DB::Raw('SUM(pubclnov) as "nov"'), DB::Raw('SUM(pubcldec) as "dec"'), DB::Raw('concat(chapter, " ", district) as description'))->groupby('rhq');
        }
        elseif ( $divisiontype == 'WD')
        {
            return $query->whereIn('rhq', array('', 'H0', 'H1', 'H2', 'H3', 'H4', 'H5', 'H6', 'H7', 'H8', 'H9'))->where('division', 'WD')->select('rhq', DB::Raw('SUM(pubcljan) as "jan"'), DB::Raw('SUM(pubclfeb) as "feb"'), DB::Raw('SUM(pubclmar) as "mar"'), DB::Raw('SUM(pubclapr) as "apr"'), DB::Raw('SUM(pubclmay) as "may"'), DB::Raw('SUM(pubcljun) as "jun"'), DB::Raw('SUM(pubcljul) as "jul"'), DB::Raw('SUM(pubclaug) as "aug"'), DB::Raw('SUM(pubclsep) as "sep", SUM(pubcloct) as "oct"'), DB::Raw('SUM(pubclnov) as "nov"'), DB::Raw('SUM(pubcldec) as "dec"'), DB::Raw('concat(chapter, " ", district) as description'))->groupby('rhq');
        }
        elseif ( $divisiontype == 'YMD')
        {
            return $query->whereIn('rhq', array('', 'H0', 'H1', 'H2', 'H3', 'H4', 'H5', 'H6', 'H7', 'H8', 'H9'))->where('division', 'YM')->select('rhq', DB::Raw('SUM(pubcljan) as "jan"'), DB::Raw('SUM(pubclfeb) as "feb"'), DB::Raw('SUM(pubclmar) as "mar"'), DB::Raw('SUM(pubclapr) as "apr"'), DB::Raw('SUM(pubclmay) as "may"'), DB::Raw('SUM(pubcljun) as "jun"'), DB::Raw('SUM(pubcljul) as "jul"'), DB::Raw('SUM(pubclaug) as "aug"'), DB::Raw('SUM(pubclsep) as "sep", SUM(pubcloct) as "oct"'), DB::Raw('SUM(pubclnov) as "nov"'), DB::Raw('SUM(pubcldec) as "dec"'), DB::Raw('concat(chapter, " ", district) as description'))->groupby('rhq');
        }
        elseif ( $divisiontype == 'YWD')
        {
            return $query->whereIn('rhq', array('', 'H0', 'H1', 'H2', 'H3', 'H4', 'H5', 'H6', 'H7', 'H8', 'H9'))->where('division', 'YW')->select('rhq', DB::Raw('SUM(pubcljan) as "jan"'), DB::Raw('SUM(pubclfeb) as "feb"'), DB::Raw('SUM(pubclmar) as "mar"'), DB::Raw('SUM(pubclapr) as "apr"'), DB::Raw('SUM(pubclmay) as "may"'), DB::Raw('SUM(pubcljun) as "jun"'), DB::Raw('SUM(pubcljul) as "jul"'), DB::Raw('SUM(pubclaug) as "aug"'), DB::Raw('SUM(pubclsep) as "sep", SUM(pubcloct) as "oct"'), DB::Raw('SUM(pubclnov) as "nov"'), DB::Raw('SUM(pubcldec) as "dec"'), DB::Raw('concat(chapter, " ", district) as description'))->groupby('rhq');
        }
        elseif ( $divisiontype == 'Primary Division')
        {
            return $query->whereIn('rhq', array('', 'H0', 'H1', 'H2', 'H3', 'H4', 'H5', 'H6', 'H7', 'H8', 'H9'))->where('agegroup', '07 to 12')->select('rhq', DB::Raw('SUM(pubcljan) as "jan"'), DB::Raw('SUM(pubclfeb) as "feb"'), DB::Raw('SUM(pubclmar) as "mar"'), DB::Raw('SUM(pubclapr) as "apr"'), DB::Raw('SUM(pubclmay) as "may"'), DB::Raw('SUM(pubcljun) as "jun"'), DB::Raw('SUM(pubcljul) as "jul"'), DB::Raw('SUM(pubclaug) as "aug"'), DB::Raw('SUM(pubclsep) as "sep", SUM(pubcloct) as "oct"'), DB::Raw('SUM(pubclnov) as "nov"'), DB::Raw('SUM(pubcldec) as "dec"'), DB::Raw('concat(chapter, " ", district) as description'))->groupby('rhq');
        }
        elseif ( $divisiontype == 'Future Division')
        {
            return $query->whereIn('rhq', array('', 'H0', 'H1', 'H2', 'H3', 'H4', 'H5', 'H6', 'H7', 'H8', 'H9'))->where('agegroup', '13 to 16')->select('rhq', DB::Raw('SUM(pubcljan) as "jan"'), DB::Raw('SUM(pubclfeb) as "feb"'), DB::Raw('SUM(pubclmar) as "mar"'), DB::Raw('SUM(pubclapr) as "apr"'), DB::Raw('SUM(pubclmay) as "may"'), DB::Raw('SUM(pubcljun) as "jun"'), DB::Raw('SUM(pubcljul) as "jul"'), DB::Raw('SUM(pubclaug) as "aug"'), DB::Raw('SUM(pubclsep) as "sep", SUM(pubcloct) as "oct"'), DB::Raw('SUM(pubclnov) as "nov"'), DB::Raw('SUM(pubcldec) as "dec"'), DB::Raw('concat(chapter, " ", district) as description'))->groupby('rhq');
        }
        elseif ( $divisiontype == 'Student Division')
        {
            return $query->whereIn('rhq', array('', 'H0', 'H1', 'H2', 'H3', 'H4', 'H5', 'H6', 'H7', 'H8', 'H9'))->where('studentdivision', '!=', '')->select('rhq', DB::Raw('SUM(pubcljan) as "jan"'), DB::Raw('SUM(pubclfeb) as "feb"'), DB::Raw('SUM(pubclmar) as "mar"'), DB::Raw('SUM(pubclapr) as "apr"'), DB::Raw('SUM(pubclmay) as "may"'), DB::Raw('SUM(pubcljun) as "jun"'), DB::Raw('SUM(pubcljul) as "jul"'), DB::Raw('SUM(pubclaug) as "aug"'), DB::Raw('SUM(pubclsep) as "sep", SUM(pubcloct) as "oct"'), DB::Raw('SUM(pubclnov) as "nov"'), DB::Raw('SUM(pubcldec) as "dec"'), DB::Raw('concat(chapter, " ", district) as description'))->groupby('rhq');
        }
        elseif ( $divisiontype == 'Adult Division')
        {
            return $query->whereIn('rhq', array('', 'H0', 'H1', 'H2', 'H3', 'H4', 'H5', 'H6', 'H7', 'H8', 'H9'))->whereIn('division', array('MD', 'WD'))->select('rhq', DB::Raw('SUM(pubcljan) as "jan"'), DB::Raw('SUM(pubclfeb) as "feb"'), DB::Raw('SUM(pubclmar) as "mar"'), DB::Raw('SUM(pubclapr) as "apr"'), DB::Raw('SUM(pubclmay) as "may"'), DB::Raw('SUM(pubcljun) as "jun"'), DB::Raw('SUM(pubcljul) as "jul"'), DB::Raw('SUM(pubclaug) as "aug"'), DB::Raw('SUM(pubclsep) as "sep", SUM(pubcloct) as "oct"'), DB::Raw('SUM(pubclnov) as "nov"'), DB::Raw('SUM(pubcldec) as "dec"'), DB::Raw('concat(chapter, " ", district) as description'))->groupby('rhq');
        }
        elseif ( $divisiontype == 'Youth Division')
        {
            return $query->whereIn('rhq', array('', 'H0', 'H1', 'H2', 'H3', 'H4', 'H5', 'H6', 'H7', 'H8', 'H9'))->whereIn('division', array('YM', 'YW'))->select('rhq', DB::Raw('SUM(pubcljan) as "jan"'), DB::Raw('SUM(pubclfeb) as "feb"'), DB::Raw('SUM(pubclmar) as "mar"'), DB::Raw('SUM(pubclapr) as "apr"'), DB::Raw('SUM(pubclmay) as "may"'), DB::Raw('SUM(pubcljun) as "jun"'), DB::Raw('SUM(pubcljul) as "jul"'), DB::Raw('SUM(pubclaug) as "aug"'), DB::Raw('SUM(pubclsep) as "sep", SUM(pubcloct) as "oct"'), DB::Raw('SUM(pubclnov) as "nov"'), DB::Raw('SUM(pubcldec) as "dec"'), DB::Raw('concat(chapter, " ", district) as description'))->groupby('rhq');
        }
    }

    public function scopePUBSTRHQStats($query, $value, $divisiontype)
    {
        if ( $divisiontype == 'All' or $divisiontype == "4 Division")
        {
            return $query->whereIn('rhq', array('', 'H0', 'H1', 'H2', 'H3', 'H4', 'H5', 'H6', 'H7', 'H8', 'H9'))->select('rhq', DB::Raw('SUM(pubstjan) as "jan"'), DB::Raw('SUM(pubstfeb) as "feb"'), DB::Raw('SUM(pubstmar) as "mar"'), DB::Raw('SUM(pubstapr) as "apr"'), DB::Raw('SUM(pubstmay) as "may"'), DB::Raw('SUM(pubstjun) as "jun"'), DB::Raw('SUM(pubstjul) as "jul"'), DB::Raw('SUM(pubstaug) as "aug"'), DB::Raw('SUM(pubstsep) as "sep", SUM(pubstoct) as "oct"'), DB::Raw('SUM(pubstnov) as "nov"'), DB::Raw('SUM(pubstdec) as "dec"'), DB::Raw('concat(chapter, " ", district) as description'))->groupby('rhq');
        }
        elseif ( $divisiontype == 'MD')
        {
            return $query->whereIn('rhq', array('', 'H0', 'H1', 'H2', 'H3', 'H4', 'H5', 'H6', 'H7', 'H8', 'H9'))->where('division', 'MD')->select('rhq', DB::Raw('SUM(pubstjan) as "jan"'), DB::Raw('SUM(pubstfeb) as "feb"'), DB::Raw('SUM(pubstmar) as "mar"'), DB::Raw('SUM(pubstapr) as "apr"'), DB::Raw('SUM(pubstmay) as "may"'), DB::Raw('SUM(pubstjun) as "jun"'), DB::Raw('SUM(pubstjul) as "jul"'), DB::Raw('SUM(pubstaug) as "aug"'), DB::Raw('SUM(pubstsep) as "sep", SUM(pubstoct) as "oct"'), DB::Raw('SUM(pubstnov) as "nov"'), DB::Raw('SUM(pubstdec) as "dec"'), DB::Raw('concat(chapter, " ", district) as description'))->groupby('rhq');
        }
        elseif ( $divisiontype == 'WD')
        {
            return $query->whereIn('rhq', array('', 'H0', 'H1', 'H2', 'H3', 'H4', 'H5', 'H6', 'H7', 'H8', 'H9'))->where('division', 'WD')->select('rhq', DB::Raw('SUM(pubstjan) as "jan"'), DB::Raw('SUM(pubstfeb) as "feb"'), DB::Raw('SUM(pubstmar) as "mar"'), DB::Raw('SUM(pubstapr) as "apr"'), DB::Raw('SUM(pubstmay) as "may"'), DB::Raw('SUM(pubstjun) as "jun"'), DB::Raw('SUM(pubstjul) as "jul"'), DB::Raw('SUM(pubstaug) as "aug"'), DB::Raw('SUM(pubstsep) as "sep", SUM(pubstoct) as "oct"'), DB::Raw('SUM(pubstnov) as "nov"'), DB::Raw('SUM(pubstdec) as "dec"'), DB::Raw('concat(chapter, " ", district) as description'))->groupby('rhq');
        }
        elseif ( $divisiontype == 'YMD')
        {
            return $query->whereIn('rhq', array('', 'H0', 'H1', 'H2', 'H3', 'H4', 'H5', 'H6', 'H7', 'H8', 'H9'))->where('division', 'YM')->select('rhq', DB::Raw('SUM(pubstjan) as "jan"'), DB::Raw('SUM(pubstfeb) as "feb"'), DB::Raw('SUM(pubstmar) as "mar"'), DB::Raw('SUM(pubstapr) as "apr"'), DB::Raw('SUM(pubstmay) as "may"'), DB::Raw('SUM(pubstjun) as "jun"'), DB::Raw('SUM(pubstjul) as "jul"'), DB::Raw('SUM(pubstaug) as "aug"'), DB::Raw('SUM(pubstsep) as "sep", SUM(pubstoct) as "oct"'), DB::Raw('SUM(pubstnov) as "nov"'), DB::Raw('SUM(pubstdec) as "dec"'), DB::Raw('concat(chapter, " ", district) as description'))->groupby('rhq');
        }
        elseif ( $divisiontype == 'YWD')
        {
            return $query->whereIn('rhq', array('', 'H0', 'H1', 'H2', 'H3', 'H4', 'H5', 'H6', 'H7', 'H8', 'H9'))->where('division', 'YW')->select('rhq', DB::Raw('SUM(pubstjan) as "jan"'), DB::Raw('SUM(pubstfeb) as "feb"'), DB::Raw('SUM(pubstmar) as "mar"'), DB::Raw('SUM(pubstapr) as "apr"'), DB::Raw('SUM(pubstmay) as "may"'), DB::Raw('SUM(pubstjun) as "jun"'), DB::Raw('SUM(pubstjul) as "jul"'), DB::Raw('SUM(pubstaug) as "aug"'), DB::Raw('SUM(pubstsep) as "sep", SUM(pubstoct) as "oct"'), DB::Raw('SUM(pubstnov) as "nov"'), DB::Raw('SUM(pubstdec) as "dec"'), DB::Raw('concat(chapter, " ", district) as description'))->groupby('rhq');
        }
        elseif ( $divisiontype == 'Primary Division')
        {
            return $query->whereIn('rhq', array('', 'H0', 'H1', 'H2', 'H3', 'H4', 'H5', 'H6', 'H7', 'H8', 'H9'))->where('agegroup', '07 to 12')->select('rhq', DB::Raw('SUM(pubstjan) as "jan"'), DB::Raw('SUM(pubstfeb) as "feb"'), DB::Raw('SUM(pubstmar) as "mar"'), DB::Raw('SUM(pubstapr) as "apr"'), DB::Raw('SUM(pubstmay) as "may"'), DB::Raw('SUM(pubstjun) as "jun"'), DB::Raw('SUM(pubstjul) as "jul"'), DB::Raw('SUM(pubstaug) as "aug"'), DB::Raw('SUM(pubstsep) as "sep", SUM(pubstoct) as "oct"'), DB::Raw('SUM(pubstnov) as "nov"'), DB::Raw('SUM(pubstdec) as "dec"'), DB::Raw('concat(chapter, " ", district) as description'))->groupby('rhq');
        }
        elseif ( $divisiontype == 'Future Division')
        {
            return $query->whereIn('rhq', array('', 'H0', 'H1', 'H2', 'H3', 'H4', 'H5', 'H6', 'H7', 'H8', 'H9'))->where('agegroup', '13 to 16')->select('rhq', DB::Raw('SUM(pubstjan) as "jan"'), DB::Raw('SUM(pubstfeb) as "feb"'), DB::Raw('SUM(pubstmar) as "mar"'), DB::Raw('SUM(pubstapr) as "apr"'), DB::Raw('SUM(pubstmay) as "may"'), DB::Raw('SUM(pubstjun) as "jun"'), DB::Raw('SUM(pubstjul) as "jul"'), DB::Raw('SUM(pubstaug) as "aug"'), DB::Raw('SUM(pubstsep) as "sep", SUM(pubstoct) as "oct"'), DB::Raw('SUM(pubstnov) as "nov"'), DB::Raw('SUM(pubstdec) as "dec"'), DB::Raw('concat(chapter, " ", district) as description'))->groupby('rhq');
        }
        elseif ( $divisiontype == 'Student Division')
        {
            return $query->whereIn('rhq', array('', 'H0', 'H1', 'H2', 'H3', 'H4', 'H5', 'H6', 'H7', 'H8', 'H9'))->where('studentdivision', '!=', '')->select('rhq', DB::Raw('SUM(pubstjan) as "jan"'), DB::Raw('SUM(pubstfeb) as "feb"'), DB::Raw('SUM(pubstmar) as "mar"'), DB::Raw('SUM(pubstapr) as "apr"'), DB::Raw('SUM(pubstmay) as "may"'), DB::Raw('SUM(pubstjun) as "jun"'), DB::Raw('SUM(pubstjul) as "jul"'), DB::Raw('SUM(pubstaug) as "aug"'), DB::Raw('SUM(pubstsep) as "sep", SUM(pubstoct) as "oct"'), DB::Raw('SUM(pubstnov) as "nov"'), DB::Raw('SUM(pubstdec) as "dec"'), DB::Raw('concat(chapter, " ", district) as description'))->groupby('rhq');
        }
        elseif ( $divisiontype == 'Adult Division')
        {
            return $query->whereIn('rhq', array('', 'H0', 'H1', 'H2', 'H3', 'H4', 'H5', 'H6', 'H7', 'H8', 'H9'))->whereIn('division', array('MD', 'WD'))->select('rhq', DB::Raw('SUM(pubstjan) as "jan"'), DB::Raw('SUM(pubstfeb) as "feb"'), DB::Raw('SUM(pubstmar) as "mar"'), DB::Raw('SUM(pubstapr) as "apr"'), DB::Raw('SUM(pubstmay) as "may"'), DB::Raw('SUM(pubstjun) as "jun"'), DB::Raw('SUM(pubstjul) as "jul"'), DB::Raw('SUM(pubstaug) as "aug"'), DB::Raw('SUM(pubstsep) as "sep", SUM(pubstoct) as "oct"'), DB::Raw('SUM(pubstnov) as "nov"'), DB::Raw('SUM(pubstdec) as "dec"'), DB::Raw('concat(chapter, " ", district) as description'))->groupby('rhq');
        }
        elseif ( $divisiontype == 'Youth Division')
        {
            return $query->whereIn('rhq', array('', 'H0', 'H1', 'H2', 'H3', 'H4', 'H5', 'H6', 'H7', 'H8', 'H9'))->whereIn('division', array('YM', 'YW'))->select('rhq', DB::Raw('SUM(pubstjan) as "jan"'), DB::Raw('SUM(pubstfeb) as "feb"'), DB::Raw('SUM(pubstmar) as "mar"'), DB::Raw('SUM(pubstapr) as "apr"'), DB::Raw('SUM(pubstmay) as "may"'), DB::Raw('SUM(pubstjun) as "jun"'), DB::Raw('SUM(pubstjul) as "jul"'), DB::Raw('SUM(pubstaug) as "aug"'), DB::Raw('SUM(pubstsep) as "sep", SUM(pubstoct) as "oct"'), DB::Raw('SUM(pubstnov) as "nov"'), DB::Raw('SUM(pubstdec) as "dec"'), DB::Raw('concat(chapter, " ", district) as description'))->groupby('rhq');
        }
    }
    
    public function scopePUBCLAgeGroupStats($query, $value, $divisiontype)
    {
        if ( $divisiontype == 'All' or $divisiontype == "4 Division")
        {
            return $query->select('agegroup', DB::Raw('SUM(pubcljan) as "jan"'), DB::Raw('SUM(pubclfeb) as "feb"'), DB::Raw('SUM(pubclmar) as "mar"'), DB::Raw('SUM(pubclapr) as "apr"'), DB::Raw('SUM(pubclmay) as "may"'), DB::Raw('SUM(pubcljun) as "jun"'), DB::Raw('SUM(pubcljul) as "jul"'), DB::Raw('SUM(pubclaug) as "aug"'), DB::Raw('SUM(pubclsep) as "sep", SUM(pubcloct) as "oct"'), DB::Raw('SUM(pubclnov) as "nov"'), DB::Raw('SUM(pubcldec) as "dec"'))->groupby('agegroup');
        }
        elseif ( $divisiontype == 'MD')
        {
            return $query->where('division', 'MD')->select('agegroup', DB::Raw('SUM(pubcljan) as "jan"'), DB::Raw('SUM(pubclfeb) as "feb"'), DB::Raw('SUM(pubclmar) as "mar"'), DB::Raw('SUM(pubclapr) as "apr"'), DB::Raw('SUM(pubclmay) as "may"'), DB::Raw('SUM(pubcljun) as "jun"'), DB::Raw('SUM(pubcljul) as "jul"'), DB::Raw('SUM(pubclaug) as "aug"'), DB::Raw('SUM(pubclsep) as "sep", SUM(pubcloct) as "oct"'), DB::Raw('SUM(pubclnov) as "nov"'), DB::Raw('SUM(pubcldec) as "dec"'))->groupby('agegroup');
        }
        elseif ( $divisiontype == 'WD')
        {
            return $query->where('division', 'WD')->select('agegroup', DB::Raw('SUM(pubcljan) as "jan"'), DB::Raw('SUM(pubclfeb) as "feb"'), DB::Raw('SUM(pubclmar) as "mar"'), DB::Raw('SUM(pubclapr) as "apr"'), DB::Raw('SUM(pubclmay) as "may"'), DB::Raw('SUM(pubcljun) as "jun"'), DB::Raw('SUM(pubcljul) as "jul"'), DB::Raw('SUM(pubclaug) as "aug"'), DB::Raw('SUM(pubclsep) as "sep", SUM(pubcloct) as "oct"'), DB::Raw('SUM(pubclnov) as "nov"'), DB::Raw('SUM(pubcldec) as "dec"'))->groupby('agegroup');
        }
        elseif ( $divisiontype == 'YMD')
        {
            return $query->where('division', 'YM')->select('agegroup', DB::Raw('SUM(pubcljan) as "jan"'), DB::Raw('SUM(pubclfeb) as "feb"'), DB::Raw('SUM(pubclmar) as "mar"'), DB::Raw('SUM(pubclapr) as "apr"'), DB::Raw('SUM(pubclmay) as "may"'), DB::Raw('SUM(pubcljun) as "jun"'), DB::Raw('SUM(pubcljul) as "jul"'), DB::Raw('SUM(pubclaug) as "aug"'), DB::Raw('SUM(pubclsep) as "sep", SUM(pubcloct) as "oct"'), DB::Raw('SUM(pubclnov) as "nov"'), DB::Raw('SUM(pubcldec) as "dec"'))->groupby('agegroup');
        }
        elseif ( $divisiontype == 'YWD')
        {
            return $query->where('division', 'YW')->select('agegroup', DB::Raw('SUM(pubcljan) as "jan"'), DB::Raw('SUM(pubclfeb) as "feb"'), DB::Raw('SUM(pubclmar) as "mar"'), DB::Raw('SUM(pubclapr) as "apr"'), DB::Raw('SUM(pubclmay) as "may"'), DB::Raw('SUM(pubcljun) as "jun"'), DB::Raw('SUM(pubcljul) as "jul"'), DB::Raw('SUM(pubclaug) as "aug"'), DB::Raw('SUM(pubclsep) as "sep", SUM(pubcloct) as "oct"'), DB::Raw('SUM(pubclnov) as "nov"'), DB::Raw('SUM(pubcldec) as "dec"'))->groupby('agegroup');
        }
        elseif ( $divisiontype == 'Primary Division')
        {
            return $query->where('agegroup', '07 to 12')->select('agegroup', DB::Raw('SUM(pubcljan) as "jan"'), DB::Raw('SUM(pubclfeb) as "feb"'), DB::Raw('SUM(pubclmar) as "mar"'), DB::Raw('SUM(pubclapr) as "apr"'), DB::Raw('SUM(pubclmay) as "may"'), DB::Raw('SUM(pubcljun) as "jun"'), DB::Raw('SUM(pubcljul) as "jul"'), DB::Raw('SUM(pubclaug) as "aug"'), DB::Raw('SUM(pubclsep) as "sep", SUM(pubcloct) as "oct"'), DB::Raw('SUM(pubclnov) as "nov"'), DB::Raw('SUM(pubcldec) as "dec"'))->groupby('agegroup');
        }
        elseif ( $divisiontype == 'Future Division')
        {
            return $query->where('agegroup', '13 to 16')->select('agegroup', DB::Raw('SUM(pubcljan) as "jan"'), DB::Raw('SUM(pubclfeb) as "feb"'), DB::Raw('SUM(pubclmar) as "mar"'), DB::Raw('SUM(pubclapr) as "apr"'), DB::Raw('SUM(pubclmay) as "may"'), DB::Raw('SUM(pubcljun) as "jun"'), DB::Raw('SUM(pubcljul) as "jul"'), DB::Raw('SUM(pubclaug) as "aug"'), DB::Raw('SUM(pubclsep) as "sep", SUM(pubcloct) as "oct"'), DB::Raw('SUM(pubclnov) as "nov"'), DB::Raw('SUM(pubcldec) as "dec"'))->groupby('agegroup');
        }
        elseif ( $divisiontype == 'Student Division')
        {
            return $query->where('studentdivision', '!=', '')->select('agegroup', DB::Raw('SUM(pubcljan) as "jan"'), DB::Raw('SUM(pubclfeb) as "feb"'), DB::Raw('SUM(pubclmar) as "mar"'), DB::Raw('SUM(pubclapr) as "apr"'), DB::Raw('SUM(pubclmay) as "may"'), DB::Raw('SUM(pubcljun) as "jun"'), DB::Raw('SUM(pubcljul) as "jul"'), DB::Raw('SUM(pubclaug) as "aug"'), DB::Raw('SUM(pubclsep) as "sep", SUM(pubcloct) as "oct"'), DB::Raw('SUM(pubclnov) as "nov"'), DB::Raw('SUM(pubcldec) as "dec"'))->groupby('agegroup');
        }
        elseif ( $divisiontype == 'Adult Division')
        {
            return $query->whereIn('division', array('MD', 'WD'))->select('agegroup', DB::Raw('SUM(pubcljan) as "jan"'), DB::Raw('SUM(pubclfeb) as "feb"'), DB::Raw('SUM(pubclmar) as "mar"'), DB::Raw('SUM(pubclapr) as "apr"'), DB::Raw('SUM(pubclmay) as "may"'), DB::Raw('SUM(pubcljun) as "jun"'), DB::Raw('SUM(pubcljul) as "jul"'), DB::Raw('SUM(pubclaug) as "aug"'), DB::Raw('SUM(pubclsep) as "sep", SUM(pubcloct) as "oct"'), DB::Raw('SUM(pubclnov) as "nov"'), DB::Raw('SUM(pubcldec) as "dec"'))->groupby('agegroup');
        }
        elseif ( $divisiontype == 'Youth Division')
        {
            return $query->whereIn('division', array('YM', 'YW'))->select('agegroup', DB::Raw('SUM(pubcljan) as "jan"'), DB::Raw('SUM(pubclfeb) as "feb"'), DB::Raw('SUM(pubclmar) as "mar"'), DB::Raw('SUM(pubclapr) as "apr"'), DB::Raw('SUM(pubclmay) as "may"'), DB::Raw('SUM(pubcljun) as "jun"'), DB::Raw('SUM(pubcljul) as "jul"'), DB::Raw('SUM(pubclaug) as "aug"'), DB::Raw('SUM(pubclsep) as "sep", SUM(pubcloct) as "oct"'), DB::Raw('SUM(pubclnov) as "nov"'), DB::Raw('SUM(pubcldec) as "dec"'))->groupby('agegroup');
        }
    }

    public function scopePUBSTAgeGroupStats($query, $value, $divisiontype)
    {
        if ( $divisiontype == 'All' or $divisiontype == "4 Division")
        {
            return $query->select('agegroup', DB::Raw('SUM(pubstjan) as "jan"'), DB::Raw('SUM(pubstfeb) as "feb"'), DB::Raw('SUM(pubstmar) as "mar"'), DB::Raw('SUM(pubstapr) as "apr"'), DB::Raw('SUM(pubstmay) as "may"'), DB::Raw('SUM(pubstjun) as "jun"'), DB::Raw('SUM(pubstjul) as "jul"'), DB::Raw('SUM(pubstaug) as "aug"'), DB::Raw('SUM(pubstsep) as "sep", SUM(pubstoct) as "oct"'), DB::Raw('SUM(pubstnov) as "nov"'), DB::Raw('SUM(pubstdec) as "dec"'))->groupby('agegroup');
        }
        elseif ( $divisiontype == 'MD')
        {
            return $query->where('division', 'MD')->select('agegroup', DB::Raw('SUM(pubstjan) as "jan"'), DB::Raw('SUM(pubstfeb) as "feb"'), DB::Raw('SUM(pubstmar) as "mar"'), DB::Raw('SUM(pubstapr) as "apr"'), DB::Raw('SUM(pubstmay) as "may"'), DB::Raw('SUM(pubstjun) as "jun"'), DB::Raw('SUM(pubstjul) as "jul"'), DB::Raw('SUM(pubstaug) as "aug"'), DB::Raw('SUM(pubstsep) as "sep", SUM(pubstoct) as "oct"'), DB::Raw('SUM(pubstnov) as "nov"'), DB::Raw('SUM(pubstdec) as "dec"'))->groupby('agegroup');
        }
        elseif ( $divisiontype == 'WD')
        {
            return $query->where('division', 'WD')->select('agegroup', DB::Raw('SUM(pubstjan) as "jan"'), DB::Raw('SUM(pubstfeb) as "feb"'), DB::Raw('SUM(pubstmar) as "mar"'), DB::Raw('SUM(pubstapr) as "apr"'), DB::Raw('SUM(pubstmay) as "may"'), DB::Raw('SUM(pubstjun) as "jun"'), DB::Raw('SUM(pubstjul) as "jul"'), DB::Raw('SUM(pubstaug) as "aug"'), DB::Raw('SUM(pubstsep) as "sep", SUM(pubstoct) as "oct"'), DB::Raw('SUM(pubstnov) as "nov"'), DB::Raw('SUM(pubstdec) as "dec"'))->groupby('agegroup');
        }
        elseif ( $divisiontype == 'YMD')
        {
            return $query->where('division', 'YM')->select('agegroup', DB::Raw('SUM(pubstjan) as "jan"'), DB::Raw('SUM(pubstfeb) as "feb"'), DB::Raw('SUM(pubstmar) as "mar"'), DB::Raw('SUM(pubstapr) as "apr"'), DB::Raw('SUM(pubstmay) as "may"'), DB::Raw('SUM(pubstjun) as "jun"'), DB::Raw('SUM(pubstjul) as "jul"'), DB::Raw('SUM(pubstaug) as "aug"'), DB::Raw('SUM(pubstsep) as "sep", SUM(pubstoct) as "oct"'), DB::Raw('SUM(pubstnov) as "nov"'), DB::Raw('SUM(pubstdec) as "dec"'))->groupby('agegroup');
        }
        elseif ( $divisiontype == 'YWD')
        {
            return $query->where('division', 'YW')->select('agegroup', DB::Raw('SUM(pubstjan) as "jan"'), DB::Raw('SUM(pubstfeb) as "feb"'), DB::Raw('SUM(pubstmar) as "mar"'), DB::Raw('SUM(pubstapr) as "apr"'), DB::Raw('SUM(pubstmay) as "may"'), DB::Raw('SUM(pubstjun) as "jun"'), DB::Raw('SUM(pubstjul) as "jul"'), DB::Raw('SUM(pubstaug) as "aug"'), DB::Raw('SUM(pubstsep) as "sep", SUM(pubstoct) as "oct"'), DB::Raw('SUM(pubstnov) as "nov"'), DB::Raw('SUM(pubstdec) as "dec"'))->groupby('agegroup');
        }
        elseif ( $divisiontype == 'Primary Division')
        {
            return $query->where('agegroup', '07 to 12')->select('agegroup', DB::Raw('SUM(pubstjan) as "jan"'), DB::Raw('SUM(pubstfeb) as "feb"'), DB::Raw('SUM(pubstmar) as "mar"'), DB::Raw('SUM(pubstapr) as "apr"'), DB::Raw('SUM(pubstmay) as "may"'), DB::Raw('SUM(pubstjun) as "jun"'), DB::Raw('SUM(pubstjul) as "jul"'), DB::Raw('SUM(pubstaug) as "aug"'), DB::Raw('SUM(pubstsep) as "sep", SUM(pubstoct) as "oct"'), DB::Raw('SUM(pubstnov) as "nov"'), DB::Raw('SUM(pubstdec) as "dec"'))->groupby('agegroup');
        }
        elseif ( $divisiontype == 'Future Division')
        {
            return $query->where('agegroup', '13 to 16')->select('agegroup', DB::Raw('SUM(pubstjan) as "jan"'), DB::Raw('SUM(pubstfeb) as "feb"'), DB::Raw('SUM(pubstmar) as "mar"'), DB::Raw('SUM(pubstapr) as "apr"'), DB::Raw('SUM(pubstmay) as "may"'), DB::Raw('SUM(pubstjun) as "jun"'), DB::Raw('SUM(pubstjul) as "jul"'), DB::Raw('SUM(pubstaug) as "aug"'), DB::Raw('SUM(pubstsep) as "sep", SUM(pubstoct) as "oct"'), DB::Raw('SUM(pubstnov) as "nov"'), DB::Raw('SUM(pubstdec) as "dec"'))->groupby('agegroup');
        }
        elseif ( $divisiontype == 'Student Division')
        {
            return $query->where('studentdivision', '!=', '')->select('agegroup', DB::Raw('SUM(pubstjan) as "jan"'), DB::Raw('SUM(pubstfeb) as "feb"'), DB::Raw('SUM(pubstmar) as "mar"'), DB::Raw('SUM(pubstapr) as "apr"'), DB::Raw('SUM(pubstmay) as "may"'), DB::Raw('SUM(pubstjun) as "jun"'), DB::Raw('SUM(pubstjul) as "jul"'), DB::Raw('SUM(pubstaug) as "aug"'), DB::Raw('SUM(pubstsep) as "sep", SUM(pubstoct) as "oct"'), DB::Raw('SUM(pubstnov) as "nov"'), DB::Raw('SUM(pubstdec) as "dec"'))->groupby('agegroup');
        }
        elseif ( $divisiontype == 'Adult Division')
        {
            return $query->whereIn('division', array('MD', 'WD'))->select('agegroup', DB::Raw('SUM(pubstjan) as "jan"'), DB::Raw('SUM(pubstfeb) as "feb"'), DB::Raw('SUM(pubstmar) as "mar"'), DB::Raw('SUM(pubstapr) as "apr"'), DB::Raw('SUM(pubstmay) as "may"'), DB::Raw('SUM(pubstjun) as "jun"'), DB::Raw('SUM(pubstjul) as "jul"'), DB::Raw('SUM(pubstaug) as "aug"'), DB::Raw('SUM(pubstsep) as "sep", SUM(pubstoct) as "oct"'), DB::Raw('SUM(pubstnov) as "nov"'), DB::Raw('SUM(pubstdec) as "dec"'))->groupby('agegroup');
        }
        elseif ( $divisiontype == 'Youth Division')
        {
            return $query->whereIn('division', array('YM', 'YW'))->select('agegroup', DB::Raw('SUM(pubstjan) as "jan"'), DB::Raw('SUM(pubstfeb) as "feb"'), DB::Raw('SUM(pubstmar) as "mar"'), DB::Raw('SUM(pubstapr) as "apr"'), DB::Raw('SUM(pubstmay) as "may"'), DB::Raw('SUM(pubstjun) as "jun"'), DB::Raw('SUM(pubstjul) as "jul"'), DB::Raw('SUM(pubstaug) as "aug"'), DB::Raw('SUM(pubstsep) as "sep", SUM(pubstoct) as "oct"'), DB::Raw('SUM(pubstnov) as "nov"'), DB::Raw('SUM(pubstdec) as "dec"'))->groupby('agegroup');
        }
    }

    public function scopePUBCLPositionLevelStats($query, $value, $divisiontype)
    {
        if ( $divisiontype == 'All' or $divisiontype == "4 Division")
        {
            return $query->select('positionlevel', DB::Raw('SUM(pubcljan) as "jan"'), DB::Raw('SUM(pubclfeb) as "feb"'), DB::Raw('SUM(pubclmar) as "mar"'), DB::Raw('SUM(pubclapr) as "apr"'), DB::Raw('SUM(pubclmay) as "may"'), DB::Raw('SUM(pubcljun) as "jun"'), DB::Raw('SUM(pubcljul) as "jul"'), DB::Raw('SUM(pubclaug) as "aug"'), DB::Raw('SUM(pubclsep) as "sep", SUM(pubcloct) as "oct"'), DB::Raw('SUM(pubclnov) as "nov"'), DB::Raw('SUM(pubcldec) as "dec"'))->groupby('positionlevel');
        }
        elseif ( $divisiontype == 'MD')
        {
            return $query->where('division', 'MD')->select('positionlevel', DB::Raw('SUM(pubcljan) as "jan"'), DB::Raw('SUM(pubclfeb) as "feb"'), DB::Raw('SUM(pubclmar) as "mar"'), DB::Raw('SUM(pubclapr) as "apr"'), DB::Raw('SUM(pubclmay) as "may"'), DB::Raw('SUM(pubcljun) as "jun"'), DB::Raw('SUM(pubcljul) as "jul"'), DB::Raw('SUM(pubclaug) as "aug"'), DB::Raw('SUM(pubclsep) as "sep", SUM(pubcloct) as "oct"'), DB::Raw('SUM(pubclnov) as "nov"'), DB::Raw('SUM(pubcldec) as "dec"'))->groupby('positionlevel');
        }
        elseif ( $divisiontype == 'WD')
        {
            return $query->where('division', 'WD')->select('positionlevel', DB::Raw('SUM(pubcljan) as "jan"'), DB::Raw('SUM(pubclfeb) as "feb"'), DB::Raw('SUM(pubclmar) as "mar"'), DB::Raw('SUM(pubclapr) as "apr"'), DB::Raw('SUM(pubclmay) as "may"'), DB::Raw('SUM(pubcljun) as "jun"'), DB::Raw('SUM(pubcljul) as "jul"'), DB::Raw('SUM(pubclaug) as "aug"'), DB::Raw('SUM(pubclsep) as "sep", SUM(pubcloct) as "oct"'), DB::Raw('SUM(pubclnov) as "nov"'), DB::Raw('SUM(pubcldec) as "dec"'))->groupby('positionlevel');
        }
        elseif ( $divisiontype == 'YMD')
        {
            return $query->where('division', 'YM')->select('positionlevel', DB::Raw('SUM(pubcljan) as "jan"'), DB::Raw('SUM(pubclfeb) as "feb"'), DB::Raw('SUM(pubclmar) as "mar"'), DB::Raw('SUM(pubclapr) as "apr"'), DB::Raw('SUM(pubclmay) as "may"'), DB::Raw('SUM(pubcljun) as "jun"'), DB::Raw('SUM(pubcljul) as "jul"'), DB::Raw('SUM(pubclaug) as "aug"'), DB::Raw('SUM(pubclsep) as "sep", SUM(pubcloct) as "oct"'), DB::Raw('SUM(pubclnov) as "nov"'), DB::Raw('SUM(pubcldec) as "dec"'))->groupby('positionlevel');
        }
        elseif ( $divisiontype == 'YWD')
        {
            return $query->where('division', 'YW')->select('positionlevel', DB::Raw('SUM(pubcljan) as "jan"'), DB::Raw('SUM(pubclfeb) as "feb"'), DB::Raw('SUM(pubclmar) as "mar"'), DB::Raw('SUM(pubclapr) as "apr"'), DB::Raw('SUM(pubclmay) as "may"'), DB::Raw('SUM(pubcljun) as "jun"'), DB::Raw('SUM(pubcljul) as "jul"'), DB::Raw('SUM(pubclaug) as "aug"'), DB::Raw('SUM(pubclsep) as "sep", SUM(pubcloct) as "oct"'), DB::Raw('SUM(pubclnov) as "nov"'), DB::Raw('SUM(pubcldec) as "dec"'))->groupby('positionlevel');
        }
        elseif ( $divisiontype == 'Primary Division')
        {
            return $query->where('agegroup', '07 to 12')->select('positionlevel', DB::Raw('SUM(pubcljan) as "jan"'), DB::Raw('SUM(pubclfeb) as "feb"'), DB::Raw('SUM(pubclmar) as "mar"'), DB::Raw('SUM(pubclapr) as "apr"'), DB::Raw('SUM(pubclmay) as "may"'), DB::Raw('SUM(pubcljun) as "jun"'), DB::Raw('SUM(pubcljul) as "jul"'), DB::Raw('SUM(pubclaug) as "aug"'), DB::Raw('SUM(pubclsep) as "sep", SUM(pubcloct) as "oct"'), DB::Raw('SUM(pubclnov) as "nov"'), DB::Raw('SUM(pubcldec) as "dec"'))->groupby('positionlevel');
        }
        elseif ( $divisiontype == 'Future Division')
        {
            return $query->where('agegroup', '13 to 16')->select('positionlevel', DB::Raw('SUM(pubcljan) as "jan"'), DB::Raw('SUM(pubclfeb) as "feb"'), DB::Raw('SUM(pubclmar) as "mar"'), DB::Raw('SUM(pubclapr) as "apr"'), DB::Raw('SUM(pubclmay) as "may"'), DB::Raw('SUM(pubcljun) as "jun"'), DB::Raw('SUM(pubcljul) as "jul"'), DB::Raw('SUM(pubclaug) as "aug"'), DB::Raw('SUM(pubclsep) as "sep", SUM(pubcloct) as "oct"'), DB::Raw('SUM(pubclnov) as "nov"'), DB::Raw('SUM(pubcldec) as "dec"'))->groupby('positionlevel');
        }
        elseif ( $divisiontype == 'Student Division')
        {
            return $query->where('studentdivision', '!=', '')->select('positionlevel', DB::Raw('SUM(pubcljan) as "jan"'), DB::Raw('SUM(pubclfeb) as "feb"'), DB::Raw('SUM(pubclmar) as "mar"'), DB::Raw('SUM(pubclapr) as "apr"'), DB::Raw('SUM(pubclmay) as "may"'), DB::Raw('SUM(pubcljun) as "jun"'), DB::Raw('SUM(pubcljul) as "jul"'), DB::Raw('SUM(pubclaug) as "aug"'), DB::Raw('SUM(pubclsep) as "sep", SUM(pubcloct) as "oct"'), DB::Raw('SUM(pubclnov) as "nov"'), DB::Raw('SUM(pubcldec) as "dec"'))->groupby('positionlevel');
        }
        elseif ( $divisiontype == 'Adult Division')
        {
            return $query->whereIn('division', array('MD', 'WD'))->select('positionlevel', DB::Raw('SUM(pubcljan) as "jan"'), DB::Raw('SUM(pubclfeb) as "feb"'), DB::Raw('SUM(pubclmar) as "mar"'), DB::Raw('SUM(pubclapr) as "apr"'), DB::Raw('SUM(pubclmay) as "may"'), DB::Raw('SUM(pubcljun) as "jun"'), DB::Raw('SUM(pubcljul) as "jul"'), DB::Raw('SUM(pubclaug) as "aug"'), DB::Raw('SUM(pubclsep) as "sep", SUM(pubcloct) as "oct"'), DB::Raw('SUM(pubclnov) as "nov"'), DB::Raw('SUM(pubcldec) as "dec"'))->groupby('positionlevel');
        }
        elseif ( $divisiontype == 'Youth Division')
        {
            return $query->whereIn('division', array('YM', 'YW'))->select('positionlevel', DB::Raw('SUM(pubcljan) as "jan"'), DB::Raw('SUM(pubclfeb) as "feb"'), DB::Raw('SUM(pubclmar) as "mar"'), DB::Raw('SUM(pubclapr) as "apr"'), DB::Raw('SUM(pubclmay) as "may"'), DB::Raw('SUM(pubcljun) as "jun"'), DB::Raw('SUM(pubcljul) as "jul"'), DB::Raw('SUM(pubclaug) as "aug"'), DB::Raw('SUM(pubclsep) as "sep", SUM(pubcloct) as "oct"'), DB::Raw('SUM(pubclnov) as "nov"'), DB::Raw('SUM(pubcldec) as "dec"'))->groupby('positionlevel');
        }
    }

    public function scopePUBSTPositionLevelStats($query, $value, $divisiontype)
    {
        if ( $divisiontype == 'All' or $divisiontype == "4 Division")
        {
            return $query->select('positionlevel', DB::Raw('SUM(pubstjan) as "jan"'), DB::Raw('SUM(pubstfeb) as "feb"'), DB::Raw('SUM(pubstmar) as "mar"'), DB::Raw('SUM(pubstapr) as "apr"'), DB::Raw('SUM(pubstmay) as "may"'), DB::Raw('SUM(pubstjun) as "jun"'), DB::Raw('SUM(pubstjul) as "jul"'), DB::Raw('SUM(pubstaug) as "aug"'), DB::Raw('SUM(pubstsep) as "sep", SUM(pubstoct) as "oct"'), DB::Raw('SUM(pubstnov) as "nov"'), DB::Raw('SUM(pubstdec) as "dec"'))->groupby('positionlevel');
        }
        elseif ( $divisiontype == 'MD')
        {
            return $query->where('division', 'MD')->select('positionlevel', DB::Raw('SUM(pubstjan) as "jan"'), DB::Raw('SUM(pubstfeb) as "feb"'), DB::Raw('SUM(pubstmar) as "mar"'), DB::Raw('SUM(pubstapr) as "apr"'), DB::Raw('SUM(pubstmay) as "may"'), DB::Raw('SUM(pubstjun) as "jun"'), DB::Raw('SUM(pubstjul) as "jul"'), DB::Raw('SUM(pubstaug) as "aug"'), DB::Raw('SUM(pubstsep) as "sep", SUM(pubstoct) as "oct"'), DB::Raw('SUM(pubstnov) as "nov"'), DB::Raw('SUM(pubstdec) as "dec"'))->groupby('positionlevel');
        }
        elseif ( $divisiontype == 'WD')
        {
            return $query->where('division', 'WD')->select('positionlevel', DB::Raw('SUM(pubstjan) as "jan"'), DB::Raw('SUM(pubstfeb) as "feb"'), DB::Raw('SUM(pubstmar) as "mar"'), DB::Raw('SUM(pubstapr) as "apr"'), DB::Raw('SUM(pubstmay) as "may"'), DB::Raw('SUM(pubstjun) as "jun"'), DB::Raw('SUM(pubstjul) as "jul"'), DB::Raw('SUM(pubstaug) as "aug"'), DB::Raw('SUM(pubstsep) as "sep", SUM(pubstoct) as "oct"'), DB::Raw('SUM(pubstnov) as "nov"'), DB::Raw('SUM(pubstdec) as "dec"'))->groupby('positionlevel');
        }
        elseif ( $divisiontype == 'YMD')
        {
            return $query->where('division', 'YM')->select('positionlevel', DB::Raw('SUM(pubstjan) as "jan"'), DB::Raw('SUM(pubstfeb) as "feb"'), DB::Raw('SUM(pubstmar) as "mar"'), DB::Raw('SUM(pubstapr) as "apr"'), DB::Raw('SUM(pubstmay) as "may"'), DB::Raw('SUM(pubstjun) as "jun"'), DB::Raw('SUM(pubstjul) as "jul"'), DB::Raw('SUM(pubstaug) as "aug"'), DB::Raw('SUM(pubstsep) as "sep", SUM(pubstoct) as "oct"'), DB::Raw('SUM(pubstnov) as "nov"'), DB::Raw('SUM(pubstdec) as "dec"'))->groupby('positionlevel');
        }
        elseif ( $divisiontype == 'YWD')
        {
            return $query->where('division', 'YW')->select('positionlevel', DB::Raw('SUM(pubstjan) as "jan"'), DB::Raw('SUM(pubstfeb) as "feb"'), DB::Raw('SUM(pubstmar) as "mar"'), DB::Raw('SUM(pubstapr) as "apr"'), DB::Raw('SUM(pubstmay) as "may"'), DB::Raw('SUM(pubstjun) as "jun"'), DB::Raw('SUM(pubstjul) as "jul"'), DB::Raw('SUM(pubstaug) as "aug"'), DB::Raw('SUM(pubstsep) as "sep", SUM(pubstoct) as "oct"'), DB::Raw('SUM(pubstnov) as "nov"'), DB::Raw('SUM(pubstdec) as "dec"'))->groupby('positionlevel');
        }
        elseif ( $divisiontype == 'Primary Division')
        {
            return $query->where('agegroup', '07 to 12')->select('positionlevel', DB::Raw('SUM(pubstjan) as "jan"'), DB::Raw('SUM(pubstfeb) as "feb"'), DB::Raw('SUM(pubstmar) as "mar"'), DB::Raw('SUM(pubstapr) as "apr"'), DB::Raw('SUM(pubstmay) as "may"'), DB::Raw('SUM(pubstjun) as "jun"'), DB::Raw('SUM(pubstjul) as "jul"'), DB::Raw('SUM(pubstaug) as "aug"'), DB::Raw('SUM(pubstsep) as "sep", SUM(pubstoct) as "oct"'), DB::Raw('SUM(pubstnov) as "nov"'), DB::Raw('SUM(pubstdec) as "dec"'))->groupby('positionlevel');
        }
        elseif ( $divisiontype == 'Future Division')
        {
            return $query->where('agegroup', '13 to 16')->select('positionlevel', DB::Raw('SUM(pubstjan) as "jan"'), DB::Raw('SUM(pubstfeb) as "feb"'), DB::Raw('SUM(pubstmar) as "mar"'), DB::Raw('SUM(pubstapr) as "apr"'), DB::Raw('SUM(pubstmay) as "may"'), DB::Raw('SUM(pubstjun) as "jun"'), DB::Raw('SUM(pubstjul) as "jul"'), DB::Raw('SUM(pubstaug) as "aug"'), DB::Raw('SUM(pubstsep) as "sep", SUM(pubstoct) as "oct"'), DB::Raw('SUM(pubstnov) as "nov"'), DB::Raw('SUM(pubstdec) as "dec"'))->groupby('positionlevel');
        }
        elseif ( $divisiontype == 'Student Division')
        {
            return $query->where('studentdivision', '!=', '')->select('positionlevel', DB::Raw('SUM(pubstjan) as "jan"'), DB::Raw('SUM(pubstfeb) as "feb"'), DB::Raw('SUM(pubstmar) as "mar"'), DB::Raw('SUM(pubstapr) as "apr"'), DB::Raw('SUM(pubstmay) as "may"'), DB::Raw('SUM(pubstjun) as "jun"'), DB::Raw('SUM(pubstjul) as "jul"'), DB::Raw('SUM(pubstaug) as "aug"'), DB::Raw('SUM(pubstsep) as "sep", SUM(pubstoct) as "oct"'), DB::Raw('SUM(pubstnov) as "nov"'), DB::Raw('SUM(pubstdec) as "dec"'))->groupby('positionlevel');
        }
        elseif ( $divisiontype == 'Adult Division')
        {
            return $query->whereIn('division', array('MD', 'WD'))->select('positionlevel', DB::Raw('SUM(pubstjan) as "jan"'), DB::Raw('SUM(pubstfeb) as "feb"'), DB::Raw('SUM(pubstmar) as "mar"'), DB::Raw('SUM(pubstapr) as "apr"'), DB::Raw('SUM(pubstmay) as "may"'), DB::Raw('SUM(pubstjun) as "jun"'), DB::Raw('SUM(pubstjul) as "jul"'), DB::Raw('SUM(pubstaug) as "aug"'), DB::Raw('SUM(pubstsep) as "sep", SUM(pubstoct) as "oct"'), DB::Raw('SUM(pubstnov) as "nov"'), DB::Raw('SUM(pubstdec) as "dec"'))->groupby('positionlevel');
        }
        elseif ( $divisiontype == 'Youth Division')
        {
            return $query->whereIn('division', array('YM', 'YW'))->select('positionlevel', DB::Raw('SUM(pubstjan) as "jan"'), DB::Raw('SUM(pubstfeb) as "feb"'), DB::Raw('SUM(pubstmar) as "mar"'), DB::Raw('SUM(pubstapr) as "apr"'), DB::Raw('SUM(pubstmay) as "may"'), DB::Raw('SUM(pubstjun) as "jun"'), DB::Raw('SUM(pubstjul) as "jul"'), DB::Raw('SUM(pubstaug) as "aug"'), DB::Raw('SUM(pubstsep) as "sep", SUM(pubstoct) as "oct"'), DB::Raw('SUM(pubstnov) as "nov"'), DB::Raw('SUM(pubstdec) as "dec"'))->groupby('positionlevel');
        }
    }

    public function scopePUBCLNameList($query, $value, $divisiontype)
    {
        if ( $divisiontype == 'All' or $divisiontype == "4 Division")
        {
            return $query->whereIn('rhq', array('', 'H0', 'H2', 'H3', 'H4', 'H5', 'H6', 'H7', 'H8', 'H9'))->select('name', 'rhq', 'zone', 'chapter', 'district', 'division', 'position', DB::Raw('SUM(pubcljan) as "jan"'), DB::Raw('SUM(pubclfeb) as "feb"'), DB::Raw('SUM(pubclmar) as "mar"'), DB::Raw('SUM(pubclapr) as "apr"'), DB::Raw('SUM(pubclmay) as "may"'), DB::Raw('SUM(pubcljun) as "jun"'), DB::Raw('SUM(pubcljul) as "jul"'), DB::Raw('SUM(pubclaug) as "aug"'), DB::Raw('SUM(pubclsep) as "sep", SUM(pubcloct) as "oct"'), DB::Raw('SUM(pubclnov) as "nov"'), DB::Raw('SUM(pubcldec) as "dec"'), DB::Raw('concat(chapter, " ", district) as description'))->groupby('rhq')->groupby('zone')->groupby('chapter')->groupby('district')->groupby('name');
        }
        elseif ( $divisiontype == 'MD')
        {
            return $query->whereIn('rhq', array('', 'H0', 'H2', 'H3', 'H4', 'H5', 'H6', 'H7', 'H8', 'H9'))->where('division', 'MD')->select('name', 'rhq', 'zone', 'chapter', 'district', 'division', 'position', DB::Raw('SUM(pubcljan) as "jan"'), DB::Raw('SUM(pubclfeb) as "feb"'), DB::Raw('SUM(pubclmar) as "mar"'), DB::Raw('SUM(pubclapr) as "apr"'), DB::Raw('SUM(pubclmay) as "may"'), DB::Raw('SUM(pubcljun) as "jun"'), DB::Raw('SUM(pubcljul) as "jul"'), DB::Raw('SUM(pubclaug) as "aug"'), DB::Raw('SUM(pubclsep) as "sep", SUM(pubcloct) as "oct"'), DB::Raw('SUM(pubclnov) as "nov"'), DB::Raw('SUM(pubcldec) as "dec"'), DB::Raw('concat(chapter, " ", district) as description'))->groupby('rhq')->groupby('zone')->groupby('chapter')->groupby('district')->groupby('name');
        }
        elseif ( $divisiontype == 'WD')
        {
            return $query->whereIn('rhq', array('', 'H0', 'H2', 'H3', 'H4', 'H5', 'H6', 'H7', 'H8', 'H9'))->where('division', 'WD')->select('name', 'rhq', 'zone', 'chapter', 'district', 'division', 'position', DB::Raw('SUM(pubcljan) as "jan"'), DB::Raw('SUM(pubclfeb) as "feb"'), DB::Raw('SUM(pubclmar) as "mar"'), DB::Raw('SUM(pubclapr) as "apr"'), DB::Raw('SUM(pubclmay) as "may"'), DB::Raw('SUM(pubcljun) as "jun"'), DB::Raw('SUM(pubcljul) as "jul"'), DB::Raw('SUM(pubclaug) as "aug"'), DB::Raw('SUM(pubclsep) as "sep", SUM(pubcloct) as "oct"'), DB::Raw('SUM(pubclnov) as "nov"'), DB::Raw('SUM(pubcldec) as "dec"'), DB::Raw('concat(chapter, " ", district) as description'))->groupby('rhq')->groupby('zone')->groupby('chapter')->groupby('district')->groupby('name');
        }
        elseif ( $divisiontype == 'YMD')
        {
            return $query->whereIn('rhq', array('', 'H0', 'H2', 'H3', 'H4', 'H5', 'H6', 'H7', 'H8', 'H9'))->where('division', 'YM')->select('name', 'rhq', 'zone', 'chapter', 'district', 'division', 'position', DB::Raw('SUM(pubcljan) as "jan"'), DB::Raw('SUM(pubclfeb) as "feb"'), DB::Raw('SUM(pubclmar) as "mar"'), DB::Raw('SUM(pubclapr) as "apr"'), DB::Raw('SUM(pubclmay) as "may"'), DB::Raw('SUM(pubcljun) as "jun"'), DB::Raw('SUM(pubcljul) as "jul"'), DB::Raw('SUM(pubclaug) as "aug"'), DB::Raw('SUM(pubclsep) as "sep", SUM(pubcloct) as "oct"'), DB::Raw('SUM(pubclnov) as "nov"'), DB::Raw('SUM(pubcldec) as "dec"'), DB::Raw('concat(chapter, " ", district) as description'))->groupby('rhq')->groupby('zone')->groupby('chapter')->groupby('district')->groupby('name');
        }
        elseif ( $divisiontype == 'YWD')
        {
            return $query->whereIn('rhq', array('', 'H0', 'H2', 'H3', 'H4', 'H5', 'H6', 'H7', 'H8', 'H9'))->where('division', 'YW')->select('name', 'rhq', 'zone', 'chapter', 'district', 'division', 'position', DB::Raw('SUM(pubcljan) as "jan"'), DB::Raw('SUM(pubclfeb) as "feb"'), DB::Raw('SUM(pubclmar) as "mar"'), DB::Raw('SUM(pubclapr) as "apr"'), DB::Raw('SUM(pubclmay) as "may"'), DB::Raw('SUM(pubcljun) as "jun"'), DB::Raw('SUM(pubcljul) as "jul"'), DB::Raw('SUM(pubclaug) as "aug"'), DB::Raw('SUM(pubclsep) as "sep", SUM(pubcloct) as "oct"'), DB::Raw('SUM(pubclnov) as "nov"'), DB::Raw('SUM(pubcldec) as "dec"'), DB::Raw('concat(chapter, " ", district) as description'))->groupby('rhq')->groupby('zone')->groupby('chapter')->groupby('district')->groupby('name');
        }
        elseif ( $divisiontype == 'Primary Division')
        {
            return $query->whereIn('rhq', array('', 'H0', 'H2', 'H3', 'H4', 'H5', 'H6', 'H7', 'H8', 'H9'))->where('agegroup', '07 to 12')->select('name', 'rhq', 'zone', 'chapter', 'district', 'division', 'position', DB::Raw('SUM(pubcljan) as "jan"'), DB::Raw('SUM(pubclfeb) as "feb"'), DB::Raw('SUM(pubclmar) as "mar"'), DB::Raw('SUM(pubclapr) as "apr"'), DB::Raw('SUM(pubclmay) as "may"'), DB::Raw('SUM(pubcljun) as "jun"'), DB::Raw('SUM(pubcljul) as "jul"'), DB::Raw('SUM(pubclaug) as "aug"'), DB::Raw('SUM(pubclsep) as "sep", SUM(pubcloct) as "oct"'), DB::Raw('SUM(pubclnov) as "nov"'), DB::Raw('SUM(pubcldec) as "dec"'), DB::Raw('concat(chapter, " ", district) as description'))->groupby('rhq')->groupby('zone')->groupby('chapter')->groupby('district')->groupby('name');
        }
        elseif ( $divisiontype == 'Future Division')
        {
            return $query->whereIn('rhq', array('', 'H0', 'H2', 'H3', 'H4', 'H5', 'H6', 'H7', 'H8', 'H9'))->where('agegroup', '13 to 16')->select('name', 'rhq', 'zone', 'chapter', 'district', 'division', 'position', DB::Raw('SUM(pubcljan) as "jan"'), DB::Raw('SUM(pubclfeb) as "feb"'), DB::Raw('SUM(pubclmar) as "mar"'), DB::Raw('SUM(pubclapr) as "apr"'), DB::Raw('SUM(pubclmay) as "may"'), DB::Raw('SUM(pubcljun) as "jun"'), DB::Raw('SUM(pubcljul) as "jul"'), DB::Raw('SUM(pubclaug) as "aug"'), DB::Raw('SUM(pubclsep) as "sep", SUM(pubcloct) as "oct"'), DB::Raw('SUM(pubclnov) as "nov"'), DB::Raw('SUM(pubcldec) as "dec"'), DB::Raw('concat(chapter, " ", district) as description'))->groupby('rhq')->groupby('zone')->groupby('chapter')->groupby('district')->groupby('name');
        }
        elseif ( $divisiontype == 'Student Division')
        {
            return $query->whereIn('rhq', array('', 'H0', 'H2', 'H3', 'H4', 'H5', 'H6', 'H7', 'H8', 'H9'))->where('studentdivision', '!=', '')->select('name', 'rhq', 'zone', 'chapter', 'district', 'division', 'position', DB::Raw('SUM(pubcljan) as "jan"'), DB::Raw('SUM(pubclfeb) as "feb"'), DB::Raw('SUM(pubclmar) as "mar"'), DB::Raw('SUM(pubclapr) as "apr"'), DB::Raw('SUM(pubclmay) as "may"'), DB::Raw('SUM(pubcljun) as "jun"'), DB::Raw('SUM(pubcljul) as "jul"'), DB::Raw('SUM(pubclaug) as "aug"'), DB::Raw('SUM(pubclsep) as "sep", SUM(pubcloct) as "oct"'), DB::Raw('SUM(pubclnov) as "nov"'), DB::Raw('SUM(pubcldec) as "dec"'), DB::Raw('concat(chapter, " ", district) as description'))->groupby('rhq')->groupby('zone')->groupby('chapter')->groupby('district')->groupby('name');
        }
        elseif ( $divisiontype == 'Adult Division')
        {
            return $query->whereIn('rhq', array('', 'H0', 'H2', 'H3', 'H4', 'H5', 'H6', 'H7', 'H8', 'H9'))->whereIn('division', array('MD', 'WD'))->select('name', 'rhq', 'zone', 'chapter', 'district', 'division', 'position', DB::Raw('SUM(pubcljan) as "jan"'), DB::Raw('SUM(pubclfeb) as "feb"'), DB::Raw('SUM(pubclmar) as "mar"'), DB::Raw('SUM(pubclapr) as "apr"'), DB::Raw('SUM(pubclmay) as "may"'), DB::Raw('SUM(pubcljun) as "jun"'), DB::Raw('SUM(pubcljul) as "jul"'), DB::Raw('SUM(pubclaug) as "aug"'), DB::Raw('SUM(pubclsep) as "sep", SUM(pubcloct) as "oct"'), DB::Raw('SUM(pubclnov) as "nov"'), DB::Raw('SUM(pubcldec) as "dec"'), DB::Raw('concat(chapter, " ", district) as description'))->groupby('rhq')->groupby('zone')->groupby('chapter')->groupby('district')->groupby('name');
        }
        elseif ( $divisiontype == 'Youth Division')
        {
            return $query->whereIn('rhq', array('', 'H0', 'H2', 'H3', 'H4', 'H5', 'H6', 'H7', 'H8', 'H9'))->whereIn('division', array('YM', 'YW'))->select('name', 'rhq', 'zone', 'chapter', 'district', 'division', 'position', DB::Raw('SUM(pubcljan) as "jan"'), DB::Raw('SUM(pubclfeb) as "feb"'), DB::Raw('SUM(pubclmar) as "mar"'), DB::Raw('SUM(pubclapr) as "apr"'), DB::Raw('SUM(pubclmay) as "may"'), DB::Raw('SUM(pubcljun) as "jun"'), DB::Raw('SUM(pubcljul) as "jul"'), DB::Raw('SUM(pubclaug) as "aug"'), DB::Raw('SUM(pubclsep) as "sep", SUM(pubcloct) as "oct"'), DB::Raw('SUM(pubclnov) as "nov"'), DB::Raw('SUM(pubcldec) as "dec"'), DB::Raw('concat(chapter, " ", district) as description'))->groupby('rhq')->groupby('zone')->groupby('chapter')->groupby('district')->groupby('name');
        }
    }

    public function scopePUBSTNameList($query, $value, $divisiontype)
    {
        if ( $divisiontype == 'All' or $divisiontype == "4 Division")
        {
            return $query->whereIn('rhq', array('', 'H0', 'H2', 'H3', 'H4', 'H5', 'H6', 'H7', 'H8', 'H9'))->select('name', 'rhq', 'zone', 'chapter', 'district', 'division', 'position', DB::Raw('SUM(pubstjan) as "jan"'), DB::Raw('SUM(pubstfeb) as "feb"'), DB::Raw('SUM(pubstmar) as "mar"'), DB::Raw('SUM(pubstapr) as "apr"'), DB::Raw('SUM(pubstmay) as "may"'), DB::Raw('SUM(pubstjun) as "jun"'), DB::Raw('SUM(pubstjul) as "jul"'), DB::Raw('SUM(pubstaug) as "aug"'), DB::Raw('SUM(pubstsep) as "sep", SUM(pubstoct) as "oct"'), DB::Raw('SUM(pubstnov) as "nov"'), DB::Raw('SUM(pubstdec) as "dec"'), DB::Raw('concat(chapter, " ", district) as description'))->groupby('rhq')->groupby('zone')->groupby('chapter')->groupby('district')->groupby('name');
        }
        elseif ( $divisiontype == 'MD')
        {
            return $query->whereIn('rhq', array('', 'H0', 'H2', 'H3', 'H4', 'H5', 'H6', 'H7', 'H8', 'H9'))->where('division', 'MD')->select('name', 'rhq', 'zone', 'chapter', 'district', 'division', 'position', DB::Raw('SUM(pubstjan) as "jan"'), DB::Raw('SUM(pubstfeb) as "feb"'), DB::Raw('SUM(pubstmar) as "mar"'), DB::Raw('SUM(pubstapr) as "apr"'), DB::Raw('SUM(pubstmay) as "may"'), DB::Raw('SUM(pubstjun) as "jun"'), DB::Raw('SUM(pubstjul) as "jul"'), DB::Raw('SUM(pubstaug) as "aug"'), DB::Raw('SUM(pubstsep) as "sep", SUM(pubstoct) as "oct"'), DB::Raw('SUM(pubstnov) as "nov"'), DB::Raw('SUM(pubstdec) as "dec"'), DB::Raw('concat(chapter, " ", district) as description'))->groupby('rhq')->groupby('zone')->groupby('chapter')->groupby('district')->groupby('name');
        }
        elseif ( $divisiontype == 'WD')
        {
            return $query->whereIn('rhq', array('', 'H0', 'H2', 'H3', 'H4', 'H5', 'H6', 'H7', 'H8', 'H9'))->where('division', 'WD')->select('name', 'rhq', 'zone', 'chapter', 'district', 'division', 'position', DB::Raw('SUM(pubstjan) as "jan"'), DB::Raw('SUM(pubstfeb) as "feb"'), DB::Raw('SUM(pubstmar) as "mar"'), DB::Raw('SUM(pubstapr) as "apr"'), DB::Raw('SUM(pubstmay) as "may"'), DB::Raw('SUM(pubstjun) as "jun"'), DB::Raw('SUM(pubstjul) as "jul"'), DB::Raw('SUM(pubstaug) as "aug"'), DB::Raw('SUM(pubstsep) as "sep", SUM(pubstoct) as "oct"'), DB::Raw('SUM(pubstnov) as "nov"'), DB::Raw('SUM(pubstdec) as "dec"'), DB::Raw('concat(chapter, " ", district) as description'))->groupby('rhq')->groupby('zone')->groupby('chapter')->groupby('district')->groupby('name');
        }
        elseif ( $divisiontype == 'YMD')
        {
            return $query->whereIn('rhq', array('', 'H0', 'H2', 'H3', 'H4', 'H5', 'H6', 'H7', 'H8', 'H9'))->where('division', 'YM')->select('name', 'rhq', 'zone', 'chapter', 'district', 'division', 'position', DB::Raw('SUM(pubstjan) as "jan"'), DB::Raw('SUM(pubstfeb) as "feb"'), DB::Raw('SUM(pubstmar) as "mar"'), DB::Raw('SUM(pubstapr) as "apr"'), DB::Raw('SUM(pubstmay) as "may"'), DB::Raw('SUM(pubstjun) as "jun"'), DB::Raw('SUM(pubstjul) as "jul"'), DB::Raw('SUM(pubstaug) as "aug"'), DB::Raw('SUM(pubstsep) as "sep", SUM(pubstoct) as "oct"'), DB::Raw('SUM(pubstnov) as "nov"'), DB::Raw('SUM(pubstdec) as "dec"'), DB::Raw('concat(chapter, " ", district) as description'))->groupby('rhq')->groupby('zone')->groupby('chapter')->groupby('district')->groupby('name');
        }
        elseif ( $divisiontype == 'YWD')
        {
            return $query->whereIn('rhq', array('', 'H0', 'H2', 'H3', 'H4', 'H5', 'H6', 'H7', 'H8', 'H9'))->where('division', 'YW')->select('name', 'rhq', 'zone', 'chapter', 'district', 'division', 'position', DB::Raw('SUM(pubstjan) as "jan"'), DB::Raw('SUM(pubstfeb) as "feb"'), DB::Raw('SUM(pubstmar) as "mar"'), DB::Raw('SUM(pubstapr) as "apr"'), DB::Raw('SUM(pubstmay) as "may"'), DB::Raw('SUM(pubstjun) as "jun"'), DB::Raw('SUM(pubstjul) as "jul"'), DB::Raw('SUM(pubstaug) as "aug"'), DB::Raw('SUM(pubstsep) as "sep", SUM(pubstoct) as "oct"'), DB::Raw('SUM(pubstnov) as "nov"'), DB::Raw('SUM(pubstdec) as "dec"'), DB::Raw('concat(chapter, " ", district) as description'))->groupby('rhq')->groupby('zone')->groupby('chapter')->groupby('district')->groupby('name');
        }
        elseif ( $divisiontype == 'Primary Division')
        {
            return $query->whereIn('rhq', array('', 'H0', 'H2', 'H3', 'H4', 'H5', 'H6', 'H7', 'H8', 'H9'))->where('agegroup', '07 to 12')->select('name', 'rhq', 'zone', 'chapter', 'district', 'division', 'position', DB::Raw('SUM(pubstjan) as "jan"'), DB::Raw('SUM(pubstfeb) as "feb"'), DB::Raw('SUM(pubstmar) as "mar"'), DB::Raw('SUM(pubstapr) as "apr"'), DB::Raw('SUM(pubstmay) as "may"'), DB::Raw('SUM(pubstjun) as "jun"'), DB::Raw('SUM(pubstjul) as "jul"'), DB::Raw('SUM(pubstaug) as "aug"'), DB::Raw('SUM(pubstsep) as "sep", SUM(pubstoct) as "oct"'), DB::Raw('SUM(pubstnov) as "nov"'), DB::Raw('SUM(pubstdec) as "dec"'), DB::Raw('concat(chapter, " ", district) as description'))->groupby('rhq')->groupby('zone')->groupby('chapter')->groupby('district')->groupby('name');
        }
        elseif ( $divisiontype == 'Future Division')
        {
            return $query->whereIn('rhq', array('', 'H0', 'H2', 'H3', 'H4', 'H5', 'H6', 'H7', 'H8', 'H9'))->where('agegroup', '13 to 16')->select('name', 'rhq', 'zone', 'chapter', 'district', 'division', 'position', DB::Raw('SUM(pubstjan) as "jan"'), DB::Raw('SUM(pubstfeb) as "feb"'), DB::Raw('SUM(pubstmar) as "mar"'), DB::Raw('SUM(pubstapr) as "apr"'), DB::Raw('SUM(pubstmay) as "may"'), DB::Raw('SUM(pubstjun) as "jun"'), DB::Raw('SUM(pubstjul) as "jul"'), DB::Raw('SUM(pubstaug) as "aug"'), DB::Raw('SUM(pubstsep) as "sep", SUM(pubstoct) as "oct"'), DB::Raw('SUM(pubstnov) as "nov"'), DB::Raw('SUM(pubstdec) as "dec"'), DB::Raw('concat(chapter, " ", district) as description'))->groupby('rhq')->groupby('zone')->groupby('chapter')->groupby('district')->groupby('name');
        }
        elseif ( $divisiontype == 'Student Division')
        {
            return $query->whereIn('rhq', array('', 'H0', 'H2', 'H3', 'H4', 'H5', 'H6', 'H7', 'H8', 'H9'))->where('studentdivision', '!=', '')->select('name', 'rhq', 'zone', 'chapter', 'district', 'division', 'position', DB::Raw('SUM(pubstjan) as "jan"'), DB::Raw('SUM(pubstfeb) as "feb"'), DB::Raw('SUM(pubstmar) as "mar"'), DB::Raw('SUM(pubstapr) as "apr"'), DB::Raw('SUM(pubstmay) as "may"'), DB::Raw('SUM(pubstjun) as "jun"'), DB::Raw('SUM(pubstjul) as "jul"'), DB::Raw('SUM(pubstaug) as "aug"'), DB::Raw('SUM(pubstsep) as "sep", SUM(pubstoct) as "oct"'), DB::Raw('SUM(pubstnov) as "nov"'), DB::Raw('SUM(pubstdec) as "dec"'), DB::Raw('concat(chapter, " ", district) as description'))->groupby('rhq')->groupby('zone')->groupby('chapter')->groupby('district')->groupby('name');
        }
        elseif ( $divisiontype == 'Adult Division')
        {
            return $query->whereIn('rhq', array('', 'H0', 'H2', 'H3', 'H4', 'H5', 'H6', 'H7', 'H8', 'H9'))->whereIn('division', array('MD', 'WD'))->select('name', 'rhq', 'zone', 'chapter', 'district', 'division', 'position', DB::Raw('SUM(pubstjan) as "jan"'), DB::Raw('SUM(pubstfeb) as "feb"'), DB::Raw('SUM(pubstmar) as "mar"'), DB::Raw('SUM(pubstapr) as "apr"'), DB::Raw('SUM(pubstmay) as "may"'), DB::Raw('SUM(pubstjun) as "jun"'), DB::Raw('SUM(pubstjul) as "jul"'), DB::Raw('SUM(pubstaug) as "aug"'), DB::Raw('SUM(pubstsep) as "sep", SUM(pubstoct) as "oct"'), DB::Raw('SUM(pubstnov) as "nov"'), DB::Raw('SUM(pubstdec) as "dec"'), DB::Raw('concat(chapter, " ", district) as description'))->groupby('rhq')->groupby('zone')->groupby('chapter')->groupby('district')->groupby('name');
        }
        elseif ( $divisiontype == 'Youth Division')
        {
            return $query->whereIn('rhq', array('', 'H0', 'H2', 'H3', 'H4', 'H5', 'H6', 'H7', 'H8', 'H9'))->whereIn('division', array('YM', 'YW'))->select('name', 'rhq', 'zone', 'chapter', 'district', 'division', 'position', DB::Raw('SUM(pubstjan) as "jan"'), DB::Raw('SUM(pubstfeb) as "feb"'), DB::Raw('SUM(pubstmar) as "mar"'), DB::Raw('SUM(pubstapr) as "apr"'), DB::Raw('SUM(pubstmay) as "may"'), DB::Raw('SUM(pubstjun) as "jun"'), DB::Raw('SUM(pubstjul) as "jul"'), DB::Raw('SUM(pubstaug) as "aug"'), DB::Raw('SUM(pubstsep) as "sep", SUM(pubstoct) as "oct"'), DB::Raw('SUM(pubstnov) as "nov"'), DB::Raw('SUM(pubstdec) as "dec"'), DB::Raw('concat(chapter, " ", district) as description'))->groupby('rhq')->groupby('zone')->groupby('chapter')->groupby('district')->groupby('name');
        }
    }
}
